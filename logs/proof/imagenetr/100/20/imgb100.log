2024-10-12 16:52:03,631 [trainer.py] => config: ./exps/imgb100.json
2024-10-12 16:52:03,631 [trainer.py] => prefix: -
2024-10-12 16:52:03,631 [trainer.py] => dataset: imagenetr
2024-10-12 16:52:03,632 [trainer.py] => memory_size: 4000
2024-10-12 16:52:03,632 [trainer.py] => memory_per_class: 20
2024-10-12 16:52:03,632 [trainer.py] => fixed_memory: True
2024-10-12 16:52:03,632 [trainer.py] => shuffle: True
2024-10-12 16:52:03,632 [trainer.py] => init_cls: 100
2024-10-12 16:52:03,632 [trainer.py] => increment: 20
2024-10-12 16:52:03,632 [trainer.py] => model_name: proof
2024-10-12 16:52:03,632 [trainer.py] => convnet_type: clip
2024-10-12 16:52:03,632 [trainer.py] => device: [device(type='cuda', index=1)]
2024-10-12 16:52:03,632 [trainer.py] => seed: 1993
2024-10-12 16:52:03,632 [trainer.py] => projection_type: pure_mlp
2024-10-12 16:52:03,632 [trainer.py] => frozen_layers: visual
2024-10-12 16:52:03,632 [trainer.py] => tuned_epoch: 10
2024-10-12 16:52:03,632 [trainer.py] => init_lr: 0.001
2024-10-12 16:52:03,632 [trainer.py] => batch_size: 48
2024-10-12 16:52:03,632 [trainer.py] => weight_decay: 0.05
2024-10-12 16:52:03,632 [trainer.py] => min_lr: 0
2024-10-12 16:52:03,633 [trainer.py] => optimizer: sgd
2024-10-12 16:52:03,764 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-10-12 16:52:05,882 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 16:52:08,892 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 16:52:11,991 [trainer.py] => All params: 150670849
2024-10-12 16:52:11,993 [trainer.py] => Trainable params: 150670849
2024-10-12 16:52:12,292 [proof.py] => Learning on 0-100
2024-10-12 17:06:48,929 [trainer.py] => config: ./exps/imgb100.json
2024-10-12 17:06:48,929 [trainer.py] => prefix: -
2024-10-12 17:06:48,929 [trainer.py] => dataset: imagenetr
2024-10-12 17:06:48,929 [trainer.py] => memory_size: 4000
2024-10-12 17:06:48,929 [trainer.py] => memory_per_class: 20
2024-10-12 17:06:48,929 [trainer.py] => fixed_memory: True
2024-10-12 17:06:48,930 [trainer.py] => shuffle: True
2024-10-12 17:06:48,930 [trainer.py] => init_cls: 100
2024-10-12 17:06:48,930 [trainer.py] => increment: 20
2024-10-12 17:06:48,930 [trainer.py] => model_name: proof
2024-10-12 17:06:48,930 [trainer.py] => convnet_type: clip
2024-10-12 17:06:48,930 [trainer.py] => device: [device(type='cuda', index=1)]
2024-10-12 17:06:48,930 [trainer.py] => seed: 1993
2024-10-12 17:06:48,930 [trainer.py] => projection_type: pure_mlp
2024-10-12 17:06:48,930 [trainer.py] => frozen_layers: visual
2024-10-12 17:06:48,930 [trainer.py] => tuned_epoch: 10
2024-10-12 17:06:48,930 [trainer.py] => init_lr: 0.001
2024-10-12 17:06:48,930 [trainer.py] => batch_size: 48
2024-10-12 17:06:48,930 [trainer.py] => weight_decay: 0.05
2024-10-12 17:06:48,930 [trainer.py] => min_lr: 0
2024-10-12 17:06:48,930 [trainer.py] => optimizer: sgd
2024-10-12 17:06:49,018 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-10-12 17:06:51,019 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 17:06:53,537 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 17:06:56,335 [trainer.py] => All params: 150670849
2024-10-12 17:06:56,336 [trainer.py] => Trainable params: 150670849
2024-10-12 17:06:56,604 [proof.py] => Learning on 0-100
2024-10-12 17:18:48,157 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 17:22:57,442 [proof.py] => Exemplar size: 2000
2024-10-12 17:22:57,442 [trainer.py] => CNN: {'total': 84.46, '00-09': 88.64, '10-19': 91.13, '20-29': 84.0, '30-39': 82.53, '40-49': 84.44, '50-59': 84.21, '60-69': 78.86, '70-79': 87.18, '80-89': 83.87, '90-99': 74.01, 'old': 0, 'new': 84.46, 'harmonic': 0.0}
2024-10-12 17:22:57,442 [trainer.py] => CNN top1 curve: [84.46]
2024-10-12 17:22:57,443 [trainer.py] => CNN top5 curve: [96.15]

2024-10-12 17:22:57,443 [trainer.py] => Average Accuracy (CNN): 84.46
2024-10-12 17:22:57,444 [trainer.py] => All params: 151197697
2024-10-12 17:22:57,444 [trainer.py] => Trainable params: 1576961
2024-10-12 17:22:57,454 [proof.py] => Learning on 100-120
2024-10-12 17:28:48,095 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 17:31:05,705 [proof.py] => Exemplar size: 2400
2024-10-12 17:31:05,705 [trainer.py] => CNN: {'total': 82.77, '00-09': 85.17, '10-19': 84.68, '20-29': 82.33, '30-39': 80.42, '40-49': 81.13, '50-59': 82.24, '60-69': 74.5, '70-79': 82.05, '80-89': 82.26, '90-99': 75.14, '100-109': 90.85, '110-119': 88.03, 'old': 81.34, 'new': 89.24, 'harmonic': 85.11}
2024-10-12 17:31:05,705 [trainer.py] => CNN top1 curve: [84.46, 82.77]
2024-10-12 17:31:05,705 [trainer.py] => CNN top5 curve: [96.15, 95.23]

2024-10-12 17:31:05,705 [trainer.py] => Average Accuracy (CNN): 83.615
2024-10-12 17:31:05,706 [trainer.py] => All params: 151724545
2024-10-12 17:31:05,707 [trainer.py] => Trainable params: 1839617
2024-10-12 17:31:05,716 [proof.py] => Learning on 120-140
2024-10-12 17:37:19,211 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 17:39:46,525 [proof.py] => Exemplar size: 2800
2024-10-12 17:39:46,526 [trainer.py] => CNN: {'total': 81.28, '00-09': 83.28, '10-19': 83.33, '20-29': 79.33, '30-39': 81.02, '40-49': 79.47, '50-59': 83.88, '60-69': 73.15, '70-79': 82.42, '80-89': 80.97, '90-99': 70.62, '100-109': 84.51, '110-119': 82.18, '120-129': 82.29, '130-139': 86.58, 'old': 80.77, 'new': 84.53, 'harmonic': 82.61}
2024-10-12 17:39:46,526 [trainer.py] => CNN top1 curve: [84.46, 82.77, 81.28]
2024-10-12 17:39:46,526 [trainer.py] => CNN top5 curve: [96.15, 95.23, 94.71]

2024-10-12 17:39:46,526 [trainer.py] => Average Accuracy (CNN): 82.83666666666666
2024-10-12 17:39:46,527 [trainer.py] => All params: 152251393
2024-10-12 17:39:46,528 [trainer.py] => Trainable params: 2102273
2024-10-12 17:39:46,541 [proof.py] => Learning on 140-160
2024-10-12 17:47:16,340 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 17:49:47,474 [proof.py] => Exemplar size: 3200
2024-10-12 17:49:47,474 [trainer.py] => CNN: {'total': 80.74, '00-09': 78.86, '10-19': 85.22, '20-29': 78.33, '30-39': 78.92, '40-49': 78.81, '50-59': 81.25, '60-69': 72.48, '70-79': 78.39, '80-89': 80.97, '90-99': 68.93, '100-109': 84.86, '110-119': 77.93, '120-129': 78.97, '130-139': 79.87, '140-149': 89.92, '150-159': 89.23, 'old': 79.21, 'new': 89.57, 'harmonic': 84.07}
2024-10-12 17:49:47,474 [trainer.py] => CNN top1 curve: [84.46, 82.77, 81.28, 80.74]
2024-10-12 17:49:47,474 [trainer.py] => CNN top5 curve: [96.15, 95.23, 94.71, 94.15]

2024-10-12 17:49:47,474 [trainer.py] => Average Accuracy (CNN): 82.3125
2024-10-12 17:49:47,475 [trainer.py] => All params: 152778241
2024-10-12 17:49:47,476 [trainer.py] => Trainable params: 2364929
2024-10-12 17:49:47,491 [proof.py] => Learning on 160-180
2024-10-12 17:56:58,276 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 17:59:33,725 [proof.py] => Exemplar size: 3600
2024-10-12 17:59:33,725 [trainer.py] => CNN: {'total': 79.1, '00-09': 78.86, '10-19': 83.87, '20-29': 76.67, '30-39': 77.41, '40-49': 76.82, '50-59': 79.28, '60-69': 70.47, '70-79': 75.82, '80-89': 77.74, '90-99': 70.62, '100-109': 83.45, '110-119': 78.19, '120-129': 75.28, '130-139': 80.2, '140-149': 81.47, '150-159': 82.87, '160-169': 83.91, '170-179': 87.5, 'old': 78.45, 'new': 85.77, 'harmonic': 81.95}
2024-10-12 17:59:33,725 [trainer.py] => CNN top1 curve: [84.46, 82.77, 81.28, 80.74, 79.1]
2024-10-12 17:59:33,726 [trainer.py] => CNN top5 curve: [96.15, 95.23, 94.71, 94.15, 93.56]

2024-10-12 17:59:33,726 [trainer.py] => Average Accuracy (CNN): 81.67
2024-10-12 17:59:33,727 [trainer.py] => All params: 153305089
2024-10-12 17:59:33,727 [trainer.py] => Trainable params: 2627585
2024-10-12 17:59:33,740 [proof.py] => Learning on 180-200
2024-10-12 18:07:51,898 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 18:10:52,801 [proof.py] => Exemplar size: 4000
2024-10-12 18:10:52,802 [trainer.py] => CNN: {'total': 78.03, '00-09': 79.18, '10-19': 80.11, '20-29': 73.67, '30-39': 75.9, '40-49': 73.84, '50-59': 76.64, '60-69': 67.45, '70-79': 75.82, '80-89': 77.1, '90-99': 68.36, '100-109': 79.58, '110-119': 77.93, '120-129': 72.69, '130-139': 79.87, '140-149': 83.38, '150-159': 80.11, '160-169': 75.22, '170-179': 80.24, '180-189': 89.29, '190-199': 88.19, 'old': 76.89, 'new': 88.77, 'harmonic': 82.4}
2024-10-12 18:10:52,802 [trainer.py] => CNN top1 curve: [84.46, 82.77, 81.28, 80.74, 79.1, 78.03]
2024-10-12 18:10:52,802 [trainer.py] => CNN top5 curve: [96.15, 95.23, 94.71, 94.15, 93.56, 93.18]

2024-10-12 18:10:52,802 [trainer.py] => Average Accuracy (CNN): 81.06333333333333
