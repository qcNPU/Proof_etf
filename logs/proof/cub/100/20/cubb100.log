2024-10-12 15:16:06,181 [trainer.py] => config: ./exps/cubb100.json
2024-10-12 15:16:06,182 [trainer.py] => prefix: -
2024-10-12 15:16:06,182 [trainer.py] => dataset: cub
2024-10-12 15:16:06,182 [trainer.py] => memory_size: 2000
2024-10-12 15:16:06,182 [trainer.py] => memory_per_class: 20
2024-10-12 15:16:06,182 [trainer.py] => fixed_memory: True
2024-10-12 15:16:06,182 [trainer.py] => shuffle: True
2024-10-12 15:16:06,182 [trainer.py] => init_cls: 100
2024-10-12 15:16:06,182 [trainer.py] => increment: 20
2024-10-12 15:16:06,182 [trainer.py] => model_name: proof
2024-10-12 15:16:06,182 [trainer.py] => convnet_type: clip
2024-10-12 15:16:06,182 [trainer.py] => device: [device(type='cuda', index=1)]
2024-10-12 15:16:06,182 [trainer.py] => seed: 1993
2024-10-12 15:16:06,182 [trainer.py] => projection_type: pure_mlp
2024-10-12 15:16:06,182 [trainer.py] => frozen_layers: visual
2024-10-12 15:16:06,182 [trainer.py] => tuned_epoch: 10
2024-10-12 15:16:06,182 [trainer.py] => init_lr: 0.001
2024-10-12 15:16:06,182 [trainer.py] => batch_size: 64
2024-10-12 15:16:06,182 [trainer.py] => weight_decay: 0.05
2024-10-12 15:16:06,182 [trainer.py] => min_lr: 0
2024-10-12 15:16:06,182 [trainer.py] => optimizer: sgd
2024-10-12 15:16:06,228 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-10-12 15:16:07,791 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 15:16:09,731 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 15:16:11,578 [trainer.py] => All params: 150670849
2024-10-12 15:16:11,579 [trainer.py] => Trainable params: 150670849
2024-10-12 15:16:11,759 [proof.py] => Learning on 0-100
2024-10-12 15:18:56,053 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 15:20:43,508 [proof.py] => Exemplar size: 2000
2024-10-12 15:20:43,509 [trainer.py] => CNN: {'total': 84.68, '00-09': 79.66, '10-19': 82.95, '20-29': 91.75, '30-39': 80.0, '40-49': 87.85, '50-59': 75.68, '60-69': 84.91, '70-79': 89.36, '80-89': 89.47, '90-99': 84.56, 'old': 0, 'new': 84.68, 'harmonic': 0.0}
2024-10-12 15:20:43,509 [trainer.py] => CNN top1 curve: [84.68]
2024-10-12 15:20:43,509 [trainer.py] => CNN top5 curve: [98.48]

2024-10-12 15:20:43,509 [trainer.py] => Average Accuracy (CNN): 84.68
2024-10-12 15:20:43,510 [trainer.py] => All params: 151197697
2024-10-12 15:20:43,511 [trainer.py] => Trainable params: 1576961
2024-10-12 15:20:43,518 [proof.py] => Learning on 100-120
2024-10-12 15:22:45,817 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 15:23:53,853 [proof.py] => Exemplar size: 2400
2024-10-12 15:23:53,854 [trainer.py] => CNN: {'total': 82.77, '00-09': 81.36, '10-19': 80.62, '20-29': 90.72, '30-39': 80.91, '40-49': 85.05, '50-59': 75.68, '60-69': 82.08, '70-79': 79.43, '80-89': 86.47, '90-99': 82.35, '100-109': 86.09, '110-119': 84.07, 'old': 82.32, 'new': 85.09, 'harmonic': 83.68}
2024-10-12 15:23:53,854 [trainer.py] => CNN top1 curve: [84.68, 82.77]
2024-10-12 15:23:53,854 [trainer.py] => CNN top5 curve: [98.48, 97.39]

2024-10-12 15:23:53,854 [trainer.py] => Average Accuracy (CNN): 83.725
2024-10-12 15:23:53,855 [trainer.py] => All params: 151724545
2024-10-12 15:23:53,856 [trainer.py] => Trainable params: 1839617
2024-10-12 15:23:53,862 [proof.py] => Learning on 120-140
2024-10-12 15:26:16,764 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 15:27:36,553 [proof.py] => Exemplar size: 2800
2024-10-12 15:27:36,554 [trainer.py] => CNN: {'total': 81.05, '00-09': 72.03, '10-19': 82.95, '20-29': 90.72, '30-39': 75.45, '40-49': 85.05, '50-59': 73.87, '60-69': 77.36, '70-79': 83.69, '80-89': 84.21, '90-99': 83.09, '100-109': 82.61, '110-119': 81.42, '120-129': 80.37, '130-139': 81.36, 'old': 81.07, 'new': 80.89, 'harmonic': 80.98}
2024-10-12 15:27:36,554 [trainer.py] => CNN top1 curve: [84.68, 82.77, 81.05]
2024-10-12 15:27:36,554 [trainer.py] => CNN top5 curve: [98.48, 97.39, 97.44]

2024-10-12 15:27:36,554 [trainer.py] => Average Accuracy (CNN): 82.83333333333333
2024-10-12 15:27:36,555 [trainer.py] => All params: 152251393
2024-10-12 15:27:36,556 [trainer.py] => Trainable params: 2102273
2024-10-12 15:27:36,560 [proof.py] => Learning on 140-160
2024-10-12 15:30:18,151 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 15:31:47,363 [proof.py] => Exemplar size: 3200
2024-10-12 15:31:47,363 [trainer.py] => CNN: {'total': 80.38, '00-09': 74.58, '10-19': 83.72, '20-29': 91.75, '30-39': 69.09, '40-49': 82.24, '50-59': 73.87, '60-69': 79.25, '70-79': 81.56, '80-89': 80.45, '90-99': 80.15, '100-109': 80.87, '110-119': 80.53, '120-129': 81.31, '130-139': 79.66, '140-149': 79.37, '150-159': 87.9, 'old': 79.89, 'new': 83.6, 'harmonic': 81.7}
2024-10-12 15:31:47,364 [trainer.py] => CNN top1 curve: [84.68, 82.77, 81.05, 80.38]
2024-10-12 15:31:47,364 [trainer.py] => CNN top5 curve: [98.48, 97.39, 97.44, 96.83]

2024-10-12 15:31:47,364 [trainer.py] => Average Accuracy (CNN): 82.22
2024-10-12 15:31:47,365 [trainer.py] => All params: 152778241
2024-10-12 15:31:47,366 [trainer.py] => Trainable params: 2364929
2024-10-12 15:31:47,372 [proof.py] => Learning on 160-180
2024-10-12 15:34:49,174 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 15:36:26,526 [proof.py] => Exemplar size: 3600
2024-10-12 15:36:26,527 [trainer.py] => CNN: {'total': 79.98, '00-09': 75.42, '10-19': 83.72, '20-29': 90.72, '30-39': 72.73, '40-49': 82.24, '50-59': 72.07, '60-69': 77.36, '70-79': 82.98, '80-89': 80.45, '90-99': 77.21, '100-109': 78.26, '110-119': 79.65, '120-129': 79.44, '130-139': 81.36, '140-149': 78.57, '150-159': 86.29, '160-169': 82.84, '170-179': 77.67, 'old': 79.9, 'new': 80.59, 'harmonic': 80.24}
2024-10-12 15:36:26,527 [trainer.py] => CNN top1 curve: [84.68, 82.77, 81.05, 80.38, 79.98]
2024-10-12 15:36:26,527 [trainer.py] => CNN top5 curve: [98.48, 97.39, 97.44, 96.83, 96.8]

2024-10-12 15:36:26,527 [trainer.py] => Average Accuracy (CNN): 81.772
2024-10-12 15:36:26,528 [trainer.py] => All params: 153305089
2024-10-12 15:36:26,529 [trainer.py] => Trainable params: 2627585
2024-10-12 15:36:26,535 [proof.py] => Learning on 180-200
2024-10-12 15:39:50,316 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 15:41:38,843 [proof.py] => Exemplar size: 4000
2024-10-12 15:41:38,843 [trainer.py] => CNN: {'total': 78.92, '00-09': 77.12, '10-19': 83.72, '20-29': 89.69, '30-39': 70.91, '40-49': 80.37, '50-59': 72.97, '60-69': 72.64, '70-79': 78.72, '80-89': 82.71, '90-99': 80.88, '100-109': 77.39, '110-119': 78.76, '120-129': 75.7, '130-139': 72.88, '140-149': 76.19, '150-159': 87.1, '160-169': 82.84, '170-179': 72.82, '180-189': 82.58, '190-199': 79.59, 'old': 78.67, 'new': 81.3, 'harmonic': 79.96}
2024-10-12 15:41:38,843 [trainer.py] => CNN top1 curve: [84.68, 82.77, 81.05, 80.38, 79.98, 78.92]
2024-10-12 15:41:38,843 [trainer.py] => CNN top5 curve: [98.48, 97.39, 97.44, 96.83, 96.8, 96.4]

2024-10-12 15:41:38,843 [trainer.py] => Average Accuracy (CNN): 81.29666666666667
