2024-10-12 14:41:32,295 [trainer.py] => config: ./exps/cub.json
2024-10-12 14:41:32,295 [trainer.py] => prefix: -
2024-10-12 14:41:32,295 [trainer.py] => dataset: cub
2024-10-12 14:41:32,295 [trainer.py] => memory_size: 2000
2024-10-12 14:41:32,295 [trainer.py] => memory_per_class: 20
2024-10-12 14:41:32,295 [trainer.py] => fixed_memory: True
2024-10-12 14:41:32,295 [trainer.py] => shuffle: True
2024-10-12 14:41:32,295 [trainer.py] => init_cls: 20
2024-10-12 14:41:32,295 [trainer.py] => increment: 20
2024-10-12 14:41:32,295 [trainer.py] => model_name: proof
2024-10-12 14:41:32,295 [trainer.py] => convnet_type: clip
2024-10-12 14:41:32,295 [trainer.py] => device: [device(type='cuda', index=1)]
2024-10-12 14:41:32,295 [trainer.py] => seed: 1993
2024-10-12 14:41:32,295 [trainer.py] => projection_type: pure_mlp
2024-10-12 14:41:32,295 [trainer.py] => frozen_layers: visual
2024-10-12 14:41:32,296 [trainer.py] => tuned_epoch: 10
2024-10-12 14:41:32,296 [trainer.py] => init_lr: 0.001
2024-10-12 14:41:32,296 [trainer.py] => batch_size: 64
2024-10-12 14:41:32,296 [trainer.py] => weight_decay: 0.05
2024-10-12 14:41:32,296 [trainer.py] => min_lr: 0
2024-10-12 14:41:32,296 [trainer.py] => optimizer: sgd
2024-10-12 14:41:32,342 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-10-12 14:41:34,046 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 14:41:36,494 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 14:41:38,311 [trainer.py] => All params: 150670849
2024-10-12 14:41:38,312 [trainer.py] => Trainable params: 150670849
2024-10-12 14:41:38,486 [proof.py] => Learning on 0-20
2024-10-12 14:42:23,306 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 14:42:53,257 [proof.py] => Exemplar size: 400
2024-10-12 14:42:53,258 [trainer.py] => CNN: {'total': 96.36, '00-09': 98.31, '10-19': 94.57, 'old': 0, 'new': 96.36, 'harmonic': 0.0}
2024-10-12 14:42:53,258 [trainer.py] => CNN top1 curve: [96.36]
2024-10-12 14:42:53,258 [trainer.py] => CNN top5 curve: [100.0]

2024-10-12 14:42:53,258 [trainer.py] => Average Accuracy (CNN): 96.36
2024-10-12 14:42:53,259 [trainer.py] => All params: 151197697
2024-10-12 14:42:53,260 [trainer.py] => Trainable params: 1576961
2024-10-12 14:42:53,266 [proof.py] => Learning on 20-40
2024-10-12 14:43:52,916 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 14:44:32,456 [proof.py] => Exemplar size: 800
2024-10-12 14:44:32,457 [trainer.py] => CNN: {'total': 91.41, '00-09': 94.92, '10-19': 89.92, '20-29': 93.81, '30-39': 87.27, 'old': 92.31, 'new': 90.34, 'harmonic': 91.31}
2024-10-12 14:44:32,457 [trainer.py] => CNN top1 curve: [96.36, 91.41]
2024-10-12 14:44:32,457 [trainer.py] => CNN top5 curve: [100.0, 99.34]

2024-10-12 14:44:32,457 [trainer.py] => Average Accuracy (CNN): 93.88499999999999
2024-10-12 14:44:32,458 [trainer.py] => All params: 151724545
2024-10-12 14:44:32,459 [trainer.py] => Trainable params: 1839617
2024-10-12 14:44:32,466 [proof.py] => Learning on 40-60
2024-10-12 14:45:47,079 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 14:46:36,179 [proof.py] => Exemplar size: 1200
2024-10-12 14:46:36,179 [trainer.py] => CNN: {'total': 87.8, '00-09': 82.2, '10-19': 91.47, '20-29': 91.75, '30-39': 86.36, '40-49': 90.65, '50-59': 84.68, 'old': 87.89, 'new': 87.61, 'harmonic': 87.75}
2024-10-12 14:46:36,179 [trainer.py] => CNN top1 curve: [96.36, 91.41, 87.8]
2024-10-12 14:46:36,179 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81]

2024-10-12 14:46:36,179 [trainer.py] => Average Accuracy (CNN): 91.85666666666667
2024-10-12 14:46:36,181 [trainer.py] => All params: 152251393
2024-10-12 14:46:36,182 [trainer.py] => Trainable params: 2102273
2024-10-12 14:46:36,187 [proof.py] => Learning on 60-80
2024-10-12 14:48:07,751 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 14:49:06,078 [proof.py] => Exemplar size: 1600
2024-10-12 14:49:06,079 [trainer.py] => CNN: {'total': 84.55, '00-09': 81.36, '10-19': 86.82, '20-29': 92.78, '30-39': 81.82, '40-49': 84.11, '50-59': 75.68, '60-69': 83.02, '70-79': 90.07, 'old': 83.63, 'new': 87.04, 'harmonic': 85.3}
2024-10-12 14:49:06,079 [trainer.py] => CNN top1 curve: [96.36, 91.41, 87.8, 84.55]
2024-10-12 14:49:06,079 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 98.26]

2024-10-12 14:49:06,079 [trainer.py] => Average Accuracy (CNN): 90.03
2024-10-12 14:49:06,080 [trainer.py] => All params: 152778241
2024-10-12 14:49:06,081 [trainer.py] => Trainable params: 2364929
2024-10-12 14:49:06,087 [proof.py] => Learning on 80-100
2024-10-12 14:50:51,729 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 14:51:52,317 [proof.py] => Exemplar size: 2000
2024-10-12 14:51:52,317 [trainer.py] => CNN: {'total': 83.33, '00-09': 78.81, '10-19': 83.72, '20-29': 91.75, '30-39': 79.09, '40-49': 83.18, '50-59': 73.87, '60-69': 81.13, '70-79': 88.65, '80-89': 85.71, '90-99': 86.03, 'old': 82.59, 'new': 85.87, 'harmonic': 84.2}
2024-10-12 14:51:52,317 [trainer.py] => CNN top1 curve: [96.36, 91.41, 87.8, 84.55, 83.33]
2024-10-12 14:51:52,317 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 98.26, 98.15]

2024-10-12 14:51:52,317 [trainer.py] => Average Accuracy (CNN): 88.69
2024-10-12 14:51:52,318 [trainer.py] => All params: 153305089
2024-10-12 14:51:52,319 [trainer.py] => Trainable params: 2627585
2024-10-12 14:51:52,324 [proof.py] => Learning on 100-120
2024-10-12 14:53:56,810 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 14:55:17,270 [proof.py] => Exemplar size: 2400
2024-10-12 14:55:17,271 [trainer.py] => CNN: {'total': 82.98, '00-09': 76.27, '10-19': 84.5, '20-29': 93.81, '30-39': 78.18, '40-49': 84.11, '50-59': 73.87, '60-69': 80.19, '70-79': 82.27, '80-89': 84.21, '90-99': 86.76, '100-109': 85.22, '110-119': 86.73, 'old': 82.41, 'new': 85.96, 'harmonic': 84.15}
2024-10-12 14:55:17,271 [trainer.py] => CNN top1 curve: [96.36, 91.41, 87.8, 84.55, 83.33, 82.98]
2024-10-12 14:55:17,271 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 98.26, 98.15, 97.74]

2024-10-12 14:55:17,271 [trainer.py] => Average Accuracy (CNN): 87.73833333333333
2024-10-12 14:55:17,272 [trainer.py] => All params: 153831937
2024-10-12 14:55:17,273 [trainer.py] => Trainable params: 2890241
2024-10-12 14:55:17,279 [proof.py] => Learning on 120-140
2024-10-12 14:57:43,582 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 14:59:07,941 [proof.py] => Exemplar size: 2800
2024-10-12 14:59:07,942 [trainer.py] => CNN: {'total': 81.29, '00-09': 76.27, '10-19': 82.95, '20-29': 91.75, '30-39': 77.27, '40-49': 81.31, '50-59': 73.87, '60-69': 78.3, '70-79': 82.98, '80-89': 81.2, '90-99': 84.56, '100-109': 83.48, '110-119': 84.07, '120-129': 78.5, '130-139': 81.36, 'old': 81.5, 'new': 80.0, 'harmonic': 80.74}
2024-10-12 14:59:07,942 [trainer.py] => CNN top1 curve: [96.36, 91.41, 87.8, 84.55, 83.33, 82.98, 81.29]
2024-10-12 14:59:07,942 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 98.26, 98.15, 97.74, 96.89]

2024-10-12 14:59:07,942 [trainer.py] => Average Accuracy (CNN): 86.81714285714284
2024-10-12 14:59:07,943 [trainer.py] => All params: 154358785
2024-10-12 14:59:07,944 [trainer.py] => Trainable params: 3152897
2024-10-12 14:59:07,950 [proof.py] => Learning on 140-160
2024-10-12 15:01:51,949 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 15:03:25,652 [proof.py] => Exemplar size: 3200
2024-10-12 15:03:25,652 [trainer.py] => CNN: {'total': 80.86, '00-09': 78.81, '10-19': 85.27, '20-29': 89.69, '30-39': 73.64, '40-49': 80.37, '50-59': 71.17, '60-69': 79.25, '70-79': 82.27, '80-89': 81.2, '90-99': 82.35, '100-109': 80.87, '110-119': 84.07, '120-129': 76.64, '130-139': 81.36, '140-149': 79.37, '150-159': 86.29, 'old': 80.56, 'new': 82.8, 'harmonic': 81.66}
2024-10-12 15:03:25,652 [trainer.py] => CNN top1 curve: [96.36, 91.41, 87.8, 84.55, 83.33, 82.98, 81.29, 80.86]
2024-10-12 15:03:25,652 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 98.26, 98.15, 97.74, 96.89, 96.67]

2024-10-12 15:03:25,652 [trainer.py] => Average Accuracy (CNN): 86.07249999999999
2024-10-12 15:03:25,654 [trainer.py] => All params: 154885633
2024-10-12 15:03:25,654 [trainer.py] => Trainable params: 3415553
2024-10-12 15:03:25,659 [proof.py] => Learning on 160-180
2024-10-12 15:06:32,084 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 15:08:17,757 [proof.py] => Exemplar size: 3600
2024-10-12 15:08:17,757 [trainer.py] => CNN: {'total': 80.26, '00-09': 78.81, '10-19': 82.95, '20-29': 88.66, '30-39': 75.45, '40-49': 77.57, '50-59': 72.97, '60-69': 75.47, '70-79': 83.69, '80-89': 81.95, '90-99': 79.41, '100-109': 79.13, '110-119': 81.42, '120-129': 79.44, '130-139': 76.27, '140-149': 79.37, '150-159': 87.9, '160-169': 85.07, '170-179': 76.7, 'old': 80.12, 'new': 81.43, 'harmonic': 80.77}
2024-10-12 15:08:17,757 [trainer.py] => CNN top1 curve: [96.36, 91.41, 87.8, 84.55, 83.33, 82.98, 81.29, 80.86, 80.26]
2024-10-12 15:08:17,758 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 98.26, 98.15, 97.74, 96.89, 96.67, 96.9]

2024-10-12 15:08:17,758 [trainer.py] => Average Accuracy (CNN): 85.42666666666666
2024-10-12 15:08:17,759 [trainer.py] => All params: 155412481
2024-10-12 15:08:17,760 [trainer.py] => Trainable params: 3678209
2024-10-12 15:08:17,766 [proof.py] => Learning on 180-200
2024-10-12 15:11:45,727 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 15:13:42,968 [proof.py] => Exemplar size: 4000
2024-10-12 15:13:42,969 [trainer.py] => CNN: {'total': 79.86, '00-09': 76.27, '10-19': 81.4, '20-29': 90.72, '30-39': 69.09, '40-49': 81.31, '50-59': 74.77, '60-69': 68.87, '70-79': 82.27, '80-89': 82.71, '90-99': 81.62, '100-109': 80.0, '110-119': 81.42, '120-129': 71.96, '130-139': 74.58, '140-149': 79.37, '150-159': 88.71, '160-169': 82.84, '170-179': 78.64, '180-189': 84.09, '190-199': 83.67, 'old': 79.42, 'new': 83.91, 'harmonic': 81.6}
2024-10-12 15:13:42,969 [trainer.py] => CNN top1 curve: [96.36, 91.41, 87.8, 84.55, 83.33, 82.98, 81.29, 80.86, 80.26, 79.86]
2024-10-12 15:13:42,969 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 98.26, 98.15, 97.74, 96.89, 96.67, 96.9, 96.44]

2024-10-12 15:13:42,969 [trainer.py] => Average Accuracy (CNN): 84.86999999999999
