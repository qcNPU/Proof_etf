2024-10-12 17:11:54,003 [trainer.py] => config: ./exps/carb100.json
2024-10-12 17:11:54,004 [trainer.py] => prefix: -
2024-10-12 17:11:54,004 [trainer.py] => dataset: cars
2024-10-12 17:11:54,004 [trainer.py] => memory_size: 2000
2024-10-12 17:11:54,004 [trainer.py] => memory_per_class: 20
2024-10-12 17:11:54,004 [trainer.py] => fixed_memory: True
2024-10-12 17:11:54,004 [trainer.py] => shuffle: True
2024-10-12 17:11:54,004 [trainer.py] => init_cls: 50
2024-10-12 17:11:54,004 [trainer.py] => increment: 10
2024-10-12 17:11:54,004 [trainer.py] => model_name: proof
2024-10-12 17:11:54,004 [trainer.py] => convnet_type: clip
2024-10-12 17:11:54,004 [trainer.py] => device: [device(type='cuda', index=3)]
2024-10-12 17:11:54,004 [trainer.py] => seed: 1993
2024-10-12 17:11:54,004 [trainer.py] => projection_type: pure_mlp
2024-10-12 17:11:54,004 [trainer.py] => frozen_layers: visual
2024-10-12 17:11:54,004 [trainer.py] => tuned_epoch: 15
2024-10-12 17:11:54,004 [trainer.py] => init_lr: 0.001
2024-10-12 17:11:54,004 [trainer.py] => batch_size: 128
2024-10-12 17:11:54,004 [trainer.py] => weight_decay: 0.05
2024-10-12 17:11:54,004 [trainer.py] => min_lr: 1e-05
2024-10-12 17:11:54,004 [trainer.py] => optimizer: sgd
2024-10-12 17:11:54,027 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-10-12 17:11:56,093 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 17:11:59,069 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 17:12:01,427 [trainer.py] => All params: 150670849
2024-10-12 17:12:01,428 [trainer.py] => Trainable params: 150670849
2024-10-12 17:12:01,691 [proof.py] => Learning on 0-50
2024-10-12 17:16:07,277 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 17:17:53,097 [proof.py] => Exemplar size: 1000
2024-10-12 17:17:53,098 [trainer.py] => CNN: {'total': 90.97, '00-09': 95.52, '10-19': 93.5, '20-29': 89.76, '30-39': 85.97, '40-49': 89.8, 'old': 0, 'new': 90.97, 'harmonic': 0.0}
2024-10-12 17:17:53,098 [trainer.py] => CNN top1 curve: [90.97]
2024-10-12 17:17:53,098 [trainer.py] => CNN top5 curve: [99.85]

2024-10-12 17:17:53,098 [trainer.py] => Average Accuracy (CNN): 90.97
2024-10-12 17:17:53,100 [trainer.py] => All params: 151197697
2024-10-12 17:17:53,102 [trainer.py] => Trainable params: 1576961
2024-10-12 17:17:53,115 [proof.py] => Learning on 50-60
2024-10-12 17:21:36,369 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 17:23:09,662 [proof.py] => Exemplar size: 1200
2024-10-12 17:23:09,662 [trainer.py] => CNN: {'total': 91.84, '00-09': 93.63, '10-19': 93.0, '20-29': 89.29, '30-39': 88.78, '40-49': 88.56, '50-59': 97.58, 'old': 90.68, 'new': 97.58, 'harmonic': 94.0}
2024-10-12 17:23:09,662 [trainer.py] => CNN top1 curve: [90.97, 91.84]
2024-10-12 17:23:09,662 [trainer.py] => CNN top5 curve: [99.85, 99.8]

2024-10-12 17:23:09,662 [trainer.py] => Average Accuracy (CNN): 91.405
2024-10-12 17:23:09,663 [trainer.py] => All params: 151724545
2024-10-12 17:23:09,664 [trainer.py] => Trainable params: 1839617
2024-10-12 17:23:09,674 [proof.py] => Learning on 60-70
2024-10-12 17:27:12,671 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 17:28:30,543 [proof.py] => Exemplar size: 1400
2024-10-12 17:28:30,543 [trainer.py] => CNN: {'total': 90.66, '00-09': 93.87, '10-19': 94.25, '20-29': 88.33, '30-39': 87.76, '40-49': 88.31, '50-59': 95.88, '60-69': 86.06, 'old': 91.43, 'new': 86.06, 'harmonic': 88.66}
2024-10-12 17:28:30,543 [trainer.py] => CNN top1 curve: [90.97, 91.84, 90.66]
2024-10-12 17:28:30,543 [trainer.py] => CNN top5 curve: [99.85, 99.8, 99.86]

2024-10-12 17:28:30,543 [trainer.py] => Average Accuracy (CNN): 91.15666666666668
2024-10-12 17:28:30,545 [trainer.py] => All params: 152251393
2024-10-12 17:28:30,546 [trainer.py] => Trainable params: 2102273
2024-10-12 17:28:30,554 [proof.py] => Learning on 70-80
2024-10-12 17:33:01,750 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 17:34:24,775 [proof.py] => Exemplar size: 1600
2024-10-12 17:34:24,776 [trainer.py] => CNN: {'total': 89.51, '00-09': 92.69, '10-19': 92.75, '20-29': 87.14, '30-39': 86.48, '40-49': 88.06, '50-59': 93.7, '60-69': 83.86, '70-79': 91.23, 'old': 89.27, 'new': 91.23, 'harmonic': 90.24}
2024-10-12 17:34:24,776 [trainer.py] => CNN top1 curve: [90.97, 91.84, 90.66, 89.51]
2024-10-12 17:34:24,776 [trainer.py] => CNN top5 curve: [99.85, 99.8, 99.86, 99.79]

2024-10-12 17:34:24,776 [trainer.py] => Average Accuracy (CNN): 90.745
2024-10-12 17:34:24,777 [trainer.py] => All params: 152778241
2024-10-12 17:34:24,778 [trainer.py] => Trainable params: 2364929
2024-10-12 17:34:24,788 [proof.py] => Learning on 80-90
2024-10-12 17:39:25,108 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 17:40:51,993 [proof.py] => Exemplar size: 1800
2024-10-12 17:40:51,994 [trainer.py] => CNN: {'total': 88.06, '00-09': 89.15, '10-19': 90.25, '20-29': 87.14, '30-39': 85.46, '40-49': 88.06, '50-59': 92.98, '60-69': 83.13, '70-79': 89.47, '80-89': 86.87, 'old': 88.22, 'new': 86.87, 'harmonic': 87.54}
2024-10-12 17:40:51,994 [trainer.py] => CNN top1 curve: [90.97, 91.84, 90.66, 89.51, 88.06]
2024-10-12 17:40:51,994 [trainer.py] => CNN top5 curve: [99.85, 99.8, 99.86, 99.79, 99.7]

2024-10-12 17:40:51,994 [trainer.py] => Average Accuracy (CNN): 90.208
2024-10-12 17:40:51,995 [trainer.py] => All params: 153305089
2024-10-12 17:40:51,996 [trainer.py] => Trainable params: 2627585
2024-10-12 17:40:52,010 [proof.py] => Learning on 90-100
2024-10-12 17:46:05,385 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 17:47:41,921 [proof.py] => Exemplar size: 2000
2024-10-12 17:47:41,921 [trainer.py] => CNN: {'total': 87.51, '00-09': 86.79, '10-19': 91.0, '20-29': 87.14, '30-39': 82.4, '40-49': 88.56, '50-59': 93.22, '60-69': 83.37, '70-79': 88.72, '80-89': 86.4, '90-99': 87.41, 'old': 87.52, 'new': 87.41, 'harmonic': 87.46}
2024-10-12 17:47:41,921 [trainer.py] => CNN top1 curve: [90.97, 91.84, 90.66, 89.51, 88.06, 87.51]
2024-10-12 17:47:41,922 [trainer.py] => CNN top5 curve: [99.85, 99.8, 99.86, 99.79, 99.7, 99.71]

2024-10-12 17:47:41,922 [trainer.py] => Average Accuracy (CNN): 89.75833333333334
2024-10-12 18:32:52,202 [trainer.py] => config: ./exps/carb100.json
2024-10-12 18:32:52,203 [trainer.py] => prefix: -
2024-10-12 18:32:52,203 [trainer.py] => dataset: cars
2024-10-12 18:32:52,203 [trainer.py] => memory_size: 2000
2024-10-12 18:32:52,203 [trainer.py] => memory_per_class: 20
2024-10-12 18:32:52,203 [trainer.py] => fixed_memory: True
2024-10-12 18:32:52,203 [trainer.py] => shuffle: True
2024-10-12 18:32:52,203 [trainer.py] => init_cls: 50
2024-10-12 18:32:52,203 [trainer.py] => increment: 10
2024-10-12 18:32:52,203 [trainer.py] => model_name: proof
2024-10-12 18:32:52,203 [trainer.py] => convnet_type: clip
2024-10-12 18:32:52,203 [trainer.py] => device: [device(type='cuda', index=0)]
2024-10-12 18:32:52,203 [trainer.py] => seed: 1993
2024-10-12 18:32:52,204 [trainer.py] => projection_type: pure_mlp
2024-10-12 18:32:52,204 [trainer.py] => frozen_layers: visual
2024-10-12 18:32:52,204 [trainer.py] => tuned_epoch: 10
2024-10-12 18:32:52,204 [trainer.py] => init_lr: 0.001
2024-10-12 18:32:52,204 [trainer.py] => batch_size: 64
2024-10-12 18:32:52,204 [trainer.py] => weight_decay: 0.05
2024-10-12 18:32:52,204 [trainer.py] => min_lr: 0
2024-10-12 18:32:52,204 [trainer.py] => optimizer: sgd
2024-10-12 18:32:52,263 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-10-12 18:32:55,381 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 18:32:59,259 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 18:33:02,194 [trainer.py] => All params: 150670849
2024-10-12 18:33:02,195 [trainer.py] => Trainable params: 150670849
2024-10-12 18:33:02,492 [proof.py] => Learning on 0-50
2024-10-12 18:35:26,673 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 18:37:40,385 [proof.py] => Exemplar size: 1000
2024-10-12 18:37:40,386 [trainer.py] => CNN: {'total': 91.56, '00-09': 95.52, '10-19': 94.5, '20-29': 90.71, '30-39': 86.48, '40-49': 90.3, 'old': 0, 'new': 91.56, 'harmonic': 0.0}
2024-10-12 18:37:40,386 [trainer.py] => CNN top1 curve: [91.56]
2024-10-12 18:37:40,386 [trainer.py] => CNN top5 curve: [99.8]

2024-10-12 18:37:40,386 [trainer.py] => Average Accuracy (CNN): 91.56
2024-10-12 18:37:40,388 [trainer.py] => All params: 151197697
2024-10-12 18:37:40,389 [trainer.py] => Trainable params: 1576961
2024-10-12 18:37:40,405 [proof.py] => Learning on 50-60
2024-10-12 18:39:39,601 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 18:41:19,054 [proof.py] => Exemplar size: 1200
2024-10-12 18:41:19,055 [trainer.py] => CNN: {'total': 91.8, '00-09': 92.45, '10-19': 94.25, '20-29': 89.52, '30-39': 86.48, '40-49': 90.55, '50-59': 97.34, 'old': 90.68, 'new': 97.34, 'harmonic': 93.89}
2024-10-12 18:41:19,055 [trainer.py] => CNN top1 curve: [91.56, 91.8]
2024-10-12 18:41:19,055 [trainer.py] => CNN top5 curve: [99.8, 99.8]

2024-10-12 18:41:19,055 [trainer.py] => Average Accuracy (CNN): 91.68
2024-10-12 18:41:19,056 [trainer.py] => All params: 151724545
2024-10-12 18:41:19,058 [trainer.py] => Trainable params: 1839617
2024-10-12 18:41:19,074 [proof.py] => Learning on 60-70
2024-10-12 18:43:35,395 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 18:45:09,248 [proof.py] => Exemplar size: 1400
2024-10-12 18:45:09,249 [trainer.py] => CNN: {'total': 90.73, '00-09': 91.75, '10-19': 94.5, '20-29': 88.1, '30-39': 85.97, '40-49': 90.3, '50-59': 96.85, '60-69': 87.53, 'old': 91.27, 'new': 87.53, 'harmonic': 89.36}
2024-10-12 18:45:09,249 [trainer.py] => CNN top1 curve: [91.56, 91.8, 90.73]
2024-10-12 18:45:09,249 [trainer.py] => CNN top5 curve: [99.8, 99.8, 99.72]

2024-10-12 18:45:09,249 [trainer.py] => Average Accuracy (CNN): 91.36333333333334
2024-10-12 18:45:09,250 [trainer.py] => All params: 152251393
2024-10-12 18:45:09,250 [trainer.py] => Trainable params: 2102273
2024-10-12 18:45:09,255 [proof.py] => Learning on 70-80
2024-10-12 18:47:43,276 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 18:49:11,991 [proof.py] => Exemplar size: 1600
2024-10-12 18:49:11,992 [trainer.py] => CNN: {'total': 89.6, '00-09': 90.8, '10-19': 92.5, '20-29': 88.57, '30-39': 85.97, '40-49': 89.55, '50-59': 94.43, '60-69': 82.64, '70-79': 92.23, 'old': 89.23, 'new': 92.23, 'harmonic': 90.71}
2024-10-12 18:49:11,992 [trainer.py] => CNN top1 curve: [91.56, 91.8, 90.73, 89.6]
2024-10-12 18:49:11,992 [trainer.py] => CNN top5 curve: [99.8, 99.8, 99.72, 99.79]

2024-10-12 18:49:11,992 [trainer.py] => Average Accuracy (CNN): 90.92250000000001
2024-10-12 18:49:11,993 [trainer.py] => All params: 152778241
2024-10-12 18:49:11,994 [trainer.py] => Trainable params: 2364929
2024-10-12 18:49:11,999 [proof.py] => Learning on 80-90
2024-10-12 18:52:18,245 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 18:54:04,953 [proof.py] => Exemplar size: 1800
2024-10-12 18:54:04,954 [trainer.py] => CNN: {'total': 89.37, '00-09': 89.39, '10-19': 91.5, '20-29': 88.1, '30-39': 86.99, '40-49': 90.05, '50-59': 93.7, '60-69': 84.11, '70-79': 91.98, '80-89': 88.54, 'old': 89.48, 'new': 88.54, 'harmonic': 89.01}
2024-10-12 18:54:04,954 [trainer.py] => CNN top1 curve: [91.56, 91.8, 90.73, 89.6, 89.37]
2024-10-12 18:54:04,954 [trainer.py] => CNN top5 curve: [99.8, 99.8, 99.72, 99.79, 99.78]

2024-10-12 18:54:04,954 [trainer.py] => Average Accuracy (CNN): 90.61200000000001
2024-10-12 18:54:04,955 [trainer.py] => All params: 153305089
2024-10-12 18:54:04,956 [trainer.py] => Trainable params: 2627585
2024-10-12 18:54:04,967 [proof.py] => Learning on 90-100
2024-10-12 18:57:12,569 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-10-12 18:59:20,125 [proof.py] => Exemplar size: 2000
2024-10-12 18:59:20,126 [trainer.py] => CNN: {'total': 88.32, '00-09': 86.56, '10-19': 88.0, '20-29': 86.9, '30-39': 85.97, '40-49': 88.81, '50-59': 93.46, '60-69': 85.57, '70-79': 90.48, '80-89': 88.07, '90-99': 89.38, 'old': 88.2, 'new': 89.38, 'harmonic': 88.79}
2024-10-12 18:59:20,126 [trainer.py] => CNN top1 curve: [91.56, 91.8, 90.73, 89.6, 89.37, 88.32]
2024-10-12 18:59:20,126 [trainer.py] => CNN top5 curve: [99.8, 99.8, 99.72, 99.79, 99.78, 99.68]

2024-10-12 18:59:20,126 [trainer.py] => Average Accuracy (CNN): 90.23000000000002
