2024-10-12 13:14:10,396 [trainer.py] => config: ./exps/cifarb50.json
2024-10-12 13:14:10,396 [trainer.py] => prefix: -
2024-10-12 13:14:10,396 [trainer.py] => dataset: cifar224
2024-10-12 13:14:10,397 [trainer.py] => memory_size: 2000
2024-10-12 13:14:10,397 [trainer.py] => memory_per_class: 20
2024-10-12 13:14:10,397 [trainer.py] => fixed_memory: False
2024-10-12 13:14:10,397 [trainer.py] => shuffle: True
2024-10-12 13:14:10,397 [trainer.py] => init_cls: 50
2024-10-12 13:14:10,397 [trainer.py] => increment: 10
2024-10-12 13:14:10,397 [trainer.py] => model_name: proof
2024-10-12 13:14:10,397 [trainer.py] => convnet_type: clip
2024-10-12 13:14:10,397 [trainer.py] => device: [device(type='cuda', index=1)]
2024-10-12 13:14:10,397 [trainer.py] => seed: 1993
2024-10-12 13:14:10,397 [trainer.py] => projection_type: pure_mlp
2024-10-12 13:14:10,397 [trainer.py] => frozen_layers: visual
2024-10-12 13:14:10,397 [trainer.py] => tuned_epoch: 5
2024-10-12 13:14:10,397 [trainer.py] => init_lr: 0.001
2024-10-12 13:14:10,397 [trainer.py] => batch_size: 64
2024-10-12 13:14:10,397 [trainer.py] => weight_decay: 0.05
2024-10-12 13:14:10,397 [trainer.py] => min_lr: 0
2024-10-12 13:14:10,397 [trainer.py] => optimizer: sgd
2024-10-12 13:14:11,945 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-10-12 13:14:13,320 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 13:14:15,089 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 13:14:16,457 [trainer.py] => All params: 150670849
2024-10-12 13:14:16,458 [trainer.py] => Trainable params: 150670849
2024-10-12 13:14:16,633 [proof.py] => Learning on 0-50
2024-10-12 13:16:21,603 [trainer.py] => config: ./exps/cifarb50.json
2024-10-12 13:16:21,604 [trainer.py] => prefix: -
2024-10-12 13:16:21,604 [trainer.py] => dataset: cifar224
2024-10-12 13:16:21,604 [trainer.py] => memory_size: 2000
2024-10-12 13:16:21,604 [trainer.py] => memory_per_class: 20
2024-10-12 13:16:21,604 [trainer.py] => fixed_memory: False
2024-10-12 13:16:21,604 [trainer.py] => shuffle: True
2024-10-12 13:16:21,604 [trainer.py] => init_cls: 50
2024-10-12 13:16:21,604 [trainer.py] => increment: 10
2024-10-12 13:16:21,604 [trainer.py] => model_name: proof
2024-10-12 13:16:21,604 [trainer.py] => convnet_type: clip
2024-10-12 13:16:21,604 [trainer.py] => device: [device(type='cuda', index=1)]
2024-10-12 13:16:21,604 [trainer.py] => seed: 1993
2024-10-12 13:16:21,604 [trainer.py] => projection_type: pure_mlp
2024-10-12 13:16:21,604 [trainer.py] => frozen_layers: visual
2024-10-12 13:16:21,604 [trainer.py] => tuned_epoch: 5
2024-10-12 13:16:21,604 [trainer.py] => init_lr: 0.001
2024-10-12 13:16:21,604 [trainer.py] => batch_size: 64
2024-10-12 13:16:21,604 [trainer.py] => weight_decay: 0.05
2024-10-12 13:16:21,604 [trainer.py] => min_lr: 0
2024-10-12 13:16:21,604 [trainer.py] => optimizer: sgd
2024-10-12 13:16:23,096 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-10-12 13:16:24,231 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 13:16:25,723 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 13:16:27,072 [trainer.py] => All params: 150670849
2024-10-12 13:16:27,073 [trainer.py] => Trainable params: 150670849
2024-10-12 13:16:27,222 [proof.py] => Learning on 0-50
2024-10-12 13:18:36,419 [trainer.py] => config: ./exps/cifarb50.json
2024-10-12 13:18:36,419 [trainer.py] => prefix: -
2024-10-12 13:18:36,419 [trainer.py] => dataset: cifar224
2024-10-12 13:18:36,419 [trainer.py] => memory_size: 2000
2024-10-12 13:18:36,419 [trainer.py] => memory_per_class: 20
2024-10-12 13:18:36,419 [trainer.py] => fixed_memory: False
2024-10-12 13:18:36,419 [trainer.py] => shuffle: True
2024-10-12 13:18:36,419 [trainer.py] => init_cls: 50
2024-10-12 13:18:36,419 [trainer.py] => increment: 10
2024-10-12 13:18:36,419 [trainer.py] => model_name: proof
2024-10-12 13:18:36,419 [trainer.py] => convnet_type: clip
2024-10-12 13:18:36,419 [trainer.py] => device: [device(type='cuda', index=1)]
2024-10-12 13:18:36,419 [trainer.py] => seed: 1993
2024-10-12 13:18:36,419 [trainer.py] => projection_type: pure_mlp
2024-10-12 13:18:36,419 [trainer.py] => frozen_layers: visual
2024-10-12 13:18:36,419 [trainer.py] => tuned_epoch: 5
2024-10-12 13:18:36,419 [trainer.py] => init_lr: 0.001
2024-10-12 13:18:36,419 [trainer.py] => batch_size: 64
2024-10-12 13:18:36,419 [trainer.py] => weight_decay: 0.05
2024-10-12 13:18:36,419 [trainer.py] => min_lr: 0
2024-10-12 13:18:36,419 [trainer.py] => optimizer: sgd
2024-10-12 13:18:37,896 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-10-12 13:18:39,025 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 13:18:40,508 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 13:18:41,851 [trainer.py] => All params: 150670849
2024-10-12 13:18:41,851 [trainer.py] => Trainable params: 150670849
2024-10-12 13:18:42,024 [proof.py] => Learning on 0-50
2024-10-12 13:24:42,115 [base.py] => Reducing exemplars...(40 per classes)
2024-10-12 13:24:42,116 [base.py] => Constructing exemplars...(40 per classes)
2024-10-12 13:26:44,086 [proof.py] => Exemplar size: 2000
2024-10-12 13:26:44,086 [trainer.py] => CNN: {'total': 88.7, '00-09': 90.7, '10-19': 86.9, '20-29': 90.9, '30-39': 86.8, '40-49': 88.2, 'old': 0, 'new': 88.7, 'harmonic': 0.0}
2024-10-12 13:26:44,086 [trainer.py] => CNN top1 curve: [88.7]
2024-10-12 13:26:44,086 [trainer.py] => CNN top5 curve: [98.66]

2024-10-12 13:26:44,086 [trainer.py] => Average Accuracy (CNN): 88.7
2024-10-12 13:26:44,087 [trainer.py] => All params: 151197697
2024-10-12 13:26:44,088 [trainer.py] => Trainable params: 1576961
2024-10-12 13:26:44,093 [proof.py] => Learning on 50-60
2024-10-12 13:29:02,352 [base.py] => Reducing exemplars...(33 per classes)
2024-10-12 13:29:24,211 [base.py] => Constructing exemplars...(33 per classes)
2024-10-12 13:30:19,242 [proof.py] => Exemplar size: 1980
2024-10-12 13:30:19,243 [trainer.py] => CNN: {'total': 85.0, '00-09': 84.6, '10-19': 81.3, '20-29': 88.1, '30-39': 82.8, '40-49': 84.7, '50-59': 88.5, 'old': 84.3, 'new': 88.5, 'harmonic': 86.35}
2024-10-12 13:30:19,243 [trainer.py] => CNN top1 curve: [88.7, 85.0]
2024-10-12 13:30:19,243 [trainer.py] => CNN top5 curve: [98.66, 97.88]

2024-10-12 13:30:19,243 [trainer.py] => Average Accuracy (CNN): 86.85
2024-10-12 13:30:19,245 [trainer.py] => All params: 151724545
2024-10-12 13:30:19,246 [trainer.py] => Trainable params: 1839617
2024-10-12 13:30:19,254 [proof.py] => Learning on 60-70
2024-10-12 13:32:51,609 [base.py] => Reducing exemplars...(28 per classes)
2024-10-12 13:33:22,877 [base.py] => Constructing exemplars...(28 per classes)
2024-10-12 13:34:23,132 [proof.py] => Exemplar size: 1960
2024-10-12 13:34:23,132 [trainer.py] => CNN: {'total': 84.53, '00-09': 85.4, '10-19': 79.8, '20-29': 86.8, '30-39': 80.9, '40-49': 84.0, '50-59': 81.5, '60-69': 93.3, 'old': 83.07, 'new': 93.3, 'harmonic': 87.89}
2024-10-12 13:34:23,132 [trainer.py] => CNN top1 curve: [88.7, 85.0, 84.53]
2024-10-12 13:34:23,133 [trainer.py] => CNN top5 curve: [98.66, 97.88, 97.77]

2024-10-12 13:34:23,133 [trainer.py] => Average Accuracy (CNN): 86.07666666666667
2024-10-12 13:34:23,134 [trainer.py] => All params: 152251393
2024-10-12 13:34:23,135 [trainer.py] => Trainable params: 2102273
2024-10-12 13:34:23,142 [proof.py] => Learning on 70-80
2024-10-12 13:37:04,047 [base.py] => Reducing exemplars...(25 per classes)
2024-10-12 13:37:42,029 [base.py] => Constructing exemplars...(25 per classes)
2024-10-12 13:38:42,639 [proof.py] => Exemplar size: 2000
2024-10-12 13:38:42,640 [trainer.py] => CNN: {'total': 81.8, '00-09': 84.4, '10-19': 78.8, '20-29': 87.3, '30-39': 79.0, '40-49': 80.5, '50-59': 73.3, '60-69': 85.2, '70-79': 85.9, 'old': 81.21, 'new': 85.9, 'harmonic': 83.49}
2024-10-12 13:38:42,640 [trainer.py] => CNN top1 curve: [88.7, 85.0, 84.53, 81.8]
2024-10-12 13:38:42,640 [trainer.py] => CNN top5 curve: [98.66, 97.88, 97.77, 97.51]

2024-10-12 13:38:42,640 [trainer.py] => Average Accuracy (CNN): 85.00750000000001
2024-10-12 13:38:42,642 [trainer.py] => All params: 152778241
2024-10-12 13:38:42,643 [trainer.py] => Trainable params: 2364929
2024-10-12 13:38:42,650 [proof.py] => Learning on 80-90
2024-10-12 13:41:36,030 [base.py] => Reducing exemplars...(22 per classes)
2024-10-12 13:42:14,345 [base.py] => Constructing exemplars...(22 per classes)
2024-10-12 13:43:18,154 [proof.py] => Exemplar size: 1980
2024-10-12 13:43:18,154 [trainer.py] => CNN: {'total': 80.2, '00-09': 82.3, '10-19': 73.3, '20-29': 84.0, '30-39': 78.9, '40-49': 80.6, '50-59': 75.3, '60-69': 85.0, '70-79': 73.2, '80-89': 89.2, 'old': 79.08, 'new': 89.2, 'harmonic': 83.84}
2024-10-12 13:43:18,154 [trainer.py] => CNN top1 curve: [88.7, 85.0, 84.53, 81.8, 80.2]
2024-10-12 13:43:18,154 [trainer.py] => CNN top5 curve: [98.66, 97.88, 97.77, 97.51, 96.52]

2024-10-12 13:43:18,154 [trainer.py] => Average Accuracy (CNN): 84.046
2024-10-12 13:43:18,156 [trainer.py] => All params: 153305089
2024-10-12 13:43:18,157 [trainer.py] => Trainable params: 2627585
2024-10-12 13:43:18,164 [proof.py] => Learning on 90-100
2024-10-12 13:46:17,804 [base.py] => Reducing exemplars...(20 per classes)
2024-10-12 13:46:50,176 [base.py] => Constructing exemplars...(20 per classes)
2024-10-12 13:47:49,423 [proof.py] => Exemplar size: 2000
2024-10-12 13:47:49,423 [trainer.py] => CNN: {'total': 79.73, '00-09': 80.8, '10-19': 74.8, '20-29': 83.7, '30-39': 77.2, '40-49': 80.0, '50-59': 76.5, '60-69': 83.8, '70-79': 69.8, '80-89': 81.3, '90-99': 89.4, 'old': 78.66, 'new': 89.4, 'harmonic': 83.69}
2024-10-12 13:47:49,423 [trainer.py] => CNN top1 curve: [88.7, 85.0, 84.53, 81.8, 80.2, 79.73]
2024-10-12 13:47:49,423 [trainer.py] => CNN top5 curve: [98.66, 97.88, 97.77, 97.51, 96.52, 96.12]
2024-10-12 13:47:49,423 [trainer.py] => Average Accuracy (CNN): 83.32

