2024-10-12 13:07:57,973 [trainer.py] => config: ./exps/cifar.json
2024-10-12 13:07:57,973 [trainer.py] => prefix: -
2024-10-12 13:07:57,973 [trainer.py] => dataset: cifar224
2024-10-12 13:07:57,973 [trainer.py] => memory_size: 2000
2024-10-12 13:07:57,973 [trainer.py] => memory_per_class: 20
2024-10-12 13:07:57,973 [trainer.py] => fixed_memory: False
2024-10-12 13:07:57,974 [trainer.py] => shuffle: True
2024-10-12 13:07:57,974 [trainer.py] => init_cls: 10
2024-10-12 13:07:57,974 [trainer.py] => increment: 10
2024-10-12 13:07:57,974 [trainer.py] => model_name: proof
2024-10-12 13:07:57,974 [trainer.py] => convnet_type: clip
2024-10-12 13:07:57,974 [trainer.py] => device: [device(type='cuda', index=0)]
2024-10-12 13:07:57,974 [trainer.py] => seed: 1993
2024-10-12 13:07:57,974 [trainer.py] => projection_type: pure_mlp
2024-10-12 13:07:57,974 [trainer.py] => frozen_layers: visual
2024-10-12 13:07:57,974 [trainer.py] => tuned_epoch: 5
2024-10-12 13:07:57,974 [trainer.py] => init_lr: 0.001
2024-10-12 13:07:57,974 [trainer.py] => batch_size: 64
2024-10-12 13:07:57,974 [trainer.py] => weight_decay: 0.05
2024-10-12 13:07:57,974 [trainer.py] => min_lr: 0
2024-10-12 13:07:57,974 [trainer.py] => optimizer: sgd
2024-10-12 13:07:59,522 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-10-12 13:08:00,841 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 13:09:42,904 [trainer.py] => config: ./exps/cifar.json
2024-10-12 13:09:42,905 [trainer.py] => prefix: -
2024-10-12 13:09:42,905 [trainer.py] => dataset: cifar224
2024-10-12 13:09:42,905 [trainer.py] => memory_size: 2000
2024-10-12 13:09:42,905 [trainer.py] => memory_per_class: 20
2024-10-12 13:09:42,905 [trainer.py] => fixed_memory: False
2024-10-12 13:09:42,905 [trainer.py] => shuffle: True
2024-10-12 13:09:42,905 [trainer.py] => init_cls: 10
2024-10-12 13:09:42,905 [trainer.py] => increment: 10
2024-10-12 13:09:42,905 [trainer.py] => model_name: proof
2024-10-12 13:09:42,905 [trainer.py] => convnet_type: clip
2024-10-12 13:09:42,905 [trainer.py] => device: [device(type='cuda', index=0)]
2024-10-12 13:09:42,905 [trainer.py] => seed: 1993
2024-10-12 13:09:42,905 [trainer.py] => projection_type: pure_mlp
2024-10-12 13:09:42,905 [trainer.py] => frozen_layers: visual
2024-10-12 13:09:42,905 [trainer.py] => tuned_epoch: 5
2024-10-12 13:09:42,905 [trainer.py] => init_lr: 0.001
2024-10-12 13:09:42,905 [trainer.py] => batch_size: 64
2024-10-12 13:09:42,905 [trainer.py] => weight_decay: 0.05
2024-10-12 13:09:42,905 [trainer.py] => min_lr: 0
2024-10-12 13:09:42,905 [trainer.py] => optimizer: sgd
2024-10-12 13:09:44,376 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-10-12 13:09:45,471 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 13:09:47,280 [factory.py] => Loaded ViT-B-16 model config.
2024-10-12 13:09:49,134 [trainer.py] => All params: 150670849
2024-10-12 13:09:49,135 [trainer.py] => Trainable params: 150670849
2024-10-12 13:09:49,341 [proof.py] => Learning on 0-10
2024-10-12 13:11:06,534 [base.py] => Reducing exemplars...(200 per classes)
2024-10-12 13:11:06,534 [base.py] => Constructing exemplars...(200 per classes)
2024-10-12 13:11:50,618 [proof.py] => Exemplar size: 2000
2024-10-12 13:11:50,618 [trainer.py] => CNN: {'total': 97.8, '00-09': 97.8, 'old': 0, 'new': 97.8, 'harmonic': 0.0}
2024-10-12 13:11:50,618 [trainer.py] => CNN top1 curve: [97.8]
2024-10-12 13:11:50,619 [trainer.py] => CNN top5 curve: [100.0]

2024-10-12 13:11:50,619 [trainer.py] => Average Accuracy (CNN): 97.8
2024-10-12 13:11:50,620 [trainer.py] => All params: 151197697
2024-10-12 13:11:50,621 [trainer.py] => Trainable params: 1576961
2024-10-12 13:11:50,626 [proof.py] => Learning on 10-20
2024-10-12 13:13:33,961 [base.py] => Reducing exemplars...(100 per classes)
2024-10-12 13:13:40,910 [base.py] => Constructing exemplars...(100 per classes)
2024-10-12 13:14:24,902 [proof.py] => Exemplar size: 2000
2024-10-12 13:14:24,902 [trainer.py] => CNN: {'total': 93.7, '00-09': 94.9, '10-19': 92.5, 'old': 94.9, 'new': 92.5, 'harmonic': 93.68}
2024-10-12 13:14:24,902 [trainer.py] => CNN top1 curve: [97.8, 93.7]
2024-10-12 13:14:24,902 [trainer.py] => CNN top5 curve: [100.0, 99.6]

2024-10-12 13:14:24,902 [trainer.py] => Average Accuracy (CNN): 95.75
2024-10-12 13:14:24,904 [trainer.py] => All params: 151724545
2024-10-12 13:14:24,905 [trainer.py] => Trainable params: 1839617
2024-10-12 13:14:24,914 [proof.py] => Learning on 20-30
2024-10-12 13:16:20,313 [base.py] => Reducing exemplars...(66 per classes)
2024-10-12 13:16:30,762 [base.py] => Constructing exemplars...(66 per classes)
2024-10-12 13:17:12,811 [proof.py] => Exemplar size: 1980
2024-10-12 13:17:12,812 [trainer.py] => CNN: {'total': 91.53, '00-09': 92.7, '10-19': 88.8, '20-29': 93.1, 'old': 90.75, 'new': 93.1, 'harmonic': 91.91}
2024-10-12 13:17:12,812 [trainer.py] => CNN top1 curve: [97.8, 93.7, 91.53]
2024-10-12 13:17:12,812 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.03]

2024-10-12 13:17:12,812 [trainer.py] => Average Accuracy (CNN): 94.34333333333332
2024-10-12 13:17:12,813 [trainer.py] => All params: 152251393
2024-10-12 13:17:12,814 [trainer.py] => Trainable params: 2102273
2024-10-12 13:17:12,819 [proof.py] => Learning on 30-40
2024-10-12 13:19:13,022 [base.py] => Reducing exemplars...(50 per classes)
2024-10-12 13:19:28,725 [base.py] => Constructing exemplars...(50 per classes)
2024-10-12 13:20:14,106 [proof.py] => Exemplar size: 2000
2024-10-12 13:20:14,107 [trainer.py] => CNN: {'total': 88.38, '00-09': 89.8, '10-19': 87.1, '20-29': 89.7, '30-39': 86.9, 'old': 88.87, 'new': 86.9, 'harmonic': 87.87}
2024-10-12 13:20:14,107 [trainer.py] => CNN top1 curve: [97.8, 93.7, 91.53, 88.38]
2024-10-12 13:20:14,107 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.03, 98.75]

2024-10-12 13:20:14,107 [trainer.py] => Average Accuracy (CNN): 92.85249999999999
2024-10-12 13:20:14,108 [trainer.py] => All params: 152778241
2024-10-12 13:20:14,109 [trainer.py] => Trainable params: 2364929
2024-10-12 13:20:14,115 [proof.py] => Learning on 40-50
2024-10-12 13:22:23,043 [base.py] => Reducing exemplars...(40 per classes)
2024-10-12 13:22:40,787 [base.py] => Constructing exemplars...(40 per classes)
2024-10-12 13:23:29,222 [proof.py] => Exemplar size: 2000
2024-10-12 13:23:29,222 [trainer.py] => CNN: {'total': 86.6, '00-09': 88.3, '10-19': 82.3, '20-29': 89.5, '30-39': 82.2, '40-49': 90.7, 'old': 85.58, 'new': 90.7, 'harmonic': 88.07}
2024-10-12 13:23:29,223 [trainer.py] => CNN top1 curve: [97.8, 93.7, 91.53, 88.38, 86.6]
2024-10-12 13:23:29,223 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.03, 98.75, 98.36]

2024-10-12 13:23:29,223 [trainer.py] => Average Accuracy (CNN): 91.602
2024-10-12 13:23:29,224 [trainer.py] => All params: 153305089
2024-10-12 13:23:29,224 [trainer.py] => Trainable params: 2627585
2024-10-12 13:23:29,228 [proof.py] => Learning on 50-60
2024-10-12 13:25:49,971 [base.py] => Reducing exemplars...(33 per classes)
2024-10-12 13:26:15,590 [base.py] => Constructing exemplars...(33 per classes)
2024-10-12 13:27:04,216 [proof.py] => Exemplar size: 1980
2024-10-12 13:27:04,216 [trainer.py] => CNN: {'total': 85.27, '00-09': 87.1, '10-19': 82.9, '20-29': 87.7, '30-39': 82.5, '40-49': 85.1, '50-59': 86.3, 'old': 85.06, 'new': 86.3, 'harmonic': 85.68}
2024-10-12 13:27:04,217 [trainer.py] => CNN top1 curve: [97.8, 93.7, 91.53, 88.38, 86.6, 85.27]
2024-10-12 13:27:04,217 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.03, 98.75, 98.36, 98.02]

2024-10-12 13:27:04,217 [trainer.py] => Average Accuracy (CNN): 90.54666666666667
2024-10-12 13:27:04,218 [trainer.py] => All params: 153831937
2024-10-12 13:27:04,218 [trainer.py] => Trainable params: 2890241
2024-10-12 13:27:04,223 [proof.py] => Learning on 60-70
2024-10-12 13:29:43,978 [base.py] => Reducing exemplars...(28 per classes)
2024-10-12 13:30:12,672 [base.py] => Constructing exemplars...(28 per classes)
2024-10-12 13:31:08,486 [proof.py] => Exemplar size: 1960
2024-10-12 13:31:08,486 [trainer.py] => CNN: {'total': 84.3, '00-09': 86.1, '10-19': 79.8, '20-29': 86.8, '30-39': 79.7, '40-49': 84.9, '50-59': 81.0, '60-69': 91.8, 'old': 83.05, 'new': 91.8, 'harmonic': 87.21}
2024-10-12 13:31:08,486 [trainer.py] => CNN top1 curve: [97.8, 93.7, 91.53, 88.38, 86.6, 85.27, 84.3]
2024-10-12 13:31:08,486 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.03, 98.75, 98.36, 98.02, 97.56]

2024-10-12 13:31:08,486 [trainer.py] => Average Accuracy (CNN): 89.6542857142857
2024-10-12 13:31:08,488 [trainer.py] => All params: 154358785
2024-10-12 13:31:08,488 [trainer.py] => Trainable params: 3152897
2024-10-12 13:31:08,492 [proof.py] => Learning on 70-80
2024-10-12 13:33:49,381 [base.py] => Reducing exemplars...(25 per classes)
2024-10-12 13:34:28,048 [base.py] => Constructing exemplars...(25 per classes)
2024-10-12 13:35:27,207 [proof.py] => Exemplar size: 2000
2024-10-12 13:35:27,207 [trainer.py] => CNN: {'total': 81.22, '00-09': 83.9, '10-19': 77.3, '20-29': 86.1, '30-39': 79.9, '40-49': 79.3, '50-59': 72.4, '60-69': 85.1, '70-79': 85.8, 'old': 80.57, 'new': 85.8, 'harmonic': 83.1}
2024-10-12 13:35:27,207 [trainer.py] => CNN top1 curve: [97.8, 93.7, 91.53, 88.38, 86.6, 85.27, 84.3, 81.22]
2024-10-12 13:35:27,207 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.03, 98.75, 98.36, 98.02, 97.56, 97.32]

2024-10-12 13:35:27,207 [trainer.py] => Average Accuracy (CNN): 88.6
2024-10-12 13:35:27,209 [trainer.py] => All params: 154885633
2024-10-12 13:35:27,210 [trainer.py] => Trainable params: 3415553
2024-10-12 13:35:27,215 [proof.py] => Learning on 80-90
2024-10-12 13:38:19,480 [base.py] => Reducing exemplars...(22 per classes)
2024-10-12 13:38:59,674 [base.py] => Constructing exemplars...(22 per classes)
2024-10-12 13:40:02,445 [proof.py] => Exemplar size: 1980
2024-10-12 13:40:02,446 [trainer.py] => CNN: {'total': 79.82, '00-09': 82.0, '10-19': 72.5, '20-29': 82.8, '30-39': 79.7, '40-49': 78.7, '50-59': 75.3, '60-69': 82.3, '70-79': 77.3, '80-89': 87.8, 'old': 78.82, 'new': 87.8, 'harmonic': 83.07}
2024-10-12 13:40:02,446 [trainer.py] => CNN top1 curve: [97.8, 93.7, 91.53, 88.38, 86.6, 85.27, 84.3, 81.22, 79.82]
2024-10-12 13:40:02,446 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.03, 98.75, 98.36, 98.02, 97.56, 97.32, 96.54]

2024-10-12 13:40:02,446 [trainer.py] => Average Accuracy (CNN): 87.62444444444444
2024-10-12 13:40:02,448 [trainer.py] => All params: 155412481
2024-10-12 13:40:02,450 [trainer.py] => Trainable params: 3678209
2024-10-12 13:40:02,456 [proof.py] => Learning on 90-100
2024-10-12 13:43:01,873 [base.py] => Reducing exemplars...(20 per classes)
2024-10-12 13:43:46,952 [base.py] => Constructing exemplars...(20 per classes)
2024-10-12 13:44:55,203 [proof.py] => Exemplar size: 2000
2024-10-12 13:44:55,203 [trainer.py] => CNN: {'total': 79.11, '00-09': 79.6, '10-19': 72.7, '20-29': 82.1, '30-39': 78.2, '40-49': 77.2, '50-59': 75.0, '60-69': 82.7, '70-79': 74.4, '80-89': 80.1, '90-99': 89.1, 'old': 78.0, 'new': 89.1, 'harmonic': 83.18}
2024-10-12 13:44:55,203 [trainer.py] => CNN top1 curve: [97.8, 93.7, 91.53, 88.38, 86.6, 85.27, 84.3, 81.22, 79.82, 79.11]
2024-10-12 13:44:55,203 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.03, 98.75, 98.36, 98.02, 97.56, 97.32, 96.54, 96.02]

2024-10-12 13:44:55,203 [trainer.py] => Average Accuracy (CNN): 86.773
