2023-05-08 15:00:48,777 [trainer.py] => config: ././exp3//food101/food101_memo_transformer_clip.json
2023-05-08 15:00:48,777 [trainer.py] => prefix: reproduce
2023-05-08 15:00:48,777 [trainer.py] => dataset: food101
2023-05-08 15:00:48,777 [trainer.py] => memory_size: 2000
2023-05-08 15:00:48,777 [trainer.py] => memory_per_class: 20
2023-05-08 15:00:48,777 [trainer.py] => fixed_memory: False
2023-05-08 15:00:48,778 [trainer.py] => shuffle: True
2023-05-08 15:00:48,778 [trainer.py] => init_cls: 10
2023-05-08 15:00:48,778 [trainer.py] => increment: 10
2023-05-08 15:00:48,778 [trainer.py] => model_name: memo_transformer
2023-05-08 15:00:48,778 [trainer.py] => convnet_type: clip
2023-05-08 15:00:48,778 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-08 15:00:48,778 [trainer.py] => seed: 1993
2023-05-08 15:00:48,778 [trainer.py] => projection_type: pure_mlp
2023-05-08 15:00:48,778 [trainer.py] => fusion_choice: transformer
2023-05-08 15:00:48,778 [trainer.py] => split_train: False
2023-05-08 15:00:48,778 [trainer.py] => tsne_option: False
2023-05-08 15:00:48,778 [trainer.py] => laion_check: False
2023-05-08 15:00:48,778 [trainer.py] => train_tasks: 999
2023-05-08 15:00:48,778 [trainer.py] => frozen_layers: visual
2023-05-08 15:00:48,778 [trainer.py] => tuned_epoch: 5
2023-05-08 15:00:48,778 [trainer.py] => first_epoch: 5
2023-05-08 15:00:48,778 [trainer.py] => init_lr: 0.001
2023-05-08 15:00:48,778 [trainer.py] => batch_size: 64
2023-05-08 15:00:48,778 [trainer.py] => weight_decay: 0.05
2023-05-08 15:00:48,778 [trainer.py] => min_lr: 0
2023-05-08 15:00:48,778 [trainer.py] => optimizer: sgd
2023-05-08 15:00:50,223 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-08 15:01:54,512 [instantiator.py] => Created a temporary directory at /tmp/tmpyed5_f44
2023-05-08 15:01:54,516 [instantiator.py] => Writing /tmp/tmpyed5_f44/_remote_module_non_sriptable.py
2023-05-08 15:01:56,261 [factory.py] => Loaded ViT-B-16 model config.
2023-05-08 15:01:59,931 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-08 15:02:00,394 [factory.py] => Loaded ViT-B-16 model config.
2023-05-08 15:02:03,146 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-08 15:02:03,636 [trainer.py] => All params: 150670849
2023-05-08 15:02:03,637 [trainer.py] => Trainable params: 150670849
2023-05-08 15:02:06,984 [memo_transformer.py] => Learning on 0-10
2023-05-08 15:06:53,944 [memo_transformer.py] => Task 0, Epoch 5/5 => Loss 2.196, Train_acc 98.53, Test_acc 97.82
2023-05-08 15:06:53,962 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0] 
2023-05-08 15:06:53,962 [base.py] => Reducing exemplars...(200 per classes)
2023-05-08 15:06:53,963 [base.py] => Constructing exemplars...(200 per classes)
2023-05-08 15:09:48,267 [memo_transformer.py] => Exemplar size: 2000
2023-05-08 15:09:48,272 [trainer.py] => CNN: {'total': 97.82, '00-09': 97.82, 'old': 0, 'new': 97.82, 'harmonic': 0.0}
2023-05-08 15:09:48,272 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-08 15:09:48,272 [trainer.py] => CNN top1 curve: [97.82]
2023-05-08 15:09:48,272 [trainer.py] => CNN top5 curve: [99.85]
2023-05-08 15:09:48,272 [trainer.py] => NME top1 curve: [97.38]
2023-05-08 15:09:48,272 [trainer.py] => NME top5 curve: [99.8]

2023-05-08 15:09:48,272 [trainer.py] => Average Accuracy (CNN): 97.82
2023-05-08 15:09:48,272 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-08 15:09:48,272 [trainer.py] => ZS seen top1 curve: [97.92]
2023-05-08 15:09:48,272 [trainer.py] => ZS unseen top1 curve: [0.52]
2023-05-08 15:09:48,272 [trainer.py] => ZS harmonic top1 curve: [1.03]
2023-05-08 15:09:48,272 [trainer.py] => ZS total top1 curve: [10.35]
2023-05-08 15:09:48,272 [trainer.py] => Average Accuracy (ZS seen): 97.92
2023-05-08 15:09:48,272 [trainer.py] => Average Accuracy (ZS unseen): 0.52
2023-05-08 15:09:48,272 [trainer.py] => Average Accuracy (ZS harmonic): 1.03
2023-05-08 15:09:48,272 [trainer.py] => Average Accuracy (ZS total): 10.35
2023-05-08 15:09:48,273 [trainer.py] => All params: 151197697
2023-05-08 15:09:48,274 [trainer.py] => Trainable params: 1576961
2023-05-08 15:09:48,291 [memo_transformer.py] => Learning on 10-20
2023-05-08 15:16:16,597 [memo_transformer.py] => Task 1, Epoch 5/5 => Loss 2.046, Train_acc 96.58, Test_acc 94.57
2023-05-08 15:16:16,603 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-08 15:16:16,603 [base.py] => Reducing exemplars...(100 per classes)
2023-05-08 15:16:38,183 [base.py] => Constructing exemplars...(100 per classes)
2023-05-08 15:19:54,204 [memo_transformer.py] => Exemplar size: 2000
2023-05-08 15:19:54,212 [trainer.py] => CNN: {'total': 94.57, '00-09': 95.35, '10-19': 93.77, 'old': 95.35, 'new': 93.77, 'harmonic': 94.55}
2023-05-08 15:19:54,213 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-08 15:19:54,213 [trainer.py] => CNN top1 curve: [97.82, 94.57]
2023-05-08 15:19:54,213 [trainer.py] => CNN top5 curve: [99.85, 99.52]
2023-05-08 15:19:54,213 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-08 15:19:54,213 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-08 15:19:54,213 [trainer.py] => Average Accuracy (CNN): 96.195
2023-05-08 15:19:54,213 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-08 15:19:54,213 [trainer.py] => ZS seen top1 curve: [97.92, 94.52]
2023-05-08 15:19:54,213 [trainer.py] => ZS unseen top1 curve: [0.52, 2.82]
2023-05-08 15:19:54,213 [trainer.py] => ZS harmonic top1 curve: [1.03, 5.48]
2023-05-08 15:19:54,213 [trainer.py] => ZS total top1 curve: [10.35, 21.13]
2023-05-08 15:19:54,213 [trainer.py] => Average Accuracy (ZS seen): 96.22
2023-05-08 15:19:54,213 [trainer.py] => Average Accuracy (ZS unseen): 1.67
2023-05-08 15:19:54,213 [trainer.py] => Average Accuracy (ZS harmonic): 3.2550000000000003
2023-05-08 15:19:54,213 [trainer.py] => Average Accuracy (ZS total): 15.739999999999998
2023-05-08 15:19:54,214 [trainer.py] => All params: 151724545
2023-05-08 15:19:54,215 [trainer.py] => Trainable params: 1839617
2023-05-08 15:19:54,229 [memo_transformer.py] => Learning on 20-30
2023-05-08 15:27:10,170 [memo_transformer.py] => Task 2, Epoch 5/5 => Loss 1.991, Train_acc 96.28, Test_acc 92.50
2023-05-08 15:27:10,179 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-08 15:27:10,183 [base.py] => Reducing exemplars...(66 per classes)
2023-05-08 15:27:42,397 [base.py] => Constructing exemplars...(66 per classes)
2023-05-08 15:31:15,458 [memo_transformer.py] => Exemplar size: 1980
2023-05-08 15:31:15,478 [trainer.py] => CNN: {'total': 92.5, '00-09': 93.02, '10-19': 91.29, '20-29': 93.16, 'old': 92.17, 'new': 93.16, 'harmonic': 92.66}
2023-05-08 15:31:15,478 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-08 15:31:15,479 [trainer.py] => CNN top1 curve: [97.82, 94.57, 92.5]
2023-05-08 15:31:15,479 [trainer.py] => CNN top5 curve: [99.85, 99.52, 99.25]
2023-05-08 15:31:15,479 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-08 15:31:15,479 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-08 15:31:15,479 [trainer.py] => Average Accuracy (CNN): 94.96333333333332
2023-05-08 15:31:15,479 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-08 15:31:15,479 [trainer.py] => ZS seen top1 curve: [97.92, 94.52, 92.06]
2023-05-08 15:31:15,479 [trainer.py] => ZS unseen top1 curve: [0.52, 2.82, 6.47]
2023-05-08 15:31:15,479 [trainer.py] => ZS harmonic top1 curve: [1.03, 5.48, 12.09]
2023-05-08 15:31:15,479 [trainer.py] => ZS total top1 curve: [10.35, 21.13, 32.13]
2023-05-08 15:31:15,479 [trainer.py] => Average Accuracy (ZS seen): 94.83333333333333
2023-05-08 15:31:15,479 [trainer.py] => Average Accuracy (ZS unseen): 3.2699999999999996
2023-05-08 15:31:15,479 [trainer.py] => Average Accuracy (ZS harmonic): 6.2
2023-05-08 15:31:15,479 [trainer.py] => Average Accuracy (ZS total): 21.203333333333333
2023-05-08 15:31:15,480 [trainer.py] => All params: 152251393
2023-05-08 15:31:15,481 [trainer.py] => Trainable params: 2102273
2023-05-08 15:31:15,494 [memo_transformer.py] => Learning on 30-40
2023-05-08 15:39:21,272 [memo_transformer.py] => Task 3, Epoch 5/5 => Loss 1.951, Train_acc 96.98, Test_acc 91.04
2023-05-08 15:39:21,272 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-08 15:39:21,276 [base.py] => Reducing exemplars...(50 per classes)
2023-05-08 15:40:05,745 [base.py] => Constructing exemplars...(50 per classes)
2023-05-08 15:43:59,704 [memo_transformer.py] => Exemplar size: 2000
2023-05-08 15:43:59,718 [trainer.py] => CNN: {'total': 91.04, '00-09': 91.58, '10-19': 90.23, '20-29': 88.62, '30-39': 93.64, 'old': 90.15, 'new': 93.64, 'harmonic': 91.86}
2023-05-08 15:43:59,718 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-08 15:43:59,718 [trainer.py] => CNN top1 curve: [97.82, 94.57, 92.5, 91.04]
2023-05-08 15:43:59,718 [trainer.py] => CNN top5 curve: [99.85, 99.52, 99.25, 98.91]
2023-05-08 15:43:59,718 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-08 15:43:59,718 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-08 15:43:59,718 [trainer.py] => Average Accuracy (CNN): 93.9825
2023-05-08 15:43:59,718 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-08 15:43:59,718 [trainer.py] => ZS seen top1 curve: [97.92, 94.52, 92.06, 90.52]
2023-05-08 15:43:59,718 [trainer.py] => ZS unseen top1 curve: [0.52, 2.82, 6.47, 11.57]
2023-05-08 15:43:59,718 [trainer.py] => ZS harmonic top1 curve: [1.03, 5.48, 12.09, 20.52]
2023-05-08 15:43:59,718 [trainer.py] => ZS total top1 curve: [10.35, 21.13, 32.13, 43.36]
2023-05-08 15:43:59,718 [trainer.py] => Average Accuracy (ZS seen): 93.755
2023-05-08 15:43:59,718 [trainer.py] => Average Accuracy (ZS unseen): 5.345
2023-05-08 15:43:59,718 [trainer.py] => Average Accuracy (ZS harmonic): 9.780000000000001
2023-05-08 15:43:59,718 [trainer.py] => Average Accuracy (ZS total): 26.7425
2023-05-08 15:43:59,719 [trainer.py] => All params: 152778241
2023-05-08 15:43:59,720 [trainer.py] => Trainable params: 2364929
2023-05-08 15:43:59,733 [memo_transformer.py] => Learning on 40-50
2023-05-08 15:52:55,520 [memo_transformer.py] => Task 4, Epoch 5/5 => Loss 1.878, Train_acc 97.77, Test_acc 89.31
2023-05-08 15:52:55,533 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-08 15:52:55,537 [base.py] => Reducing exemplars...(40 per classes)
2023-05-08 15:53:44,409 [base.py] => Constructing exemplars...(40 per classes)
2023-05-08 15:57:59,162 [memo_transformer.py] => Exemplar size: 2000
2023-05-08 15:57:59,183 [trainer.py] => CNN: {'total': 89.31, '00-09': 88.37, '10-19': 89.82, '20-29': 86.97, '30-39': 87.43, '40-49': 94.06, 'old': 88.14, 'new': 94.06, 'harmonic': 91.0}
2023-05-08 15:57:59,183 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-08 15:57:59,183 [trainer.py] => CNN top1 curve: [97.82, 94.57, 92.5, 91.04, 89.31]
2023-05-08 15:57:59,184 [trainer.py] => CNN top5 curve: [99.85, 99.52, 99.25, 98.91, 98.41]
2023-05-08 15:57:59,184 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-08 15:57:59,184 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-08 15:57:59,184 [trainer.py] => Average Accuracy (CNN): 93.048
2023-05-08 15:57:59,184 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-08 15:57:59,184 [trainer.py] => ZS seen top1 curve: [97.92, 94.52, 92.06, 90.52, 88.87]
2023-05-08 15:57:59,184 [trainer.py] => ZS unseen top1 curve: [0.52, 2.82, 6.47, 11.57, 17.03]
2023-05-08 15:57:59,184 [trainer.py] => ZS harmonic top1 curve: [1.03, 5.48, 12.09, 20.52, 28.58]
2023-05-08 15:57:59,184 [trainer.py] => ZS total top1 curve: [10.35, 21.13, 32.13, 43.36, 53.09]
2023-05-08 15:57:59,184 [trainer.py] => Average Accuracy (ZS seen): 92.77799999999999
2023-05-08 15:57:59,184 [trainer.py] => Average Accuracy (ZS unseen): 7.6819999999999995
2023-05-08 15:57:59,184 [trainer.py] => Average Accuracy (ZS harmonic): 13.540000000000001
2023-05-08 15:57:59,184 [trainer.py] => Average Accuracy (ZS total): 32.012
2023-05-08 15:57:59,186 [trainer.py] => All params: 153305089
2023-05-08 15:57:59,187 [trainer.py] => Trainable params: 2627585
2023-05-08 15:57:59,207 [memo_transformer.py] => Learning on 50-60
2023-05-08 16:07:46,611 [memo_transformer.py] => Task 5, Epoch 5/5 => Loss 1.946, Train_acc 97.34, Test_acc 87.96
2023-05-08 16:07:46,628 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-08 16:07:46,628 [base.py] => Reducing exemplars...(33 per classes)
2023-05-08 16:08:51,515 [base.py] => Constructing exemplars...(33 per classes)
2023-05-08 16:13:22,024 [memo_transformer.py] => Exemplar size: 1980
2023-05-08 16:13:22,049 [trainer.py] => CNN: {'total': 87.96, '00-09': 86.93, '10-19': 87.49, '20-29': 85.82, '30-39': 85.49, '40-49': 89.13, '50-59': 92.94, 'old': 86.96, 'new': 92.94, 'harmonic': 89.85}
2023-05-08 16:13:22,049 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-08 16:13:22,049 [trainer.py] => CNN top1 curve: [97.82, 94.57, 92.5, 91.04, 89.31, 87.96]
2023-05-08 16:13:22,049 [trainer.py] => CNN top5 curve: [99.85, 99.52, 99.25, 98.91, 98.41, 98.08]
2023-05-08 16:13:22,049 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-08 16:13:22,049 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-08 16:13:22,050 [trainer.py] => Average Accuracy (CNN): 92.2
2023-05-08 16:13:22,050 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-08 16:13:22,050 [trainer.py] => ZS seen top1 curve: [97.92, 94.52, 92.06, 90.52, 88.87, 87.85]
2023-05-08 16:13:22,050 [trainer.py] => ZS unseen top1 curve: [0.52, 2.82, 6.47, 11.57, 17.03, 17.92]
2023-05-08 16:13:22,050 [trainer.py] => ZS harmonic top1 curve: [1.03, 5.48, 12.09, 20.52, 28.58, 29.77]
2023-05-08 16:13:22,050 [trainer.py] => ZS total top1 curve: [10.35, 21.13, 32.13, 43.36, 53.09, 60.04]
2023-05-08 16:13:22,050 [trainer.py] => Average Accuracy (ZS seen): 91.95666666666666
2023-05-08 16:13:22,050 [trainer.py] => Average Accuracy (ZS unseen): 9.388333333333334
2023-05-08 16:13:22,050 [trainer.py] => Average Accuracy (ZS harmonic): 16.245
2023-05-08 16:13:22,050 [trainer.py] => Average Accuracy (ZS total): 36.68333333333333
2023-05-08 16:13:22,051 [trainer.py] => All params: 153831937
2023-05-08 16:13:22,052 [trainer.py] => Trainable params: 2890241
2023-05-08 16:13:22,071 [memo_transformer.py] => Learning on 60-70
2023-05-08 16:24:00,834 [memo_transformer.py] => Task 6, Epoch 5/5 => Loss 2.218, Train_acc 94.06, Test_acc 84.61
2023-05-08 16:24:00,867 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-08 16:24:00,871 [base.py] => Reducing exemplars...(28 per classes)
2023-05-08 16:25:03,901 [base.py] => Constructing exemplars...(28 per classes)
2023-05-08 16:29:56,634 [memo_transformer.py] => Exemplar size: 1960
2023-05-08 16:29:56,664 [trainer.py] => CNN: {'total': 84.61, '00-09': 84.21, '10-19': 86.73, '20-29': 81.98, '30-39': 82.82, '40-49': 85.1, '50-59': 81.89, '60-69': 89.7, 'old': 83.77, 'new': 89.7, 'harmonic': 86.63}
2023-05-08 16:29:56,664 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-08 16:29:56,664 [trainer.py] => CNN top1 curve: [97.82, 94.57, 92.5, 91.04, 89.31, 87.96, 84.61]
2023-05-08 16:29:56,664 [trainer.py] => CNN top5 curve: [99.85, 99.52, 99.25, 98.91, 98.41, 98.08, 97.53]
2023-05-08 16:29:56,664 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-08 16:29:56,664 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-08 16:29:56,664 [trainer.py] => Average Accuracy (CNN): 91.11571428571429
2023-05-08 16:29:56,664 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-08 16:29:56,664 [trainer.py] => ZS seen top1 curve: [97.92, 94.52, 92.06, 90.52, 88.87, 87.85, 85.14]
2023-05-08 16:29:56,664 [trainer.py] => ZS unseen top1 curve: [0.52, 2.82, 6.47, 11.57, 17.03, 17.92, 25.38]
2023-05-08 16:29:56,664 [trainer.py] => ZS harmonic top1 curve: [1.03, 5.48, 12.09, 20.52, 28.58, 29.77, 39.1]
2023-05-08 16:29:56,664 [trainer.py] => ZS total top1 curve: [10.35, 21.13, 32.13, 43.36, 53.09, 60.04, 67.29]
2023-05-08 16:29:56,664 [trainer.py] => Average Accuracy (ZS seen): 90.98285714285714
2023-05-08 16:29:56,664 [trainer.py] => Average Accuracy (ZS unseen): 11.672857142857142
2023-05-08 16:29:56,664 [trainer.py] => Average Accuracy (ZS harmonic): 19.509999999999998
2023-05-08 16:29:56,664 [trainer.py] => Average Accuracy (ZS total): 41.05571428571428
2023-05-08 16:29:56,666 [trainer.py] => All params: 154358785
2023-05-08 16:29:56,667 [trainer.py] => Trainable params: 3152897
2023-05-08 16:29:56,681 [memo_transformer.py] => Learning on 70-80
2023-05-08 16:41:19,841 [memo_transformer.py] => Task 7, Epoch 5/5 => Loss 2.017, Train_acc 96.41, Test_acc 84.09
2023-05-08 16:41:19,853 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-08 16:41:19,857 [base.py] => Reducing exemplars...(25 per classes)
2023-05-08 16:42:19,061 [base.py] => Constructing exemplars...(25 per classes)
2023-05-08 16:47:10,914 [memo_transformer.py] => Exemplar size: 2000
2023-05-08 16:47:10,941 [trainer.py] => CNN: {'total': 84.09, '00-09': 85.5, '10-19': 85.32, '20-29': 80.73, '30-39': 79.85, '40-49': 85.51, '50-59': 82.34, '60-69': 78.48, '70-79': 95.1, 'old': 82.52, 'new': 95.1, 'harmonic': 88.36}
2023-05-08 16:47:10,941 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-08 16:47:10,941 [trainer.py] => CNN top1 curve: [97.82, 94.57, 92.5, 91.04, 89.31, 87.96, 84.61, 84.09]
2023-05-08 16:47:10,941 [trainer.py] => CNN top5 curve: [99.85, 99.52, 99.25, 98.91, 98.41, 98.08, 97.53, 96.81]
2023-05-08 16:47:10,941 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-08 16:47:10,941 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-08 16:47:10,941 [trainer.py] => Average Accuracy (CNN): 90.23750000000001
2023-05-08 16:47:10,941 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-08 16:47:10,941 [trainer.py] => ZS seen top1 curve: [97.92, 94.52, 92.06, 90.52, 88.87, 87.85, 85.14, 84.5]
2023-05-08 16:47:10,941 [trainer.py] => ZS unseen top1 curve: [0.52, 2.82, 6.47, 11.57, 17.03, 17.92, 25.38, 31.56]
2023-05-08 16:47:10,941 [trainer.py] => ZS harmonic top1 curve: [1.03, 5.48, 12.09, 20.52, 28.58, 29.77, 39.1, 45.96]
2023-05-08 16:47:10,941 [trainer.py] => ZS total top1 curve: [10.35, 21.13, 32.13, 43.36, 53.09, 60.04, 67.29, 73.99]
2023-05-08 16:47:10,941 [trainer.py] => Average Accuracy (ZS seen): 90.1725
2023-05-08 16:47:10,941 [trainer.py] => Average Accuracy (ZS unseen): 14.15875
2023-05-08 16:47:10,941 [trainer.py] => Average Accuracy (ZS harmonic): 22.81625
2023-05-08 16:47:10,941 [trainer.py] => Average Accuracy (ZS total): 45.1725
2023-05-08 16:47:10,942 [trainer.py] => All params: 154885633
2023-05-08 16:47:10,943 [trainer.py] => Trainable params: 3415553
2023-05-08 16:47:10,960 [memo_transformer.py] => Learning on 80-90
2023-05-08 16:59:22,925 [memo_transformer.py] => Task 8, Epoch 5/5 => Loss 2.028, Train_acc 96.16, Test_acc 82.67
2023-05-08 16:59:22,942 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-08 16:59:22,946 [base.py] => Reducing exemplars...(22 per classes)
2023-05-08 17:00:29,987 [base.py] => Constructing exemplars...(22 per classes)
2023-05-08 17:05:46,869 [memo_transformer.py] => Exemplar size: 1980
2023-05-08 17:05:46,895 [trainer.py] => CNN: {'total': 82.67, '00-09': 84.21, '10-19': 81.37, '20-29': 80.48, '30-39': 78.64, '40-49': 82.18, '50-59': 82.19, '60-69': 73.84, '70-79': 85.56, '80-89': 95.58, 'old': 81.06, 'new': 95.58, 'harmonic': 87.72}
2023-05-08 17:05:46,895 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-08 17:05:46,895 [trainer.py] => CNN top1 curve: [97.82, 94.57, 92.5, 91.04, 89.31, 87.96, 84.61, 84.09, 82.67]
2023-05-08 17:05:46,895 [trainer.py] => CNN top5 curve: [99.85, 99.52, 99.25, 98.91, 98.41, 98.08, 97.53, 96.81, 96.44]
2023-05-08 17:05:46,895 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-08 17:05:46,895 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-08 17:05:46,895 [trainer.py] => Average Accuracy (CNN): 89.39666666666668
2023-05-08 17:05:46,895 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-08 17:05:46,895 [trainer.py] => ZS seen top1 curve: [97.92, 94.52, 92.06, 90.52, 88.87, 87.85, 85.14, 84.5, 83.83]
2023-05-08 17:05:46,895 [trainer.py] => ZS unseen top1 curve: [0.52, 2.82, 6.47, 11.57, 17.03, 17.92, 25.38, 31.56, 23.99]
2023-05-08 17:05:46,895 [trainer.py] => ZS harmonic top1 curve: [1.03, 5.48, 12.09, 20.52, 28.58, 29.77, 39.1, 45.96, 37.3]
2023-05-08 17:05:46,895 [trainer.py] => ZS total top1 curve: [10.35, 21.13, 32.13, 43.36, 53.09, 60.04, 67.29, 73.99, 77.89]
2023-05-08 17:05:46,895 [trainer.py] => Average Accuracy (ZS seen): 89.46777777777778
2023-05-08 17:05:46,895 [trainer.py] => Average Accuracy (ZS unseen): 15.25111111111111
2023-05-08 17:05:46,895 [trainer.py] => Average Accuracy (ZS harmonic): 24.425555555555555
2023-05-08 17:05:46,895 [trainer.py] => Average Accuracy (ZS total): 48.80777777777777
2023-05-08 17:05:46,896 [trainer.py] => All params: 155412481
2023-05-08 17:05:46,897 [trainer.py] => Trainable params: 3678209
2023-05-08 17:05:46,911 [memo_transformer.py] => Learning on 90-100
2023-05-08 17:18:51,239 [memo_transformer.py] => Task 9, Epoch 5/5 => Loss 2.134, Train_acc 94.85, Test_acc 79.71
2023-05-08 17:18:51,266 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-08 17:18:51,270 [base.py] => Reducing exemplars...(20 per classes)
2023-05-08 17:20:11,597 [base.py] => Constructing exemplars...(20 per classes)
2023-05-08 17:25:45,471 [memo_transformer.py] => Exemplar size: 2000
2023-05-08 17:25:45,505 [trainer.py] => CNN: {'total': 79.71, '00-09': 82.08, '10-19': 81.32, '20-29': 72.84, '30-39': 77.18, '40-49': 79.77, '50-59': 75.32, '60-69': 68.94, '70-79': 81.21, '80-89': 84.69, '90-99': 93.9, 'old': 78.15, 'new': 93.9, 'harmonic': 85.3}
2023-05-08 17:25:45,506 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-08 17:25:45,506 [trainer.py] => CNN top1 curve: [97.82, 94.57, 92.5, 91.04, 89.31, 87.96, 84.61, 84.09, 82.67, 79.71]
2023-05-08 17:25:45,506 [trainer.py] => CNN top5 curve: [99.85, 99.52, 99.25, 98.91, 98.41, 98.08, 97.53, 96.81, 96.44, 95.92]
2023-05-08 17:25:45,506 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-08 17:25:45,506 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-08 17:25:45,506 [trainer.py] => Average Accuracy (CNN): 88.42800000000001
2023-05-08 17:25:45,506 [trainer.py] => Average Accuracy (NME): 87.828
2023-05-08 17:25:45,506 [trainer.py] => ZS seen top1 curve: [97.92, 94.52, 92.06, 90.52, 88.87, 87.85, 85.14, 84.5, 83.83, 82.61]
2023-05-08 17:25:45,506 [trainer.py] => ZS unseen top1 curve: [0.52, 2.82, 6.47, 11.57, 17.03, 17.92, 25.38, 31.56, 23.99, 0]
2023-05-08 17:25:45,506 [trainer.py] => ZS harmonic top1 curve: [1.03, 5.48, 12.09, 20.52, 28.58, 29.77, 39.1, 45.96, 37.3, 0.0]
2023-05-08 17:25:45,506 [trainer.py] => ZS total top1 curve: [10.35, 21.13, 32.13, 43.36, 53.09, 60.04, 67.29, 73.99, 77.89, 82.61]
2023-05-08 17:25:45,506 [trainer.py] => Average Accuracy (ZS seen): 88.78200000000001
2023-05-08 17:25:45,506 [trainer.py] => Average Accuracy (ZS unseen): 13.725999999999999
2023-05-08 17:25:45,506 [trainer.py] => Average Accuracy (ZS harmonic): 21.982999999999997
2023-05-08 17:25:45,506 [trainer.py] => Average Accuracy (ZS total): 52.188
2023-05-09 15:30:49,858 [trainer.py] => config: ././exp5_mlp//food101/food101_memo_transformer_clip_4_0.002_64_0.005.json
2023-05-09 15:30:49,882 [trainer.py] => prefix: reproduce
2023-05-09 15:30:49,882 [trainer.py] => dataset: food101
2023-05-09 15:30:49,882 [trainer.py] => memory_size: 2000
2023-05-09 15:30:49,882 [trainer.py] => memory_per_class: 20
2023-05-09 15:30:49,882 [trainer.py] => fixed_memory: False
2023-05-09 15:30:49,882 [trainer.py] => shuffle: True
2023-05-09 15:30:49,882 [trainer.py] => init_cls: 10
2023-05-09 15:30:49,882 [trainer.py] => increment: 10
2023-05-09 15:30:49,882 [trainer.py] => model_name: memo_transformer
2023-05-09 15:30:49,882 [trainer.py] => convnet_type: clip
2023-05-09 15:30:49,882 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 15:30:49,882 [trainer.py] => seed: 1993
2023-05-09 15:30:49,882 [trainer.py] => projection_type: mlp
2023-05-09 15:30:49,882 [trainer.py] => fusion_choice: transformer
2023-05-09 15:30:49,882 [trainer.py] => split_train: False
2023-05-09 15:30:49,882 [trainer.py] => tsne_option: False
2023-05-09 15:30:49,882 [trainer.py] => laion_check: False
2023-05-09 15:30:49,882 [trainer.py] => train_tasks: 999
2023-05-09 15:30:49,882 [trainer.py] => frozen_layers: visual
2023-05-09 15:30:49,882 [trainer.py] => tuned_epoch: 5
2023-05-09 15:30:49,882 [trainer.py] => first_epoch: 4
2023-05-09 15:30:49,882 [trainer.py] => init_lr: 0.002
2023-05-09 15:30:49,883 [trainer.py] => batch_size: 64
2023-05-09 15:30:49,883 [trainer.py] => weight_decay: 0.005
2023-05-09 15:30:49,883 [trainer.py] => min_lr: 0
2023-05-09 15:30:49,883 [trainer.py] => optimizer: sgd
2023-05-09 15:30:50,320 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 15:30:54,144 [trainer.py] => config: ././exp5_pure_mlp//food101/food101_memo_transformer_clip_4_0.002_64_0.005.json
2023-05-09 15:30:54,161 [trainer.py] => prefix: reproduce
2023-05-09 15:30:54,161 [trainer.py] => dataset: food101
2023-05-09 15:30:54,161 [trainer.py] => memory_size: 2000
2023-05-09 15:30:54,161 [trainer.py] => memory_per_class: 20
2023-05-09 15:30:54,161 [trainer.py] => fixed_memory: False
2023-05-09 15:30:54,161 [trainer.py] => shuffle: True
2023-05-09 15:30:54,161 [trainer.py] => init_cls: 10
2023-05-09 15:30:54,161 [trainer.py] => increment: 10
2023-05-09 15:30:54,161 [trainer.py] => model_name: memo_transformer
2023-05-09 15:30:54,161 [trainer.py] => convnet_type: clip
2023-05-09 15:30:54,161 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 15:30:54,161 [trainer.py] => seed: 1993
2023-05-09 15:30:54,162 [trainer.py] => projection_type: pure_mlp
2023-05-09 15:30:54,162 [trainer.py] => fusion_choice: transformer
2023-05-09 15:30:54,162 [trainer.py] => split_train: False
2023-05-09 15:30:54,162 [trainer.py] => tsne_option: False
2023-05-09 15:30:54,162 [trainer.py] => laion_check: False
2023-05-09 15:30:54,162 [trainer.py] => train_tasks: 999
2023-05-09 15:30:54,162 [trainer.py] => frozen_layers: visual
2023-05-09 15:30:54,162 [trainer.py] => tuned_epoch: 5
2023-05-09 15:30:54,162 [trainer.py] => first_epoch: 4
2023-05-09 15:30:54,162 [trainer.py] => init_lr: 0.002
2023-05-09 15:30:54,162 [trainer.py] => batch_size: 64
2023-05-09 15:30:54,162 [trainer.py] => weight_decay: 0.005
2023-05-09 15:30:54,162 [trainer.py] => min_lr: 0
2023-05-09 15:30:54,162 [trainer.py] => optimizer: sgd
2023-05-09 15:30:54,570 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 15:31:45,512 [instantiator.py] => Created a temporary directory at /tmp/tmpflusvwgv
2023-05-09 15:31:45,465 [instantiator.py] => Created a temporary directory at /tmp/tmpd4vyczq9
2023-05-09 15:31:45,512 [instantiator.py] => Writing /tmp/tmpflusvwgv/_remote_module_non_sriptable.py
2023-05-09 15:31:45,483 [instantiator.py] => Writing /tmp/tmpd4vyczq9/_remote_module_non_sriptable.py
2023-05-09 15:31:47,153 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 15:31:47,201 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 15:31:51,091 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 15:31:51,059 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 15:31:51,380 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 15:31:51,689 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 15:31:53,914 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 15:31:54,276 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 15:31:54,307 [trainer.py] => All params: 150670849
2023-05-09 15:31:54,308 [trainer.py] => Trainable params: 150670849
2023-05-09 15:31:54,864 [trainer.py] => All params: 150670849
2023-05-09 15:31:54,866 [trainer.py] => Trainable params: 150670849
2023-05-09 15:31:57,541 [memo_transformer.py] => Learning on 0-10
2023-05-09 15:31:57,662 [memo_transformer.py] => Learning on 0-10
2023-05-09 15:35:37,019 [memo_transformer.py] => Task 0, Epoch 4/5 => Loss 2.187, Train_acc 98.21, Test_acc 97.87
2023-05-09 15:35:37,034 [memo_transformer.py] => Laion scores: [0, 0, 0, 0] 
2023-05-09 15:35:37,034 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 15:35:37,035 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 15:35:37,156 [memo_transformer.py] => Task 0, Epoch 4/5 => Loss 2.253, Train_acc 98.17, Test_acc 97.87
2023-05-09 15:35:37,157 [memo_transformer.py] => Laion scores: [0, 0, 0, 0] 
2023-05-09 15:35:37,158 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 15:35:37,158 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 15:38:25,987 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 15:38:25,999 [trainer.py] => CNN: {'total': 97.87, '00-09': 97.87, 'old': 0, 'new': 97.87, 'harmonic': 0.0}
2023-05-09 15:38:25,999 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 15:38:25,999 [trainer.py] => CNN top1 curve: [97.87]
2023-05-09 15:38:25,999 [trainer.py] => CNN top5 curve: [99.9]
2023-05-09 15:38:25,999 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 15:38:25,999 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 15:38:25,999 [trainer.py] => Average Accuracy (CNN): 97.87
2023-05-09 15:38:25,999 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 15:38:25,999 [trainer.py] => ZS seen top1 curve: [97.97]
2023-05-09 15:38:25,999 [trainer.py] => ZS unseen top1 curve: [0.58]
2023-05-09 15:38:25,999 [trainer.py] => ZS harmonic top1 curve: [1.15]
2023-05-09 15:38:25,999 [trainer.py] => ZS total top1 curve: [10.41]
2023-05-09 15:38:25,999 [trainer.py] => Average Accuracy (ZS seen): 97.97
2023-05-09 15:38:25,999 [trainer.py] => Average Accuracy (ZS unseen): 0.58
2023-05-09 15:38:25,999 [trainer.py] => Average Accuracy (ZS harmonic): 1.15
2023-05-09 15:38:25,999 [trainer.py] => Average Accuracy (ZS total): 10.41
2023-05-09 15:38:26,000 [trainer.py] => All params: 151197697
2023-05-09 15:38:26,001 [trainer.py] => Trainable params: 1576961
2023-05-09 15:38:26,016 [memo_transformer.py] => Learning on 10-20
2023-05-09 15:38:26,871 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 15:38:26,877 [trainer.py] => CNN: {'total': 97.87, '00-09': 97.87, 'old': 0, 'new': 97.87, 'harmonic': 0.0}
2023-05-09 15:38:26,877 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 15:38:26,878 [trainer.py] => CNN top1 curve: [97.87]
2023-05-09 15:38:26,878 [trainer.py] => CNN top5 curve: [99.95]
2023-05-09 15:38:26,878 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 15:38:26,878 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 15:38:26,878 [trainer.py] => Average Accuracy (CNN): 97.87
2023-05-09 15:38:26,878 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 15:38:26,878 [trainer.py] => ZS seen top1 curve: [96.88]
2023-05-09 15:38:26,878 [trainer.py] => ZS unseen top1 curve: [65.12]
2023-05-09 15:38:26,878 [trainer.py] => ZS harmonic top1 curve: [77.89]
2023-05-09 15:38:26,878 [trainer.py] => ZS total top1 curve: [68.32]
2023-05-09 15:38:26,878 [trainer.py] => Average Accuracy (ZS seen): 96.88
2023-05-09 15:38:26,878 [trainer.py] => Average Accuracy (ZS unseen): 65.12
2023-05-09 15:38:26,878 [trainer.py] => Average Accuracy (ZS harmonic): 77.89
2023-05-09 15:38:26,878 [trainer.py] => Average Accuracy (ZS total): 68.32
2023-05-09 15:38:26,879 [trainer.py] => All params: 151197697
2023-05-09 15:38:26,880 [trainer.py] => Trainable params: 1576961
2023-05-09 15:38:26,892 [memo_transformer.py] => Learning on 10-20
2023-05-09 15:43:21,559 [memo_transformer.py] => Task 1, Epoch 4/5 => Loss 2.204, Train_acc 94.41, Test_acc 94.39
2023-05-09 15:43:21,572 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 15:43:21,576 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 15:43:21,712 [memo_transformer.py] => Task 1, Epoch 4/5 => Loss 2.046, Train_acc 95.87, Test_acc 94.84
2023-05-09 15:43:21,803 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 15:43:21,803 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 15:43:42,792 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 15:43:42,904 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 15:47:07,550 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 15:47:07,600 [trainer.py] => CNN: {'total': 94.84, '00-09': 95.99, '10-19': 93.67, 'old': 95.99, 'new': 93.67, 'harmonic': 94.82}
2023-05-09 15:47:07,600 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 15:47:07,600 [trainer.py] => CNN top1 curve: [97.87, 94.84]
2023-05-09 15:47:07,600 [trainer.py] => CNN top5 curve: [99.9, 99.42]
2023-05-09 15:47:07,600 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 15:47:07,600 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 15:47:07,600 [trainer.py] => Average Accuracy (CNN): 96.355
2023-05-09 15:47:07,600 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 15:47:07,600 [trainer.py] => ZS seen top1 curve: [97.97, 94.79]
2023-05-09 15:47:07,600 [trainer.py] => ZS unseen top1 curve: [0.58, 4.15]
2023-05-09 15:47:07,600 [trainer.py] => ZS harmonic top1 curve: [1.15, 7.95]
2023-05-09 15:47:07,600 [trainer.py] => ZS total top1 curve: [10.41, 22.25]
2023-05-09 15:47:07,600 [trainer.py] => Average Accuracy (ZS seen): 96.38
2023-05-09 15:47:07,600 [trainer.py] => Average Accuracy (ZS unseen): 2.365
2023-05-09 15:47:07,600 [trainer.py] => Average Accuracy (ZS harmonic): 4.55
2023-05-09 15:47:07,601 [trainer.py] => Average Accuracy (ZS total): 16.33
2023-05-09 15:47:07,601 [trainer.py] => All params: 151724545
2023-05-09 15:47:07,602 [trainer.py] => Trainable params: 1839617
2023-05-09 15:47:07,616 [memo_transformer.py] => Learning on 20-30
2023-05-09 15:47:08,316 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 15:47:08,338 [trainer.py] => CNN: {'total': 94.39, '00-09': 95.99, '10-19': 92.76, 'old': 95.99, 'new': 92.76, 'harmonic': 94.35}
2023-05-09 15:47:08,338 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 15:47:08,338 [trainer.py] => CNN top1 curve: [97.87, 94.39]
2023-05-09 15:47:08,338 [trainer.py] => CNN top5 curve: [99.95, 99.47]
2023-05-09 15:47:08,338 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 15:47:08,338 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 15:47:08,338 [trainer.py] => Average Accuracy (CNN): 96.13
2023-05-09 15:47:08,338 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 15:47:08,338 [trainer.py] => ZS seen top1 curve: [96.88, 91.64]
2023-05-09 15:47:08,338 [trainer.py] => ZS unseen top1 curve: [65.12, 75.61]
2023-05-09 15:47:08,338 [trainer.py] => ZS harmonic top1 curve: [77.89, 82.86]
2023-05-09 15:47:08,339 [trainer.py] => ZS total top1 curve: [68.32, 78.81]
2023-05-09 15:47:08,339 [trainer.py] => Average Accuracy (ZS seen): 94.25999999999999
2023-05-09 15:47:08,339 [trainer.py] => Average Accuracy (ZS unseen): 70.36500000000001
2023-05-09 15:47:08,339 [trainer.py] => Average Accuracy (ZS harmonic): 80.375
2023-05-09 15:47:08,339 [trainer.py] => Average Accuracy (ZS total): 73.565
2023-05-09 15:47:08,340 [trainer.py] => All params: 151724545
2023-05-09 15:47:08,341 [trainer.py] => Trainable params: 1839617
2023-05-09 15:47:08,355 [memo_transformer.py] => Learning on 20-30
2023-05-09 15:52:39,428 [memo_transformer.py] => Task 2, Epoch 4/5 => Loss 2.011, Train_acc 95.52, Test_acc 92.75
2023-05-09 15:52:39,557 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 15:52:39,557 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 15:52:39,730 [memo_transformer.py] => Task 2, Epoch 4/5 => Loss 2.188, Train_acc 93.30, Test_acc 92.71
2023-05-09 15:52:39,758 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 15:52:39,759 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 15:53:05,647 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 15:53:05,750 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 15:56:18,976 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 15:56:19,063 [trainer.py] => CNN: {'total': 92.75, '00-09': 93.42, '10-19': 91.65, '20-29': 93.16, 'old': 92.54, 'new': 93.16, 'harmonic': 92.85}
2023-05-09 15:56:19,063 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 15:56:19,063 [trainer.py] => CNN top1 curve: [97.87, 94.84, 92.75]
2023-05-09 15:56:19,063 [trainer.py] => CNN top5 curve: [99.9, 99.42, 99.27]
2023-05-09 15:56:19,063 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 15:56:19,063 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 15:56:19,063 [trainer.py] => Average Accuracy (CNN): 95.15333333333335
2023-05-09 15:56:19,063 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 15:56:19,063 [trainer.py] => ZS seen top1 curve: [97.97, 94.79, 91.86]
2023-05-09 15:56:19,063 [trainer.py] => ZS unseen top1 curve: [0.58, 4.15, 8.42]
2023-05-09 15:56:19,063 [trainer.py] => ZS harmonic top1 curve: [1.15, 7.95, 15.43]
2023-05-09 15:56:19,063 [trainer.py] => ZS total top1 curve: [10.41, 22.25, 33.43]
2023-05-09 15:56:19,063 [trainer.py] => Average Accuracy (ZS seen): 94.87333333333333
2023-05-09 15:56:19,063 [trainer.py] => Average Accuracy (ZS unseen): 4.383333333333334
2023-05-09 15:56:19,063 [trainer.py] => Average Accuracy (ZS harmonic): 8.176666666666668
2023-05-09 15:56:19,064 [trainer.py] => Average Accuracy (ZS total): 22.03
2023-05-09 15:56:19,065 [trainer.py] => All params: 152251393
2023-05-09 15:56:19,068 [trainer.py] => Trainable params: 2102273
2023-05-09 15:56:19,101 [memo_transformer.py] => Learning on 30-40
2023-05-09 15:56:20,263 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 15:56:20,269 [trainer.py] => CNN: {'total': 92.71, '00-09': 94.21, '10-19': 92.51, '20-29': 91.41, 'old': 93.37, 'new': 91.41, 'harmonic': 92.38}
2023-05-09 15:56:20,269 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 15:56:20,269 [trainer.py] => CNN top1 curve: [97.87, 94.39, 92.71]
2023-05-09 15:56:20,269 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27]
2023-05-09 15:56:20,269 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 15:56:20,270 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 15:56:20,270 [trainer.py] => Average Accuracy (CNN): 94.99
2023-05-09 15:56:20,270 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 15:56:20,270 [trainer.py] => ZS seen top1 curve: [96.88, 91.64, 88.63]
2023-05-09 15:56:20,270 [trainer.py] => ZS unseen top1 curve: [65.12, 75.61, 77.88]
2023-05-09 15:56:20,270 [trainer.py] => ZS harmonic top1 curve: [77.89, 82.86, 82.91]
2023-05-09 15:56:20,270 [trainer.py] => ZS total top1 curve: [68.32, 78.81, 81.1]
2023-05-09 15:56:20,270 [trainer.py] => Average Accuracy (ZS seen): 92.38333333333333
2023-05-09 15:56:20,270 [trainer.py] => Average Accuracy (ZS unseen): 72.87
2023-05-09 15:56:20,270 [trainer.py] => Average Accuracy (ZS harmonic): 81.22
2023-05-09 15:56:20,270 [trainer.py] => Average Accuracy (ZS total): 76.07666666666667
2023-05-09 15:56:20,271 [trainer.py] => All params: 152251393
2023-05-09 15:56:20,272 [trainer.py] => Trainable params: 2102273
2023-05-09 15:56:20,284 [memo_transformer.py] => Learning on 30-40
2023-05-09 16:02:26,342 [memo_transformer.py] => Task 3, Epoch 4/5 => Loss 1.969, Train_acc 95.56, Test_acc 91.26
2023-05-09 16:02:26,418 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 16:02:26,419 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 16:02:26,757 [memo_transformer.py] => Task 3, Epoch 4/5 => Loss 2.205, Train_acc 93.48, Test_acc 91.26
2023-05-09 16:02:26,775 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 16:02:26,776 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 16:03:12,189 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 16:03:12,235 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 16:07:06,953 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 16:07:07,022 [trainer.py] => CNN: {'total': 91.26, '00-09': 92.18, '10-19': 91.24, '20-29': 88.52, '30-39': 93.06, 'old': 90.65, 'new': 93.06, 'harmonic': 91.84}
2023-05-09 16:07:07,022 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 16:07:07,022 [trainer.py] => CNN top1 curve: [97.87, 94.84, 92.75, 91.26]
2023-05-09 16:07:07,022 [trainer.py] => CNN top5 curve: [99.9, 99.42, 99.27, 98.8]
2023-05-09 16:07:07,022 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 16:07:07,023 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 16:07:07,023 [trainer.py] => Average Accuracy (CNN): 94.18
2023-05-09 16:07:07,023 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 16:07:07,023 [trainer.py] => ZS seen top1 curve: [97.97, 94.79, 91.86, 90.44]
2023-05-09 16:07:07,023 [trainer.py] => ZS unseen top1 curve: [0.58, 4.15, 8.42, 12.87]
2023-05-09 16:07:07,023 [trainer.py] => ZS harmonic top1 curve: [1.15, 7.95, 15.43, 22.53]
2023-05-09 16:07:07,023 [trainer.py] => ZS total top1 curve: [10.41, 22.25, 33.43, 44.11]
2023-05-09 16:07:07,023 [trainer.py] => Average Accuracy (ZS seen): 93.765
2023-05-09 16:07:07,023 [trainer.py] => Average Accuracy (ZS unseen): 6.505
2023-05-09 16:07:07,023 [trainer.py] => Average Accuracy (ZS harmonic): 11.765
2023-05-09 16:07:07,023 [trainer.py] => Average Accuracy (ZS total): 27.55
2023-05-09 16:07:07,024 [trainer.py] => All params: 152778241
2023-05-09 16:07:07,025 [trainer.py] => Trainable params: 2364929
2023-05-09 16:07:07,039 [memo_transformer.py] => Learning on 40-50
2023-05-09 16:07:07,704 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 16:07:07,711 [trainer.py] => CNN: {'total': 91.26, '00-09': 92.77, '10-19': 91.34, '20-29': 90.51, '30-39': 90.44, 'old': 91.55, 'new': 90.44, 'harmonic': 90.99}
2023-05-09 16:07:07,711 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 16:07:07,711 [trainer.py] => CNN top1 curve: [97.87, 94.39, 92.71, 91.26]
2023-05-09 16:07:07,711 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27, 98.98]
2023-05-09 16:07:07,711 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 16:07:07,711 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 16:07:07,712 [trainer.py] => Average Accuracy (CNN): 94.05749999999999
2023-05-09 16:07:07,712 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 16:07:07,712 [trainer.py] => ZS seen top1 curve: [96.88, 91.64, 88.63, 87.06]
2023-05-09 16:07:07,712 [trainer.py] => ZS unseen top1 curve: [65.12, 75.61, 77.88, 77.98]
2023-05-09 16:07:07,712 [trainer.py] => ZS harmonic top1 curve: [77.89, 82.86, 82.91, 82.27]
2023-05-09 16:07:07,712 [trainer.py] => ZS total top1 curve: [68.32, 78.81, 81.1, 81.64]
2023-05-09 16:07:07,712 [trainer.py] => Average Accuracy (ZS seen): 91.0525
2023-05-09 16:07:07,712 [trainer.py] => Average Accuracy (ZS unseen): 74.14750000000001
2023-05-09 16:07:07,712 [trainer.py] => Average Accuracy (ZS harmonic): 81.4825
2023-05-09 16:07:07,712 [trainer.py] => Average Accuracy (ZS total): 77.4675
2023-05-09 16:07:07,713 [trainer.py] => All params: 152778241
2023-05-09 16:07:07,714 [trainer.py] => Trainable params: 2364929
2023-05-09 16:07:07,724 [memo_transformer.py] => Learning on 40-50
2023-05-09 16:13:51,168 [memo_transformer.py] => Task 4, Epoch 4/5 => Loss 1.888, Train_acc 96.54, Test_acc 89.61
2023-05-09 16:13:51,181 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 16:13:51,187 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 16:13:51,386 [memo_transformer.py] => Task 4, Epoch 4/5 => Loss 2.108, Train_acc 94.18, Test_acc 90.02
2023-05-09 16:13:51,405 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 16:13:51,406 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 16:14:34,641 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 16:14:34,667 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 16:19:13,056 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 16:19:13,081 [trainer.py] => CNN: {'total': 89.61, '00-09': 89.21, '10-19': 90.84, '20-29': 87.27, '30-39': 88.06, '40-49': 92.75, 'old': 88.83, 'new': 92.75, 'harmonic': 90.75}
2023-05-09 16:19:13,081 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 16:19:13,081 [trainer.py] => CNN top1 curve: [97.87, 94.84, 92.75, 91.26, 89.61]
2023-05-09 16:19:13,081 [trainer.py] => CNN top5 curve: [99.9, 99.42, 99.27, 98.8, 98.47]
2023-05-09 16:19:13,081 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 16:19:13,081 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 16:19:13,081 [trainer.py] => Average Accuracy (CNN): 93.266
2023-05-09 16:19:13,081 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 16:19:13,081 [trainer.py] => ZS seen top1 curve: [97.97, 94.79, 91.86, 90.44, 89.01]
2023-05-09 16:19:13,081 [trainer.py] => ZS unseen top1 curve: [0.58, 4.15, 8.42, 12.87, 17.33]
2023-05-09 16:19:13,081 [trainer.py] => ZS harmonic top1 curve: [1.15, 7.95, 15.43, 22.53, 29.01]
2023-05-09 16:19:13,081 [trainer.py] => ZS total top1 curve: [10.41, 22.25, 33.43, 44.11, 53.31]
2023-05-09 16:19:13,082 [trainer.py] => Average Accuracy (ZS seen): 92.814
2023-05-09 16:19:13,082 [trainer.py] => Average Accuracy (ZS unseen): 8.669999999999998
2023-05-09 16:19:13,082 [trainer.py] => Average Accuracy (ZS harmonic): 15.214000000000002
2023-05-09 16:19:13,082 [trainer.py] => Average Accuracy (ZS total): 32.702
2023-05-09 16:19:13,083 [trainer.py] => All params: 153305089
2023-05-09 16:19:13,084 [trainer.py] => Trainable params: 2627585
2023-05-09 16:19:13,098 [memo_transformer.py] => Learning on 50-60
2023-05-09 16:19:13,130 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 16:19:13,133 [trainer.py] => CNN: {'total': 90.02, '00-09': 90.3, '10-19': 91.14, '20-29': 88.57, '30-39': 90.19, '40-49': 89.93, 'old': 90.05, 'new': 89.93, 'harmonic': 89.99}
2023-05-09 16:19:13,133 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 16:19:13,133 [trainer.py] => CNN top1 curve: [97.87, 94.39, 92.71, 91.26, 90.02]
2023-05-09 16:19:13,133 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27, 98.98, 98.69]
2023-05-09 16:19:13,134 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 16:19:13,134 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 16:19:13,134 [trainer.py] => Average Accuracy (CNN): 93.24999999999999
2023-05-09 16:19:13,134 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 16:19:13,134 [trainer.py] => ZS seen top1 curve: [96.88, 91.64, 88.63, 87.06, 86.58]
2023-05-09 16:19:13,134 [trainer.py] => ZS unseen top1 curve: [65.12, 75.61, 77.88, 77.98, 77.81]
2023-05-09 16:19:13,134 [trainer.py] => ZS harmonic top1 curve: [77.89, 82.86, 82.91, 82.27, 81.96]
2023-05-09 16:19:13,134 [trainer.py] => ZS total top1 curve: [68.32, 78.81, 81.1, 81.64, 82.21]
2023-05-09 16:19:13,134 [trainer.py] => Average Accuracy (ZS seen): 90.15799999999999
2023-05-09 16:19:13,134 [trainer.py] => Average Accuracy (ZS unseen): 74.88000000000001
2023-05-09 16:19:13,134 [trainer.py] => Average Accuracy (ZS harmonic): 81.578
2023-05-09 16:19:13,134 [trainer.py] => Average Accuracy (ZS total): 78.416
2023-05-09 16:19:13,135 [trainer.py] => All params: 153305089
2023-05-09 16:19:13,136 [trainer.py] => Trainable params: 2627585
2023-05-09 16:19:13,150 [memo_transformer.py] => Learning on 50-60
2023-05-09 16:26:39,721 [memo_transformer.py] => Task 5, Epoch 4/5 => Loss 1.960, Train_acc 96.30, Test_acc 88.31
2023-05-09 16:26:39,785 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 16:26:39,788 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 16:26:39,770 [memo_transformer.py] => Task 5, Epoch 4/5 => Loss 2.238, Train_acc 93.25, Test_acc 88.54
2023-05-09 16:26:39,771 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 16:26:39,771 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 16:27:27,330 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 16:27:27,304 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 16:32:01,218 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 16:32:01,281 [trainer.py] => CNN: {'total': 88.31, '00-09': 88.76, '10-19': 89.06, '20-29': 85.77, '30-39': 85.97, '40-49': 90.34, '50-59': 90.05, 'old': 87.96, 'new': 90.05, 'harmonic': 88.99}
2023-05-09 16:32:01,281 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 16:32:01,281 [trainer.py] => CNN top1 curve: [97.87, 94.84, 92.75, 91.26, 89.61, 88.31]
2023-05-09 16:32:01,281 [trainer.py] => CNN top5 curve: [99.9, 99.42, 99.27, 98.8, 98.47, 98.13]
2023-05-09 16:32:01,281 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-09 16:32:01,281 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-09 16:32:01,281 [trainer.py] => Average Accuracy (CNN): 92.44000000000001
2023-05-09 16:32:01,281 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-09 16:32:01,281 [trainer.py] => ZS seen top1 curve: [97.97, 94.79, 91.86, 90.44, 89.01, 87.74]
2023-05-09 16:32:01,281 [trainer.py] => ZS unseen top1 curve: [0.58, 4.15, 8.42, 12.87, 17.33, 20.89]
2023-05-09 16:32:01,281 [trainer.py] => ZS harmonic top1 curve: [1.15, 7.95, 15.43, 22.53, 29.01, 33.75]
2023-05-09 16:32:01,281 [trainer.py] => ZS total top1 curve: [10.41, 22.25, 33.43, 44.11, 53.31, 61.16]
2023-05-09 16:32:01,281 [trainer.py] => Average Accuracy (ZS seen): 91.96833333333332
2023-05-09 16:32:01,281 [trainer.py] => Average Accuracy (ZS unseen): 10.706666666666665
2023-05-09 16:32:01,281 [trainer.py] => Average Accuracy (ZS harmonic): 18.303333333333335
2023-05-09 16:32:01,281 [trainer.py] => Average Accuracy (ZS total): 37.445
2023-05-09 16:32:01,282 [trainer.py] => All params: 153831937
2023-05-09 16:32:01,283 [trainer.py] => Trainable params: 2890241
2023-05-09 16:32:01,297 [memo_transformer.py] => Learning on 60-70
2023-05-09 16:32:02,273 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 16:32:02,280 [trainer.py] => CNN: {'total': 88.54, '00-09': 89.41, '10-19': 90.38, '20-29': 87.32, '30-39': 88.69, '40-49': 90.44, '50-59': 85.02, 'old': 89.24, 'new': 85.02, 'harmonic': 87.08}
2023-05-09 16:32:02,280 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 16:32:02,280 [trainer.py] => CNN top1 curve: [97.87, 94.39, 92.71, 91.26, 90.02, 88.54]
2023-05-09 16:32:02,280 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27, 98.98, 98.69, 98.31]
2023-05-09 16:32:02,280 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-09 16:32:02,280 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-09 16:32:02,280 [trainer.py] => Average Accuracy (CNN): 92.46499999999999
2023-05-09 16:32:02,280 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-09 16:32:02,280 [trainer.py] => ZS seen top1 curve: [96.88, 91.64, 88.63, 87.06, 86.58, 85.86]
2023-05-09 16:32:02,281 [trainer.py] => ZS unseen top1 curve: [65.12, 75.61, 77.88, 77.98, 77.81, 77.47]
2023-05-09 16:32:02,281 [trainer.py] => ZS harmonic top1 curve: [77.89, 82.86, 82.91, 82.27, 81.96, 81.45]
2023-05-09 16:32:02,281 [trainer.py] => ZS total top1 curve: [68.32, 78.81, 81.1, 81.64, 82.21, 82.53]
2023-05-09 16:32:02,281 [trainer.py] => Average Accuracy (ZS seen): 89.44166666666666
2023-05-09 16:32:02,281 [trainer.py] => Average Accuracy (ZS unseen): 75.31166666666667
2023-05-09 16:32:02,281 [trainer.py] => Average Accuracy (ZS harmonic): 81.55666666666666
2023-05-09 16:32:02,281 [trainer.py] => Average Accuracy (ZS total): 79.10166666666667
2023-05-09 16:32:02,282 [trainer.py] => All params: 153831937
2023-05-09 16:32:02,283 [trainer.py] => Trainable params: 2890241
2023-05-09 16:32:02,297 [memo_transformer.py] => Learning on 60-70
2023-05-09 16:39:59,291 [memo_transformer.py] => Task 6, Epoch 4/5 => Loss 2.546, Train_acc 89.51, Test_acc 86.46
2023-05-09 16:39:59,309 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 16:39:59,313 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 16:39:59,926 [memo_transformer.py] => Task 6, Epoch 4/5 => Loss 2.205, Train_acc 93.18, Test_acc 85.80
2023-05-09 16:39:59,983 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 16:39:59,988 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 16:40:55,425 [base.py] => Constructing exemplars...(28 per classes)
2023-05-09 16:40:55,484 [base.py] => Constructing exemplars...(28 per classes)
2023-05-09 16:43:40,661 [trainer.py] => config: ././exp5_mlp//food101/food101_memo_transformer_clip_7_0.0009_64_0.0005.json
2023-05-09 16:43:40,662 [trainer.py] => prefix: reproduce
2023-05-09 16:43:40,662 [trainer.py] => dataset: food101
2023-05-09 16:43:40,662 [trainer.py] => memory_size: 2000
2023-05-09 16:43:40,662 [trainer.py] => memory_per_class: 20
2023-05-09 16:43:40,662 [trainer.py] => fixed_memory: False
2023-05-09 16:43:40,662 [trainer.py] => shuffle: True
2023-05-09 16:43:40,662 [trainer.py] => init_cls: 10
2023-05-09 16:43:40,662 [trainer.py] => increment: 10
2023-05-09 16:43:40,662 [trainer.py] => model_name: memo_transformer
2023-05-09 16:43:40,662 [trainer.py] => convnet_type: clip
2023-05-09 16:43:40,664 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 16:43:40,664 [trainer.py] => seed: 1993
2023-05-09 16:43:40,664 [trainer.py] => projection_type: mlp
2023-05-09 16:43:40,664 [trainer.py] => fusion_choice: transformer
2023-05-09 16:43:40,664 [trainer.py] => split_train: False
2023-05-09 16:43:40,664 [trainer.py] => tsne_option: False
2023-05-09 16:43:40,664 [trainer.py] => laion_check: False
2023-05-09 16:43:40,664 [trainer.py] => train_tasks: 999
2023-05-09 16:43:40,664 [trainer.py] => frozen_layers: visual
2023-05-09 16:43:40,664 [trainer.py] => tuned_epoch: 5
2023-05-09 16:43:40,664 [trainer.py] => first_epoch: 7
2023-05-09 16:43:40,664 [trainer.py] => init_lr: 0.0009
2023-05-09 16:43:40,664 [trainer.py] => batch_size: 64
2023-05-09 16:43:40,664 [trainer.py] => weight_decay: 0.0005
2023-05-09 16:43:40,664 [trainer.py] => min_lr: 0
2023-05-09 16:43:40,664 [trainer.py] => optimizer: sgd
2023-05-09 16:43:41,338 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 16:44:31,598 [instantiator.py] => Created a temporary directory at /tmp/tmpyhtgoe9s
2023-05-09 16:44:31,599 [instantiator.py] => Writing /tmp/tmpyhtgoe9s/_remote_module_non_sriptable.py
2023-05-09 16:44:33,792 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 16:44:37,463 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 16:44:37,801 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 16:44:40,335 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 16:44:40,709 [trainer.py] => All params: 150670849
2023-05-09 16:44:40,710 [trainer.py] => Trainable params: 150670849
2023-05-09 16:44:44,701 [memo_transformer.py] => Learning on 0-10
2023-05-09 16:45:34,942 [memo_transformer.py] => Exemplar size: 1960
2023-05-09 16:45:34,951 [trainer.py] => CNN: {'total': 85.8, '00-09': 86.53, '10-19': 89.01, '20-29': 83.92, '30-39': 87.52, '40-49': 87.57, '50-59': 82.44, '60-69': 83.59, 'old': 86.16, 'new': 83.59, 'harmonic': 84.86}
2023-05-09 16:45:34,952 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-09 16:45:34,952 [trainer.py] => CNN top1 curve: [97.87, 94.84, 92.75, 91.26, 89.61, 88.31, 85.8]
2023-05-09 16:45:34,952 [trainer.py] => CNN top5 curve: [99.9, 99.42, 99.27, 98.8, 98.47, 98.13, 97.68]
2023-05-09 16:45:34,952 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-09 16:45:34,952 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-09 16:45:34,952 [trainer.py] => Average Accuracy (CNN): 91.49142857142859
2023-05-09 16:45:34,952 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-09 16:45:34,952 [trainer.py] => ZS seen top1 curve: [97.97, 94.79, 91.86, 90.44, 89.01, 87.74, 85.17]
2023-05-09 16:45:34,952 [trainer.py] => ZS unseen top1 curve: [0.58, 4.15, 8.42, 12.87, 17.33, 20.89, 25.01]
2023-05-09 16:45:34,952 [trainer.py] => ZS harmonic top1 curve: [1.15, 7.95, 15.43, 22.53, 29.01, 33.75, 38.67]
2023-05-09 16:45:34,952 [trainer.py] => ZS total top1 curve: [10.41, 22.25, 33.43, 44.11, 53.31, 61.16, 67.2]
2023-05-09 16:45:34,952 [trainer.py] => Average Accuracy (ZS seen): 90.99714285714285
2023-05-09 16:45:34,952 [trainer.py] => Average Accuracy (ZS unseen): 12.75
2023-05-09 16:45:34,952 [trainer.py] => Average Accuracy (ZS harmonic): 21.212857142857143
2023-05-09 16:45:34,953 [trainer.py] => Average Accuracy (ZS total): 41.69571428571429
2023-05-09 16:45:34,954 [trainer.py] => All params: 154358785
2023-05-09 16:45:34,955 [trainer.py] => Trainable params: 3152897
2023-05-09 16:45:34,972 [memo_transformer.py] => Learning on 70-80
2023-05-09 16:45:35,210 [memo_transformer.py] => Exemplar size: 1960
2023-05-09 16:45:35,214 [trainer.py] => CNN: {'total': 86.46, '00-09': 87.57, '10-19': 89.87, '20-29': 85.37, '30-39': 88.79, '40-49': 89.48, '50-59': 85.22, '60-69': 78.79, 'old': 87.71, 'new': 78.79, 'harmonic': 83.01}
2023-05-09 16:45:35,214 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-09 16:45:35,214 [trainer.py] => CNN top1 curve: [97.87, 94.39, 92.71, 91.26, 90.02, 88.54, 86.46]
2023-05-09 16:45:35,214 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27, 98.98, 98.69, 98.31, 97.77]
2023-05-09 16:45:35,214 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-09 16:45:35,214 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-09 16:45:35,214 [trainer.py] => Average Accuracy (CNN): 91.60714285714286
2023-05-09 16:45:35,214 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-09 16:45:35,214 [trainer.py] => ZS seen top1 curve: [96.88, 91.64, 88.63, 87.06, 86.58, 85.86, 84.42]
2023-05-09 16:45:35,214 [trainer.py] => ZS unseen top1 curve: [65.12, 75.61, 77.88, 77.98, 77.81, 77.47, 80.73]
2023-05-09 16:45:35,214 [trainer.py] => ZS harmonic top1 curve: [77.89, 82.86, 82.91, 82.27, 81.96, 81.45, 82.53]
2023-05-09 16:45:35,214 [trainer.py] => ZS total top1 curve: [68.32, 78.81, 81.1, 81.64, 82.21, 82.53, 83.32]
2023-05-09 16:45:35,214 [trainer.py] => Average Accuracy (ZS seen): 88.7242857142857
2023-05-09 16:45:35,214 [trainer.py] => Average Accuracy (ZS unseen): 76.08571428571429
2023-05-09 16:45:35,214 [trainer.py] => Average Accuracy (ZS harmonic): 81.69571428571429
2023-05-09 16:45:35,214 [trainer.py] => Average Accuracy (ZS total): 79.70428571428572
2023-05-09 16:45:35,216 [trainer.py] => All params: 154358785
2023-05-09 16:45:35,217 [trainer.py] => Trainable params: 3152897
2023-05-09 16:45:35,231 [memo_transformer.py] => Learning on 70-80
2023-05-09 16:50:46,776 [memo_transformer.py] => Task 0, Epoch 7/5 => Loss 2.303, Train_acc 97.87, Test_acc 97.97
2023-05-09 16:50:46,792 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0] 
2023-05-09 16:50:46,793 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 16:50:46,793 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 16:53:57,018 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 16:53:57,047 [trainer.py] => CNN: {'total': 97.97, '00-09': 97.97, 'old': 0, 'new': 97.97, 'harmonic': 0.0}
2023-05-09 16:53:57,047 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 16:53:57,047 [trainer.py] => CNN top1 curve: [97.97]
2023-05-09 16:53:57,047 [trainer.py] => CNN top5 curve: [99.95]
2023-05-09 16:53:57,047 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 16:53:57,047 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 16:53:57,047 [trainer.py] => Average Accuracy (CNN): 97.97
2023-05-09 16:53:57,047 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 16:53:57,047 [trainer.py] => ZS seen top1 curve: [94.55]
2023-05-09 16:53:57,048 [trainer.py] => ZS unseen top1 curve: [69.14]
2023-05-09 16:53:57,048 [trainer.py] => ZS harmonic top1 curve: [79.87]
2023-05-09 16:53:57,048 [trainer.py] => ZS total top1 curve: [71.71]
2023-05-09 16:53:57,048 [trainer.py] => Average Accuracy (ZS seen): 94.55
2023-05-09 16:53:57,048 [trainer.py] => Average Accuracy (ZS unseen): 69.14
2023-05-09 16:53:57,048 [trainer.py] => Average Accuracy (ZS harmonic): 79.87
2023-05-09 16:53:57,048 [trainer.py] => Average Accuracy (ZS total): 71.71
2023-05-09 16:53:57,049 [trainer.py] => All params: 151197697
2023-05-09 16:53:57,049 [trainer.py] => Trainable params: 1576961
2023-05-09 16:53:57,063 [memo_transformer.py] => Learning on 10-20
2023-05-09 16:54:13,434 [memo_transformer.py] => Task 7, Epoch 4/5 => Loss 2.237, Train_acc 93.30, Test_acc 86.04
2023-05-09 16:54:13,443 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 16:54:13,443 [base.py] => Reducing exemplars...(25 per classes)
2023-05-09 16:54:14,585 [memo_transformer.py] => Task 7, Epoch 4/5 => Loss 1.922, Train_acc 96.82, Test_acc 85.50
2023-05-09 16:54:14,653 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 16:54:14,659 [base.py] => Reducing exemplars...(25 per classes)
2023-05-09 16:55:20,428 [base.py] => Constructing exemplars...(25 per classes)
2023-05-09 16:55:20,500 [base.py] => Constructing exemplars...(25 per classes)
2023-05-09 16:58:29,162 [trainer.py] => config: ././exp5_pure_mlp//food101/food101_memo_transformer_clip_7_0.0009_64_0.0005.json
2023-05-09 16:58:29,185 [trainer.py] => prefix: reproduce
2023-05-09 16:58:29,185 [trainer.py] => dataset: food101
2023-05-09 16:58:29,185 [trainer.py] => memory_size: 2000
2023-05-09 16:58:29,185 [trainer.py] => memory_per_class: 20
2023-05-09 16:58:29,185 [trainer.py] => fixed_memory: False
2023-05-09 16:58:29,185 [trainer.py] => shuffle: True
2023-05-09 16:58:29,185 [trainer.py] => init_cls: 10
2023-05-09 16:58:29,185 [trainer.py] => increment: 10
2023-05-09 16:58:29,185 [trainer.py] => model_name: memo_transformer
2023-05-09 16:58:29,185 [trainer.py] => convnet_type: clip
2023-05-09 16:58:29,185 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 16:58:29,185 [trainer.py] => seed: 1993
2023-05-09 16:58:29,185 [trainer.py] => projection_type: pure_mlp
2023-05-09 16:58:29,185 [trainer.py] => fusion_choice: transformer
2023-05-09 16:58:29,185 [trainer.py] => split_train: False
2023-05-09 16:58:29,185 [trainer.py] => tsne_option: False
2023-05-09 16:58:29,186 [trainer.py] => laion_check: False
2023-05-09 16:58:29,186 [trainer.py] => train_tasks: 999
2023-05-09 16:58:29,186 [trainer.py] => frozen_layers: visual
2023-05-09 16:58:29,186 [trainer.py] => tuned_epoch: 5
2023-05-09 16:58:29,186 [trainer.py] => first_epoch: 7
2023-05-09 16:58:29,186 [trainer.py] => init_lr: 0.0009
2023-05-09 16:58:29,186 [trainer.py] => batch_size: 64
2023-05-09 16:58:29,186 [trainer.py] => weight_decay: 0.0005
2023-05-09 16:58:29,186 [trainer.py] => min_lr: 0
2023-05-09 16:58:29,186 [trainer.py] => optimizer: sgd
2023-05-09 16:58:29,820 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 16:58:47,603 [trainer.py] => config: ././exp5_mlp//food101/food101_memo_transformer_clip_4_0.002_32_0.05.json
2023-05-09 16:58:47,604 [trainer.py] => prefix: reproduce
2023-05-09 16:58:47,604 [trainer.py] => dataset: food101
2023-05-09 16:58:47,604 [trainer.py] => memory_size: 2000
2023-05-09 16:58:47,604 [trainer.py] => memory_per_class: 20
2023-05-09 16:58:47,604 [trainer.py] => fixed_memory: False
2023-05-09 16:58:47,604 [trainer.py] => shuffle: True
2023-05-09 16:58:47,604 [trainer.py] => init_cls: 10
2023-05-09 16:58:47,604 [trainer.py] => increment: 10
2023-05-09 16:58:47,604 [trainer.py] => model_name: memo_transformer
2023-05-09 16:58:47,605 [trainer.py] => convnet_type: clip
2023-05-09 16:58:47,605 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 16:58:47,605 [trainer.py] => seed: 1993
2023-05-09 16:58:47,605 [trainer.py] => projection_type: mlp
2023-05-09 16:58:47,605 [trainer.py] => fusion_choice: transformer
2023-05-09 16:58:47,605 [trainer.py] => split_train: False
2023-05-09 16:58:47,605 [trainer.py] => tsne_option: False
2023-05-09 16:58:47,605 [trainer.py] => laion_check: False
2023-05-09 16:58:47,605 [trainer.py] => train_tasks: 999
2023-05-09 16:58:47,605 [trainer.py] => frozen_layers: visual
2023-05-09 16:58:47,605 [trainer.py] => tuned_epoch: 5
2023-05-09 16:58:47,605 [trainer.py] => first_epoch: 4
2023-05-09 16:58:47,605 [trainer.py] => init_lr: 0.002
2023-05-09 16:58:47,605 [trainer.py] => batch_size: 32
2023-05-09 16:58:47,605 [trainer.py] => weight_decay: 0.05
2023-05-09 16:58:47,605 [trainer.py] => min_lr: 0
2023-05-09 16:58:47,605 [trainer.py] => optimizer: sgd
2023-05-09 16:58:48,040 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 16:59:18,824 [instantiator.py] => Created a temporary directory at /tmp/tmpnzj7m7w2
2023-05-09 16:59:18,825 [instantiator.py] => Writing /tmp/tmpnzj7m7w2/_remote_module_non_sriptable.py
2023-05-09 16:59:18,889 [instantiator.py] => Created a temporary directory at /tmp/tmpghoud6mw
2023-05-09 16:59:18,896 [instantiator.py] => Writing /tmp/tmpghoud6mw/_remote_module_non_sriptable.py
2023-05-09 16:59:20,402 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 16:59:20,337 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 16:59:24,189 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 16:59:24,334 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 16:59:24,835 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 16:59:25,857 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 16:59:27,921 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 16:59:28,460 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 16:59:28,450 [trainer.py] => All params: 150670849
2023-05-09 16:59:28,456 [trainer.py] => Trainable params: 150670849
2023-05-09 16:59:30,642 [trainer.py] => All params: 150670849
2023-05-09 16:59:30,650 [trainer.py] => Trainable params: 150670849
2023-05-09 16:59:32,873 [memo_transformer.py] => Learning on 0-10
2023-05-09 16:59:33,651 [memo_transformer.py] => Learning on 0-10
2023-05-09 17:00:08,934 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:00:08,941 [trainer.py] => CNN: {'total': 85.5, '00-09': 88.02, '10-19': 87.24, '20-29': 82.78, '30-39': 83.79, '40-49': 88.88, '50-59': 84.23, '60-69': 77.58, '70-79': 91.45, 'old': 84.65, 'new': 91.45, 'harmonic': 87.92}
2023-05-09 17:00:08,941 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-09 17:00:08,941 [trainer.py] => CNN top1 curve: [97.87, 94.84, 92.75, 91.26, 89.61, 88.31, 85.8, 85.5]
2023-05-09 17:00:08,941 [trainer.py] => CNN top5 curve: [99.9, 99.42, 99.27, 98.8, 98.47, 98.13, 97.68, 97.24]
2023-05-09 17:00:08,941 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-09 17:00:08,941 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-09 17:00:08,941 [trainer.py] => Average Accuracy (CNN): 90.7425
2023-05-09 17:00:08,941 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-09 17:00:08,941 [trainer.py] => ZS seen top1 curve: [97.97, 94.79, 91.86, 90.44, 89.01, 87.74, 85.17, 84.63]
2023-05-09 17:00:08,941 [trainer.py] => ZS unseen top1 curve: [0.58, 4.15, 8.42, 12.87, 17.33, 20.89, 25.01, 29.0]
2023-05-09 17:00:08,941 [trainer.py] => ZS harmonic top1 curve: [1.15, 7.95, 15.43, 22.53, 29.01, 33.75, 38.67, 43.2]
2023-05-09 17:00:08,941 [trainer.py] => ZS total top1 curve: [10.41, 22.25, 33.43, 44.11, 53.31, 61.16, 67.2, 73.58]
2023-05-09 17:00:08,941 [trainer.py] => Average Accuracy (ZS seen): 90.20124999999999
2023-05-09 17:00:08,941 [trainer.py] => Average Accuracy (ZS unseen): 14.78125
2023-05-09 17:00:08,941 [trainer.py] => Average Accuracy (ZS harmonic): 23.96125
2023-05-09 17:00:08,941 [trainer.py] => Average Accuracy (ZS total): 45.68125
2023-05-09 17:00:08,942 [trainer.py] => All params: 154885633
2023-05-09 17:00:08,943 [trainer.py] => Trainable params: 3415553
2023-05-09 17:00:08,954 [memo_transformer.py] => Learning on 80-90
2023-05-09 17:00:10,765 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:00:10,784 [trainer.py] => CNN: {'total': 86.04, '00-09': 87.87, '10-19': 88.41, '20-29': 83.77, '30-39': 86.84, '40-49': 88.58, '50-59': 84.38, '60-69': 80.4, '70-79': 88.01, 'old': 85.76, 'new': 88.01, 'harmonic': 86.87}
2023-05-09 17:00:10,784 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-09 17:00:10,784 [trainer.py] => CNN top1 curve: [97.87, 94.39, 92.71, 91.26, 90.02, 88.54, 86.46, 86.04]
2023-05-09 17:00:10,784 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27, 98.98, 98.69, 98.31, 97.77, 97.48]
2023-05-09 17:00:10,784 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-09 17:00:10,784 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-09 17:00:10,784 [trainer.py] => Average Accuracy (CNN): 90.91125
2023-05-09 17:00:10,784 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-09 17:00:10,784 [trainer.py] => ZS seen top1 curve: [96.88, 91.64, 88.63, 87.06, 86.58, 85.86, 84.42, 84.56]
2023-05-09 17:00:10,784 [trainer.py] => ZS unseen top1 curve: [65.12, 75.61, 77.88, 77.98, 77.81, 77.47, 80.73, 78.82]
2023-05-09 17:00:10,785 [trainer.py] => ZS harmonic top1 curve: [77.89, 82.86, 82.91, 82.27, 81.96, 81.45, 82.53, 81.59]
2023-05-09 17:00:10,785 [trainer.py] => ZS total top1 curve: [68.32, 78.81, 81.1, 81.64, 82.21, 82.53, 83.32, 83.42]
2023-05-09 17:00:10,785 [trainer.py] => Average Accuracy (ZS seen): 88.20374999999999
2023-05-09 17:00:10,785 [trainer.py] => Average Accuracy (ZS unseen): 76.42750000000001
2023-05-09 17:00:10,785 [trainer.py] => Average Accuracy (ZS harmonic): 81.6825
2023-05-09 17:00:10,785 [trainer.py] => Average Accuracy (ZS total): 80.16875
2023-05-09 17:00:10,786 [trainer.py] => All params: 154885633
2023-05-09 17:00:10,787 [trainer.py] => Trainable params: 3415553
2023-05-09 17:00:10,802 [memo_transformer.py] => Learning on 80-90
2023-05-09 17:02:11,091 [memo_transformer.py] => Task 1, Epoch 7/5 => Loss 2.299, Train_acc 93.30, Test_acc 94.22
2023-05-09 17:02:11,173 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:02:11,173 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 17:02:29,192 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 17:03:14,513 [memo_transformer.py] => Task 0, Epoch 4/5 => Loss 1.595, Train_acc 98.58, Test_acc 97.97
2023-05-09 17:03:14,514 [memo_transformer.py] => Laion scores: [0, 0, 0, 0] 
2023-05-09 17:03:14,514 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 17:03:14,515 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 17:05:19,760 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:05:19,762 [trainer.py] => CNN: {'total': 94.22, '00-09': 95.74, '10-19': 92.66, 'old': 95.74, 'new': 92.66, 'harmonic': 94.17}
2023-05-09 17:05:19,762 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 17:05:19,762 [trainer.py] => CNN top1 curve: [97.97, 94.22]
2023-05-09 17:05:19,762 [trainer.py] => CNN top5 curve: [99.95, 99.47]
2023-05-09 17:05:19,762 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 17:05:19,762 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 17:05:19,763 [trainer.py] => Average Accuracy (CNN): 96.095
2023-05-09 17:05:19,763 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 17:05:19,763 [trainer.py] => ZS seen top1 curve: [94.55, 91.04]
2023-05-09 17:05:19,763 [trainer.py] => ZS unseen top1 curve: [69.14, 74.9]
2023-05-09 17:05:19,763 [trainer.py] => ZS harmonic top1 curve: [79.87, 82.19]
2023-05-09 17:05:19,763 [trainer.py] => ZS total top1 curve: [71.71, 78.12]
2023-05-09 17:05:19,763 [trainer.py] => Average Accuracy (ZS seen): 92.795
2023-05-09 17:05:19,763 [trainer.py] => Average Accuracy (ZS unseen): 72.02000000000001
2023-05-09 17:05:19,763 [trainer.py] => Average Accuracy (ZS harmonic): 81.03
2023-05-09 17:05:19,763 [trainer.py] => Average Accuracy (ZS total): 74.91499999999999
2023-05-09 17:05:19,764 [trainer.py] => All params: 151724545
2023-05-09 17:05:19,765 [trainer.py] => Trainable params: 1839617
2023-05-09 17:05:19,778 [memo_transformer.py] => Learning on 20-30
2023-05-09 17:05:53,499 [memo_transformer.py] => Task 0, Epoch 7/5 => Loss 2.234, Train_acc 97.96, Test_acc 97.87
2023-05-09 17:05:53,500 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:05:53,505 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 17:05:53,505 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 17:05:55,708 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:05:55,833 [trainer.py] => CNN: {'total': 97.97, '00-09': 97.97, 'old': 0, 'new': 97.97, 'harmonic': 0.0}
2023-05-09 17:05:55,833 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 17:05:55,833 [trainer.py] => CNN top1 curve: [97.97]
2023-05-09 17:05:55,833 [trainer.py] => CNN top5 curve: [99.95]
2023-05-09 17:05:55,833 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 17:05:55,833 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 17:05:55,833 [trainer.py] => Average Accuracy (CNN): 97.97
2023-05-09 17:05:55,833 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 17:05:55,833 [trainer.py] => ZS seen top1 curve: [96.49]
2023-05-09 17:05:55,833 [trainer.py] => ZS unseen top1 curve: [72.24]
2023-05-09 17:05:55,833 [trainer.py] => ZS harmonic top1 curve: [82.62]
2023-05-09 17:05:55,833 [trainer.py] => ZS total top1 curve: [74.69]
2023-05-09 17:05:55,833 [trainer.py] => Average Accuracy (ZS seen): 96.49
2023-05-09 17:05:55,833 [trainer.py] => Average Accuracy (ZS unseen): 72.24
2023-05-09 17:05:55,833 [trainer.py] => Average Accuracy (ZS harmonic): 82.62
2023-05-09 17:05:55,833 [trainer.py] => Average Accuracy (ZS total): 74.69
2023-05-09 17:05:55,834 [trainer.py] => All params: 151197697
2023-05-09 17:05:55,835 [trainer.py] => Trainable params: 1576961
2023-05-09 17:05:55,855 [memo_transformer.py] => Learning on 10-20
2023-05-09 17:08:48,568 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:08:48,580 [trainer.py] => CNN: {'total': 97.87, '00-09': 97.87, 'old': 0, 'new': 97.87, 'harmonic': 0.0}
2023-05-09 17:08:48,580 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 17:08:48,580 [trainer.py] => CNN top1 curve: [97.87]
2023-05-09 17:08:48,580 [trainer.py] => CNN top5 curve: [99.85]
2023-05-09 17:08:48,580 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 17:08:48,580 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 17:08:48,581 [trainer.py] => Average Accuracy (CNN): 97.87
2023-05-09 17:08:48,581 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 17:08:48,581 [trainer.py] => ZS seen top1 curve: [97.77]
2023-05-09 17:08:48,581 [trainer.py] => ZS unseen top1 curve: [0.58]
2023-05-09 17:08:48,581 [trainer.py] => ZS harmonic top1 curve: [1.15]
2023-05-09 17:08:48,581 [trainer.py] => ZS total top1 curve: [10.39]
2023-05-09 17:08:48,581 [trainer.py] => Average Accuracy (ZS seen): 97.77
2023-05-09 17:08:48,581 [trainer.py] => Average Accuracy (ZS unseen): 0.58
2023-05-09 17:08:48,581 [trainer.py] => Average Accuracy (ZS harmonic): 1.15
2023-05-09 17:08:48,581 [trainer.py] => Average Accuracy (ZS total): 10.39
2023-05-09 17:08:48,582 [trainer.py] => All params: 151197697
2023-05-09 17:08:48,583 [trainer.py] => Trainable params: 1576961
2023-05-09 17:08:48,602 [memo_transformer.py] => Learning on 10-20
2023-05-09 17:09:15,217 [memo_transformer.py] => Task 8, Epoch 4/5 => Loss 1.929, Train_acc 96.69, Test_acc 84.88
2023-05-09 17:09:15,217 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:09:15,218 [base.py] => Reducing exemplars...(22 per classes)
2023-05-09 17:09:19,272 [memo_transformer.py] => Task 8, Epoch 4/5 => Loss 2.252, Train_acc 93.05, Test_acc 85.64
2023-05-09 17:09:19,300 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:09:19,304 [base.py] => Reducing exemplars...(22 per classes)
2023-05-09 17:10:07,002 [base.py] => Constructing exemplars...(22 per classes)
2023-05-09 17:10:07,976 [base.py] => Constructing exemplars...(22 per classes)
2023-05-09 17:11:02,251 [memo_transformer.py] => Task 1, Epoch 4/5 => Loss 1.584, Train_acc 95.82, Test_acc 94.64
2023-05-09 17:11:02,257 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:11:02,258 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 17:11:20,596 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 17:14:08,287 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:14:08,303 [trainer.py] => CNN: {'total': 94.64, '00-09': 94.75, '10-19': 94.53, 'old': 94.75, 'new': 94.53, 'harmonic': 94.64}
2023-05-09 17:14:08,303 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 17:14:08,303 [trainer.py] => CNN top1 curve: [97.97, 94.64]
2023-05-09 17:14:08,303 [trainer.py] => CNN top5 curve: [99.95, 99.5]
2023-05-09 17:14:08,303 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 17:14:08,303 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 17:14:08,303 [trainer.py] => Average Accuracy (CNN): 96.305
2023-05-09 17:14:08,303 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 17:14:08,303 [trainer.py] => ZS seen top1 curve: [96.49, 91.56]
2023-05-09 17:14:08,303 [trainer.py] => ZS unseen top1 curve: [72.24, 78.05]
2023-05-09 17:14:08,303 [trainer.py] => ZS harmonic top1 curve: [82.62, 84.27]
2023-05-09 17:14:08,303 [trainer.py] => ZS total top1 curve: [74.69, 80.75]
2023-05-09 17:14:08,303 [trainer.py] => Average Accuracy (ZS seen): 94.025
2023-05-09 17:14:08,303 [trainer.py] => Average Accuracy (ZS unseen): 75.145
2023-05-09 17:14:08,303 [trainer.py] => Average Accuracy (ZS harmonic): 83.445
2023-05-09 17:14:08,304 [trainer.py] => Average Accuracy (ZS total): 77.72
2023-05-09 17:14:08,305 [trainer.py] => All params: 151724545
2023-05-09 17:14:08,305 [trainer.py] => Trainable params: 1839617
2023-05-09 17:14:08,319 [memo_transformer.py] => Learning on 20-30
2023-05-09 17:14:35,864 [memo_transformer.py] => Task 2, Epoch 7/5 => Loss 2.287, Train_acc 92.05, Test_acc 92.28
2023-05-09 17:14:35,948 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:14:35,949 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 17:15:00,565 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 17:15:05,613 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 17:15:05,623 [trainer.py] => CNN: {'total': 84.88, '00-09': 87.67, '10-19': 84.96, '20-29': 84.82, '30-39': 83.59, '40-49': 85.76, '50-59': 83.03, '60-69': 75.15, '70-79': 86.71, '80-89': 92.22, 'old': 83.97, 'new': 92.22, 'harmonic': 87.9}
2023-05-09 17:15:05,623 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-09 17:15:05,623 [trainer.py] => CNN top1 curve: [97.87, 94.84, 92.75, 91.26, 89.61, 88.31, 85.8, 85.5, 84.88]
2023-05-09 17:15:05,623 [trainer.py] => CNN top5 curve: [99.9, 99.42, 99.27, 98.8, 98.47, 98.13, 97.68, 97.24, 97.02]
2023-05-09 17:15:05,624 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-09 17:15:05,624 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-09 17:15:05,624 [trainer.py] => Average Accuracy (CNN): 90.09111111111112
2023-05-09 17:15:05,624 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-09 17:15:05,624 [trainer.py] => ZS seen top1 curve: [97.97, 94.79, 91.86, 90.44, 89.01, 87.74, 85.17, 84.63, 84.05]
2023-05-09 17:15:05,624 [trainer.py] => ZS unseen top1 curve: [0.58, 4.15, 8.42, 12.87, 17.33, 20.89, 25.01, 29.0, 33.22]
2023-05-09 17:15:05,624 [trainer.py] => ZS harmonic top1 curve: [1.15, 7.95, 15.43, 22.53, 29.01, 33.75, 38.67, 43.2, 47.62]
2023-05-09 17:15:05,624 [trainer.py] => ZS total top1 curve: [10.41, 22.25, 33.43, 44.11, 53.31, 61.16, 67.2, 73.58, 79.01]
2023-05-09 17:15:05,624 [trainer.py] => Average Accuracy (ZS seen): 89.51777777777777
2023-05-09 17:15:05,624 [trainer.py] => Average Accuracy (ZS unseen): 16.83
2023-05-09 17:15:05,624 [trainer.py] => Average Accuracy (ZS harmonic): 26.59
2023-05-09 17:15:05,624 [trainer.py] => Average Accuracy (ZS total): 49.38444444444444
2023-05-09 17:15:05,625 [trainer.py] => All params: 155412481
2023-05-09 17:15:05,626 [trainer.py] => Trainable params: 3678209
2023-05-09 17:15:05,637 [memo_transformer.py] => Learning on 90-100
2023-05-09 17:15:08,499 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 17:15:08,503 [trainer.py] => CNN: {'total': 85.64, '00-09': 87.72, '10-19': 88.3, '20-29': 84.42, '30-39': 85.05, '40-49': 86.97, '50-59': 84.18, '60-69': 77.58, '70-79': 88.86, '80-89': 87.65, 'old': 85.39, 'new': 87.65, 'harmonic': 86.51}
2023-05-09 17:15:08,503 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-09 17:15:08,503 [trainer.py] => CNN top1 curve: [97.87, 94.39, 92.71, 91.26, 90.02, 88.54, 86.46, 86.04, 85.64]
2023-05-09 17:15:08,503 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27, 98.98, 98.69, 98.31, 97.77, 97.48, 97.24]
2023-05-09 17:15:08,504 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-09 17:15:08,504 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-09 17:15:08,504 [trainer.py] => Average Accuracy (CNN): 90.32555555555555
2023-05-09 17:15:08,504 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-09 17:15:08,504 [trainer.py] => ZS seen top1 curve: [96.88, 91.64, 88.63, 87.06, 86.58, 85.86, 84.42, 84.56, 84.44]
2023-05-09 17:15:08,504 [trainer.py] => ZS unseen top1 curve: [65.12, 75.61, 77.88, 77.98, 77.81, 77.47, 80.73, 78.82, 75.0]
2023-05-09 17:15:08,504 [trainer.py] => ZS harmonic top1 curve: [77.89, 82.86, 82.91, 82.27, 81.96, 81.45, 82.53, 81.59, 79.44]
2023-05-09 17:15:08,504 [trainer.py] => ZS total top1 curve: [68.32, 78.81, 81.1, 81.64, 82.21, 82.53, 83.32, 83.42, 83.5]
2023-05-09 17:15:08,504 [trainer.py] => Average Accuracy (ZS seen): 87.78555555555555
2023-05-09 17:15:08,504 [trainer.py] => Average Accuracy (ZS unseen): 76.2688888888889
2023-05-09 17:15:08,504 [trainer.py] => Average Accuracy (ZS harmonic): 81.43333333333334
2023-05-09 17:15:08,504 [trainer.py] => Average Accuracy (ZS total): 80.53888888888889
2023-05-09 17:15:08,505 [trainer.py] => All params: 155412481
2023-05-09 17:15:08,506 [trainer.py] => Trainable params: 3678209
2023-05-09 17:15:08,520 [memo_transformer.py] => Learning on 90-100
2023-05-09 17:17:23,721 [memo_transformer.py] => Task 1, Epoch 7/5 => Loss 2.120, Train_acc 95.72, Test_acc 94.52
2023-05-09 17:17:23,724 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:17:23,728 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 17:17:43,602 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 17:18:01,522 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 17:18:01,592 [trainer.py] => CNN: {'total': 92.28, '00-09': 94.31, '10-19': 91.75, '20-29': 90.76, 'old': 93.04, 'new': 90.76, 'harmonic': 91.89}
2023-05-09 17:18:01,592 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 17:18:01,592 [trainer.py] => CNN top1 curve: [97.97, 94.22, 92.28]
2023-05-09 17:18:01,592 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.18]
2023-05-09 17:18:01,592 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 17:18:01,592 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 17:18:01,592 [trainer.py] => Average Accuracy (CNN): 94.82333333333334
2023-05-09 17:18:01,592 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 17:18:01,592 [trainer.py] => ZS seen top1 curve: [94.55, 91.04, 87.35]
2023-05-09 17:18:01,592 [trainer.py] => ZS unseen top1 curve: [69.14, 74.9, 77.52]
2023-05-09 17:18:01,593 [trainer.py] => ZS harmonic top1 curve: [79.87, 82.19, 82.14]
2023-05-09 17:18:01,593 [trainer.py] => ZS total top1 curve: [71.71, 78.12, 80.47]
2023-05-09 17:18:01,593 [trainer.py] => Average Accuracy (ZS seen): 90.98
2023-05-09 17:18:01,593 [trainer.py] => Average Accuracy (ZS unseen): 73.85333333333334
2023-05-09 17:18:01,593 [trainer.py] => Average Accuracy (ZS harmonic): 81.39999999999999
2023-05-09 17:18:01,593 [trainer.py] => Average Accuracy (ZS total): 76.76666666666667
2023-05-09 17:18:01,594 [trainer.py] => All params: 152251393
2023-05-09 17:18:01,594 [trainer.py] => Trainable params: 2102273
2023-05-09 17:18:01,609 [memo_transformer.py] => Learning on 30-40
2023-05-09 17:19:48,327 [memo_transformer.py] => Task 2, Epoch 4/5 => Loss 1.686, Train_acc 94.21, Test_acc 92.21
2023-05-09 17:19:48,331 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:19:48,332 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 17:20:14,490 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 17:20:48,691 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:20:48,699 [trainer.py] => CNN: {'total': 94.52, '00-09': 95.3, '10-19': 93.72, 'old': 95.3, 'new': 93.72, 'harmonic': 94.5}
2023-05-09 17:20:48,700 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 17:20:48,700 [trainer.py] => CNN top1 curve: [97.87, 94.52]
2023-05-09 17:20:48,700 [trainer.py] => CNN top5 curve: [99.85, 99.42]
2023-05-09 17:20:48,700 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 17:20:48,700 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 17:20:48,700 [trainer.py] => Average Accuracy (CNN): 96.195
2023-05-09 17:20:48,700 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 17:20:48,700 [trainer.py] => ZS seen top1 curve: [97.77, 94.44]
2023-05-09 17:20:48,700 [trainer.py] => ZS unseen top1 curve: [0.58, 1.87]
2023-05-09 17:20:48,700 [trainer.py] => ZS harmonic top1 curve: [1.15, 3.67]
2023-05-09 17:20:48,701 [trainer.py] => ZS total top1 curve: [10.39, 20.35]
2023-05-09 17:20:48,701 [trainer.py] => Average Accuracy (ZS seen): 96.10499999999999
2023-05-09 17:20:48,701 [trainer.py] => Average Accuracy (ZS unseen): 1.225
2023-05-09 17:20:48,701 [trainer.py] => Average Accuracy (ZS harmonic): 2.41
2023-05-09 17:20:48,701 [trainer.py] => Average Accuracy (ZS total): 15.370000000000001
2023-05-09 17:20:48,702 [trainer.py] => All params: 151724545
2023-05-09 17:20:48,702 [trainer.py] => Trainable params: 1839617
2023-05-09 17:20:48,717 [memo_transformer.py] => Learning on 20-30
2023-05-09 17:23:15,922 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 17:23:15,923 [trainer.py] => CNN: {'total': 92.21, '00-09': 91.93, '10-19': 90.18, '20-29': 94.51, 'old': 91.06, 'new': 94.51, 'harmonic': 92.75}
2023-05-09 17:23:15,923 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 17:23:15,923 [trainer.py] => CNN top1 curve: [97.97, 94.64, 92.21]
2023-05-09 17:23:15,923 [trainer.py] => CNN top5 curve: [99.95, 99.5, 99.23]
2023-05-09 17:23:15,923 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 17:23:15,923 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 17:23:15,923 [trainer.py] => Average Accuracy (CNN): 94.94
2023-05-09 17:23:15,923 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 17:23:15,924 [trainer.py] => ZS seen top1 curve: [96.49, 91.56, 89.38]
2023-05-09 17:23:15,924 [trainer.py] => ZS unseen top1 curve: [72.24, 78.05, 77.23]
2023-05-09 17:23:15,924 [trainer.py] => ZS harmonic top1 curve: [82.62, 84.27, 82.86]
2023-05-09 17:23:15,924 [trainer.py] => ZS total top1 curve: [74.69, 80.75, 80.87]
2023-05-09 17:23:15,924 [trainer.py] => Average Accuracy (ZS seen): 92.47666666666667
2023-05-09 17:23:15,924 [trainer.py] => Average Accuracy (ZS unseen): 75.83999999999999
2023-05-09 17:23:15,924 [trainer.py] => Average Accuracy (ZS harmonic): 83.25
2023-05-09 17:23:15,924 [trainer.py] => Average Accuracy (ZS total): 78.77
2023-05-09 17:23:15,925 [trainer.py] => All params: 152251393
2023-05-09 17:23:15,925 [trainer.py] => Trainable params: 2102273
2023-05-09 17:23:15,937 [memo_transformer.py] => Learning on 30-40
2023-05-09 17:24:47,859 [memo_transformer.py] => Task 9, Epoch 4/5 => Loss 2.034, Train_acc 95.79, Test_acc 83.24
2023-05-09 17:24:47,861 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:24:47,862 [base.py] => Reducing exemplars...(20 per classes)
2023-05-09 17:24:54,560 [memo_transformer.py] => Task 9, Epoch 4/5 => Loss 2.413, Train_acc 91.09, Test_acc 84.27
2023-05-09 17:24:54,563 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:24:54,567 [base.py] => Reducing exemplars...(20 per classes)
2023-05-09 17:25:45,494 [base.py] => Constructing exemplars...(20 per classes)
2023-05-09 17:25:45,546 [base.py] => Constructing exemplars...(20 per classes)
2023-05-09 17:28:20,293 [memo_transformer.py] => Task 3, Epoch 7/5 => Loss 2.334, Train_acc 91.81, Test_acc 90.57
2023-05-09 17:28:20,362 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:28:20,363 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 17:28:49,720 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 17:29:36,815 [memo_transformer.py] => Task 3, Epoch 4/5 => Loss 1.728, Train_acc 93.53, Test_acc 90.46
2023-05-09 17:29:36,874 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:29:36,883 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 17:30:08,862 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 17:30:30,660 [memo_transformer.py] => Task 2, Epoch 7/5 => Loss 2.085, Train_acc 94.48, Test_acc 92.25
2023-05-09 17:30:30,662 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:30:30,666 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 17:30:57,669 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:30:57,670 [trainer.py] => CNN: {'total': 83.24, '00-09': 86.44, '10-19': 84.96, '20-29': 79.98, '30-39': 81.89, '40-49': 85.46, '50-59': 80.15, '60-69': 74.65, '70-79': 86.56, '80-89': 85.89, '90-99': 86.39, 'old': 82.89, 'new': 86.39, 'harmonic': 84.6}
2023-05-09 17:30:57,670 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-09 17:30:57,670 [trainer.py] => CNN top1 curve: [97.87, 94.84, 92.75, 91.26, 89.61, 88.31, 85.8, 85.5, 84.88, 83.24]
2023-05-09 17:30:57,670 [trainer.py] => CNN top5 curve: [99.9, 99.42, 99.27, 98.8, 98.47, 98.13, 97.68, 97.24, 97.02, 96.48]
2023-05-09 17:30:57,670 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-09 17:30:57,670 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-09 17:30:57,670 [trainer.py] => Average Accuracy (CNN): 89.406
2023-05-09 17:30:57,671 [trainer.py] => Average Accuracy (NME): 87.828
2023-05-09 17:30:57,671 [trainer.py] => ZS seen top1 curve: [97.97, 94.79, 91.86, 90.44, 89.01, 87.74, 85.17, 84.63, 84.05, 82.52]
2023-05-09 17:30:57,671 [trainer.py] => ZS unseen top1 curve: [0.58, 4.15, 8.42, 12.87, 17.33, 20.89, 25.01, 29.0, 33.22, 0]
2023-05-09 17:30:57,671 [trainer.py] => ZS harmonic top1 curve: [1.15, 7.95, 15.43, 22.53, 29.01, 33.75, 38.67, 43.2, 47.62, 0.0]
2023-05-09 17:30:57,671 [trainer.py] => ZS total top1 curve: [10.41, 22.25, 33.43, 44.11, 53.31, 61.16, 67.2, 73.58, 79.01, 82.52]
2023-05-09 17:30:57,671 [trainer.py] => Average Accuracy (ZS seen): 88.81799999999998
2023-05-09 17:30:57,671 [trainer.py] => Average Accuracy (ZS unseen): 15.147
2023-05-09 17:30:57,671 [trainer.py] => Average Accuracy (ZS harmonic): 23.931
2023-05-09 17:30:57,671 [trainer.py] => Average Accuracy (ZS total): 52.698
2023-05-09 17:30:58,657 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:30:58,670 [trainer.py] => CNN: {'total': 84.27, '00-09': 87.43, '10-19': 87.85, '20-29': 81.73, '30-39': 84.81, '40-49': 86.21, '50-59': 83.28, '60-69': 75.86, '70-79': 87.86, '80-89': 87.75, '90-99': 79.89, 'old': 84.76, 'new': 79.89, 'harmonic': 82.25}
2023-05-09 17:30:58,671 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-09 17:30:58,671 [trainer.py] => CNN top1 curve: [97.87, 94.39, 92.71, 91.26, 90.02, 88.54, 86.46, 86.04, 85.64, 84.27]
2023-05-09 17:30:58,671 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27, 98.98, 98.69, 98.31, 97.77, 97.48, 97.24, 96.92]
2023-05-09 17:30:58,671 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-09 17:30:58,671 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-09 17:30:58,671 [trainer.py] => Average Accuracy (CNN): 89.72
2023-05-09 17:30:58,671 [trainer.py] => Average Accuracy (NME): 87.828
2023-05-09 17:30:58,671 [trainer.py] => ZS seen top1 curve: [96.88, 91.64, 88.63, 87.06, 86.58, 85.86, 84.42, 84.56, 84.44, 83.67]
2023-05-09 17:30:58,671 [trainer.py] => ZS unseen top1 curve: [65.12, 75.61, 77.88, 77.98, 77.81, 77.47, 80.73, 78.82, 75.0, 0]
2023-05-09 17:30:58,671 [trainer.py] => ZS harmonic top1 curve: [77.89, 82.86, 82.91, 82.27, 81.96, 81.45, 82.53, 81.59, 79.44, 0.0]
2023-05-09 17:30:58,671 [trainer.py] => ZS total top1 curve: [68.32, 78.81, 81.1, 81.64, 82.21, 82.53, 83.32, 83.42, 83.5, 83.67]
2023-05-09 17:30:58,671 [trainer.py] => Average Accuracy (ZS seen): 87.374
2023-05-09 17:30:58,671 [trainer.py] => Average Accuracy (ZS unseen): 68.64200000000001
2023-05-09 17:30:58,671 [trainer.py] => Average Accuracy (ZS harmonic): 73.29
2023-05-09 17:30:58,671 [trainer.py] => Average Accuracy (ZS total): 80.852
2023-05-09 17:31:00,280 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 17:32:04,397 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:32:04,480 [trainer.py] => CNN: {'total': 90.57, '00-09': 91.78, '10-19': 91.09, '20-29': 90.06, '30-39': 89.37, 'old': 90.98, 'new': 89.37, 'harmonic': 90.17}
2023-05-09 17:32:04,480 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 17:32:04,480 [trainer.py] => CNN top1 curve: [97.97, 94.22, 92.28, 90.57]
2023-05-09 17:32:04,480 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.18, 99.02]
2023-05-09 17:32:04,480 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 17:32:04,480 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 17:32:04,481 [trainer.py] => Average Accuracy (CNN): 93.76
2023-05-09 17:32:04,481 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 17:32:04,481 [trainer.py] => ZS seen top1 curve: [94.55, 91.04, 87.35, 86.15]
2023-05-09 17:32:04,481 [trainer.py] => ZS unseen top1 curve: [69.14, 74.9, 77.52, 77.75]
2023-05-09 17:32:04,481 [trainer.py] => ZS harmonic top1 curve: [79.87, 82.19, 82.14, 81.73]
2023-05-09 17:32:04,481 [trainer.py] => ZS total top1 curve: [71.71, 78.12, 80.47, 81.13]
2023-05-09 17:32:04,481 [trainer.py] => Average Accuracy (ZS seen): 89.77250000000001
2023-05-09 17:32:04,481 [trainer.py] => Average Accuracy (ZS unseen): 74.8275
2023-05-09 17:32:04,481 [trainer.py] => Average Accuracy (ZS harmonic): 81.4825
2023-05-09 17:32:04,481 [trainer.py] => Average Accuracy (ZS total): 77.85749999999999
2023-05-09 17:32:04,482 [trainer.py] => All params: 152778241
2023-05-09 17:32:04,483 [trainer.py] => Trainable params: 2364929
2023-05-09 17:32:04,499 [memo_transformer.py] => Learning on 40-50
2023-05-09 17:32:07,342 [trainer.py] => config: ././exp5_pure_mlp//food101/food101_memo_transformer_clip_7_0.002_32_0.0005.json
2023-05-09 17:32:07,343 [trainer.py] => prefix: reproduce
2023-05-09 17:32:07,343 [trainer.py] => dataset: food101
2023-05-09 17:32:07,343 [trainer.py] => memory_size: 2000
2023-05-09 17:32:07,343 [trainer.py] => memory_per_class: 20
2023-05-09 17:32:07,343 [trainer.py] => fixed_memory: False
2023-05-09 17:32:07,343 [trainer.py] => shuffle: True
2023-05-09 17:32:07,343 [trainer.py] => init_cls: 10
2023-05-09 17:32:07,343 [trainer.py] => increment: 10
2023-05-09 17:32:07,343 [trainer.py] => model_name: memo_transformer
2023-05-09 17:32:07,343 [trainer.py] => convnet_type: clip
2023-05-09 17:32:07,343 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 17:32:07,343 [trainer.py] => seed: 1993
2023-05-09 17:32:07,343 [trainer.py] => projection_type: pure_mlp
2023-05-09 17:32:07,343 [trainer.py] => fusion_choice: transformer
2023-05-09 17:32:07,343 [trainer.py] => split_train: False
2023-05-09 17:32:07,343 [trainer.py] => tsne_option: False
2023-05-09 17:32:07,343 [trainer.py] => laion_check: False
2023-05-09 17:32:07,343 [trainer.py] => train_tasks: 999
2023-05-09 17:32:07,343 [trainer.py] => frozen_layers: visual
2023-05-09 17:32:07,343 [trainer.py] => tuned_epoch: 5
2023-05-09 17:32:07,343 [trainer.py] => first_epoch: 7
2023-05-09 17:32:07,343 [trainer.py] => init_lr: 0.002
2023-05-09 17:32:07,343 [trainer.py] => batch_size: 32
2023-05-09 17:32:07,343 [trainer.py] => weight_decay: 0.0005
2023-05-09 17:32:07,343 [trainer.py] => min_lr: 0
2023-05-09 17:32:07,343 [trainer.py] => optimizer: sgd
2023-05-09 17:32:07,752 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 17:32:25,454 [instantiator.py] => Created a temporary directory at /tmp/tmprs4uz0o9
2023-05-09 17:32:25,455 [instantiator.py] => Writing /tmp/tmprs4uz0o9/_remote_module_non_sriptable.py
2023-05-09 17:32:25,749 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 17:32:28,634 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 17:32:29,149 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 17:32:31,762 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 17:32:32,253 [trainer.py] => All params: 150670849
2023-05-09 17:32:32,254 [trainer.py] => Trainable params: 150670849
2023-05-09 17:32:35,314 [memo_transformer.py] => Learning on 0-10
2023-05-09 17:33:23,500 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:33:23,538 [trainer.py] => CNN: {'total': 90.46, '00-09': 90.0, '10-19': 88.71, '20-29': 88.57, '30-39': 94.42, 'old': 89.1, 'new': 94.42, 'harmonic': 91.68}
2023-05-09 17:33:23,538 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 17:33:23,538 [trainer.py] => CNN top1 curve: [97.97, 94.64, 92.21, 90.46]
2023-05-09 17:33:23,538 [trainer.py] => CNN top5 curve: [99.95, 99.5, 99.23, 98.96]
2023-05-09 17:33:23,538 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 17:33:23,538 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 17:33:23,538 [trainer.py] => Average Accuracy (CNN): 93.82
2023-05-09 17:33:23,538 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 17:33:23,538 [trainer.py] => ZS seen top1 curve: [96.49, 91.56, 89.38, 86.91]
2023-05-09 17:33:23,538 [trainer.py] => ZS unseen top1 curve: [72.24, 78.05, 77.23, 76.6]
2023-05-09 17:33:23,538 [trainer.py] => ZS harmonic top1 curve: [82.62, 84.27, 82.86, 81.43]
2023-05-09 17:33:23,538 [trainer.py] => ZS total top1 curve: [74.69, 80.75, 80.87, 80.75]
2023-05-09 17:33:23,538 [trainer.py] => Average Accuracy (ZS seen): 91.08500000000001
2023-05-09 17:33:23,538 [trainer.py] => Average Accuracy (ZS unseen): 76.03
2023-05-09 17:33:23,539 [trainer.py] => Average Accuracy (ZS harmonic): 82.795
2023-05-09 17:33:23,539 [trainer.py] => Average Accuracy (ZS total): 79.265
2023-05-09 17:33:23,540 [trainer.py] => All params: 152778241
2023-05-09 17:33:23,540 [trainer.py] => Trainable params: 2364929
2023-05-09 17:33:23,554 [memo_transformer.py] => Learning on 40-50
2023-05-09 17:34:15,563 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 17:34:15,569 [trainer.py] => CNN: {'total': 92.25, '00-09': 93.71, '10-19': 90.68, '20-29': 92.31, 'old': 92.22, 'new': 92.31, 'harmonic': 92.26}
2023-05-09 17:34:15,569 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 17:34:15,569 [trainer.py] => CNN top1 curve: [97.87, 94.52, 92.25]
2023-05-09 17:34:15,569 [trainer.py] => CNN top5 curve: [99.85, 99.42, 99.23]
2023-05-09 17:34:15,569 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 17:34:15,570 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 17:34:15,570 [trainer.py] => Average Accuracy (CNN): 94.88
2023-05-09 17:34:15,570 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 17:34:15,570 [trainer.py] => ZS seen top1 curve: [97.77, 94.44, 91.7]
2023-05-09 17:34:15,570 [trainer.py] => ZS unseen top1 curve: [0.58, 1.87, 4.0]
2023-05-09 17:34:15,570 [trainer.py] => ZS harmonic top1 curve: [1.15, 3.67, 7.67]
2023-05-09 17:34:15,570 [trainer.py] => ZS total top1 curve: [10.39, 20.35, 30.28]
2023-05-09 17:34:15,570 [trainer.py] => Average Accuracy (ZS seen): 94.63666666666666
2023-05-09 17:34:15,571 [trainer.py] => Average Accuracy (ZS unseen): 2.15
2023-05-09 17:34:15,571 [trainer.py] => Average Accuracy (ZS harmonic): 4.163333333333333
2023-05-09 17:34:15,571 [trainer.py] => Average Accuracy (ZS total): 20.34
2023-05-09 17:34:15,573 [trainer.py] => All params: 152251393
2023-05-09 17:34:15,574 [trainer.py] => Trainable params: 2102273
2023-05-09 17:34:15,587 [memo_transformer.py] => Learning on 30-40
2023-05-09 17:38:52,188 [memo_transformer.py] => Task 0, Epoch 7/5 => Loss 1.513, Train_acc 98.70, Test_acc 97.92
2023-05-09 17:38:52,204 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:38:52,205 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 17:38:52,205 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 17:40:24,581 [memo_transformer.py] => Task 4, Epoch 4/5 => Loss 1.685, Train_acc 93.82, Test_acc 89.36
2023-05-09 17:40:24,606 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:40:24,610 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 17:40:59,592 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 17:41:37,484 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:41:37,489 [trainer.py] => CNN: {'total': 97.92, '00-09': 97.92, 'old': 0, 'new': 97.92, 'harmonic': 0.0}
2023-05-09 17:41:37,489 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 17:41:37,489 [trainer.py] => CNN top1 curve: [97.92]
2023-05-09 17:41:37,489 [trainer.py] => CNN top5 curve: [99.9]
2023-05-09 17:41:37,489 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 17:41:37,489 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 17:41:37,489 [trainer.py] => Average Accuracy (CNN): 97.92
2023-05-09 17:41:37,489 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 17:41:37,489 [trainer.py] => ZS seen top1 curve: [97.82]
2023-05-09 17:41:37,489 [trainer.py] => ZS unseen top1 curve: [1.38]
2023-05-09 17:41:37,489 [trainer.py] => ZS harmonic top1 curve: [2.72]
2023-05-09 17:41:37,490 [trainer.py] => ZS total top1 curve: [11.12]
2023-05-09 17:41:37,490 [trainer.py] => Average Accuracy (ZS seen): 97.82
2023-05-09 17:41:37,490 [trainer.py] => Average Accuracy (ZS unseen): 1.38
2023-05-09 17:41:37,490 [trainer.py] => Average Accuracy (ZS harmonic): 2.72
2023-05-09 17:41:37,490 [trainer.py] => Average Accuracy (ZS total): 11.12
2023-05-09 17:41:37,491 [trainer.py] => All params: 151197697
2023-05-09 17:41:37,492 [trainer.py] => Trainable params: 1576961
2023-05-09 17:41:37,506 [memo_transformer.py] => Learning on 10-20
2023-05-09 17:43:29,491 [memo_transformer.py] => Task 4, Epoch 7/5 => Loss 2.231, Train_acc 92.72, Test_acc 89.15
2023-05-09 17:43:29,542 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:43:29,542 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 17:44:03,325 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 17:44:25,154 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:44:25,185 [trainer.py] => CNN: {'total': 89.36, '00-09': 89.36, '10-19': 89.01, '20-29': 88.02, '30-39': 87.38, '40-49': 93.11, 'old': 88.43, 'new': 93.11, 'harmonic': 90.71}
2023-05-09 17:44:25,186 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 17:44:25,186 [trainer.py] => CNN top1 curve: [97.97, 94.64, 92.21, 90.46, 89.36]
2023-05-09 17:44:25,186 [trainer.py] => CNN top5 curve: [99.95, 99.5, 99.23, 98.96, 98.59]
2023-05-09 17:44:25,186 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 17:44:25,186 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 17:44:25,186 [trainer.py] => Average Accuracy (CNN): 92.928
2023-05-09 17:44:25,186 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 17:44:25,186 [trainer.py] => ZS seen top1 curve: [96.49, 91.56, 89.38, 86.91, 85.11]
2023-05-09 17:44:25,186 [trainer.py] => ZS unseen top1 curve: [72.24, 78.05, 77.23, 76.6, 77.18]
2023-05-09 17:44:25,186 [trainer.py] => ZS harmonic top1 curve: [82.62, 84.27, 82.86, 81.43, 80.95]
2023-05-09 17:44:25,186 [trainer.py] => ZS total top1 curve: [74.69, 80.75, 80.87, 80.75, 81.16]
2023-05-09 17:44:25,186 [trainer.py] => Average Accuracy (ZS seen): 89.89000000000001
2023-05-09 17:44:25,186 [trainer.py] => Average Accuracy (ZS unseen): 76.26
2023-05-09 17:44:25,186 [trainer.py] => Average Accuracy (ZS harmonic): 82.426
2023-05-09 17:44:25,186 [trainer.py] => Average Accuracy (ZS total): 79.644
2023-05-09 17:44:25,187 [trainer.py] => All params: 153305089
2023-05-09 17:44:25,188 [trainer.py] => Trainable params: 2627585
2023-05-09 17:44:25,205 [memo_transformer.py] => Learning on 50-60
2023-05-09 17:45:01,965 [memo_transformer.py] => Task 3, Epoch 7/5 => Loss 2.080, Train_acc 94.90, Test_acc 90.73
2023-05-09 17:45:01,966 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:45:01,971 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 17:45:37,695 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 17:47:40,129 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:47:40,194 [trainer.py] => CNN: {'total': 89.15, '00-09': 89.55, '10-19': 90.33, '20-29': 87.92, '30-39': 88.74, '40-49': 89.23, 'old': 89.13, 'new': 89.23, 'harmonic': 89.18}
2023-05-09 17:47:40,194 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 17:47:40,194 [trainer.py] => CNN top1 curve: [97.97, 94.22, 92.28, 90.57, 89.15]
2023-05-09 17:47:40,194 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.18, 99.02, 98.53]
2023-05-09 17:47:40,194 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 17:47:40,194 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 17:47:40,194 [trainer.py] => Average Accuracy (CNN): 92.83800000000001
2023-05-09 17:47:40,194 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 17:47:40,194 [trainer.py] => ZS seen top1 curve: [94.55, 91.04, 87.35, 86.15, 85.61]
2023-05-09 17:47:40,194 [trainer.py] => ZS unseen top1 curve: [69.14, 74.9, 77.52, 77.75, 77.24]
2023-05-09 17:47:40,194 [trainer.py] => ZS harmonic top1 curve: [79.87, 82.19, 82.14, 81.73, 81.21]
2023-05-09 17:47:40,194 [trainer.py] => ZS total top1 curve: [71.71, 78.12, 80.47, 81.13, 81.45]
2023-05-09 17:47:40,194 [trainer.py] => Average Accuracy (ZS seen): 88.94000000000001
2023-05-09 17:47:40,194 [trainer.py] => Average Accuracy (ZS unseen): 75.31
2023-05-09 17:47:40,194 [trainer.py] => Average Accuracy (ZS harmonic): 81.428
2023-05-09 17:47:40,194 [trainer.py] => Average Accuracy (ZS total): 78.576
2023-05-09 17:47:40,195 [trainer.py] => All params: 153305089
2023-05-09 17:47:40,196 [trainer.py] => Trainable params: 2627585
2023-05-09 17:47:40,209 [memo_transformer.py] => Learning on 50-60
2023-05-09 17:49:24,853 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:49:24,855 [trainer.py] => CNN: {'total': 90.73, '00-09': 90.89, '10-19': 91.04, '20-29': 88.47, '30-39': 92.48, 'old': 90.13, 'new': 92.48, 'harmonic': 91.29}
2023-05-09 17:49:24,855 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 17:49:24,855 [trainer.py] => CNN top1 curve: [97.87, 94.52, 92.25, 90.73]
2023-05-09 17:49:24,855 [trainer.py] => CNN top5 curve: [99.85, 99.42, 99.23, 98.85]
2023-05-09 17:49:24,855 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 17:49:24,855 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 17:49:24,856 [trainer.py] => Average Accuracy (CNN): 93.8425
2023-05-09 17:49:24,856 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 17:49:24,856 [trainer.py] => ZS seen top1 curve: [97.77, 94.44, 91.7, 90.53]
2023-05-09 17:49:24,856 [trainer.py] => ZS unseen top1 curve: [0.58, 1.87, 4.0, 8.72]
2023-05-09 17:49:24,856 [trainer.py] => ZS harmonic top1 curve: [1.15, 3.67, 7.67, 15.91]
2023-05-09 17:49:24,856 [trainer.py] => ZS total top1 curve: [10.39, 20.35, 30.28, 41.66]
2023-05-09 17:49:24,856 [trainer.py] => Average Accuracy (ZS seen): 93.60999999999999
2023-05-09 17:49:24,856 [trainer.py] => Average Accuracy (ZS unseen): 3.7925000000000004
2023-05-09 17:49:24,856 [trainer.py] => Average Accuracy (ZS harmonic): 7.1
2023-05-09 17:49:24,856 [trainer.py] => Average Accuracy (ZS total): 25.67
2023-05-09 17:49:24,857 [trainer.py] => All params: 152778241
2023-05-09 17:49:24,858 [trainer.py] => Trainable params: 2364929
2023-05-09 17:49:24,875 [memo_transformer.py] => Learning on 40-50
2023-05-09 17:50:17,518 [memo_transformer.py] => Task 1, Epoch 7/5 => Loss 1.393, Train_acc 96.96, Test_acc 94.87
2023-05-09 17:50:17,519 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:50:17,519 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 17:50:35,693 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 17:52:06,096 [memo_transformer.py] => Task 5, Epoch 4/5 => Loss 1.818, Train_acc 92.61, Test_acc 87.94
2023-05-09 17:52:06,133 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 17:52:06,137 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 17:52:42,410 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 17:53:39,063 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 17:53:39,064 [trainer.py] => CNN: {'total': 94.87, '00-09': 95.4, '10-19': 94.33, 'old': 95.4, 'new': 94.33, 'harmonic': 94.86}
2023-05-09 17:53:39,064 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 17:53:39,064 [trainer.py] => CNN top1 curve: [97.92, 94.87]
2023-05-09 17:53:39,064 [trainer.py] => CNN top5 curve: [99.9, 99.5]
2023-05-09 17:53:39,065 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 17:53:39,065 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 17:53:39,065 [trainer.py] => Average Accuracy (CNN): 96.39500000000001
2023-05-09 17:53:39,065 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 17:53:39,065 [trainer.py] => ZS seen top1 curve: [97.82, 94.72]
2023-05-09 17:53:39,065 [trainer.py] => ZS unseen top1 curve: [1.38, 4.48]
2023-05-09 17:53:39,065 [trainer.py] => ZS harmonic top1 curve: [2.72, 8.56]
2023-05-09 17:53:39,065 [trainer.py] => ZS total top1 curve: [11.12, 22.5]
2023-05-09 17:53:39,065 [trainer.py] => Average Accuracy (ZS seen): 96.27
2023-05-09 17:53:39,065 [trainer.py] => Average Accuracy (ZS unseen): 2.93
2023-05-09 17:53:39,065 [trainer.py] => Average Accuracy (ZS harmonic): 5.640000000000001
2023-05-09 17:53:39,065 [trainer.py] => Average Accuracy (ZS total): 16.81
2023-05-09 17:53:39,066 [trainer.py] => All params: 151724545
2023-05-09 17:53:39,067 [trainer.py] => Trainable params: 1839617
2023-05-09 17:53:39,080 [memo_transformer.py] => Learning on 20-30
2023-05-09 17:56:24,475 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 17:56:24,525 [trainer.py] => CNN: {'total': 87.94, '00-09': 88.66, '10-19': 88.2, '20-29': 85.77, '30-39': 85.1, '40-49': 87.32, '50-59': 92.64, 'old': 87.0, 'new': 92.64, 'harmonic': 89.73}
2023-05-09 17:56:24,525 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 17:56:24,525 [trainer.py] => CNN top1 curve: [97.97, 94.64, 92.21, 90.46, 89.36, 87.94]
2023-05-09 17:56:24,525 [trainer.py] => CNN top5 curve: [99.95, 99.5, 99.23, 98.96, 98.59, 98.13]
2023-05-09 17:56:24,525 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-09 17:56:24,525 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-09 17:56:24,525 [trainer.py] => Average Accuracy (CNN): 92.09666666666665
2023-05-09 17:56:24,525 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-09 17:56:24,526 [trainer.py] => ZS seen top1 curve: [96.49, 91.56, 89.38, 86.91, 85.11, 84.7]
2023-05-09 17:56:24,526 [trainer.py] => ZS unseen top1 curve: [72.24, 78.05, 77.23, 76.6, 77.18, 77.39]
2023-05-09 17:56:24,526 [trainer.py] => ZS harmonic top1 curve: [82.62, 84.27, 82.86, 81.43, 80.95, 80.88]
2023-05-09 17:56:24,526 [trainer.py] => ZS total top1 curve: [74.69, 80.75, 80.87, 80.75, 81.16, 81.8]
2023-05-09 17:56:24,526 [trainer.py] => Average Accuracy (ZS seen): 89.02500000000002
2023-05-09 17:56:24,526 [trainer.py] => Average Accuracy (ZS unseen): 76.44833333333334
2023-05-09 17:56:24,526 [trainer.py] => Average Accuracy (ZS harmonic): 82.16833333333334
2023-05-09 17:56:24,526 [trainer.py] => Average Accuracy (ZS total): 80.00333333333334
2023-05-09 17:56:24,528 [trainer.py] => All params: 153831937
2023-05-09 17:56:24,529 [trainer.py] => Trainable params: 2890241
2023-05-09 17:56:24,546 [memo_transformer.py] => Learning on 60-70
2023-05-09 18:00:04,235 [memo_transformer.py] => Task 5, Epoch 7/5 => Loss 2.392, Train_acc 91.23, Test_acc 87.47
2023-05-09 18:00:04,282 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:00:04,285 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 18:00:40,494 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 18:01:20,535 [memo_transformer.py] => Task 4, Epoch 7/5 => Loss 1.997, Train_acc 95.01, Test_acc 89.27
2023-05-09 18:01:20,536 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:01:20,540 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 18:02:02,014 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 18:03:27,118 [memo_transformer.py] => Task 2, Epoch 7/5 => Loss 1.368, Train_acc 96.40, Test_acc 92.68
2023-05-09 18:03:27,121 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:03:27,126 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 18:03:53,631 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 18:04:45,499 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 18:04:45,512 [trainer.py] => CNN: {'total': 87.47, '00-09': 87.38, '10-19': 88.76, '20-29': 86.52, '30-39': 87.38, '40-49': 89.23, '50-59': 85.62, 'old': 87.84, 'new': 85.62, 'harmonic': 86.72}
2023-05-09 18:04:45,512 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 18:04:45,512 [trainer.py] => CNN top1 curve: [97.97, 94.22, 92.28, 90.57, 89.15, 87.47]
2023-05-09 18:04:45,512 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.18, 99.02, 98.53, 98.08]
2023-05-09 18:04:45,512 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-09 18:04:45,512 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-09 18:04:45,512 [trainer.py] => Average Accuracy (CNN): 91.94333333333334
2023-05-09 18:04:45,512 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-09 18:04:45,513 [trainer.py] => ZS seen top1 curve: [94.55, 91.04, 87.35, 86.15, 85.61, 85.45]
2023-05-09 18:04:45,513 [trainer.py] => ZS unseen top1 curve: [69.14, 74.9, 77.52, 77.75, 77.24, 77.19]
2023-05-09 18:04:45,513 [trainer.py] => ZS harmonic top1 curve: [79.87, 82.19, 82.14, 81.73, 81.21, 81.11]
2023-05-09 18:04:45,513 [trainer.py] => ZS total top1 curve: [71.71, 78.12, 80.47, 81.13, 81.45, 82.17]
2023-05-09 18:04:45,513 [trainer.py] => Average Accuracy (ZS seen): 88.35833333333335
2023-05-09 18:04:45,513 [trainer.py] => Average Accuracy (ZS unseen): 75.62333333333333
2023-05-09 18:04:45,513 [trainer.py] => Average Accuracy (ZS harmonic): 81.375
2023-05-09 18:04:45,513 [trainer.py] => Average Accuracy (ZS total): 79.175
2023-05-09 18:04:45,514 [trainer.py] => All params: 153831937
2023-05-09 18:04:45,515 [trainer.py] => Trainable params: 2890241
2023-05-09 18:04:45,528 [memo_transformer.py] => Learning on 60-70
2023-05-09 18:04:46,437 [memo_transformer.py] => Task 6, Epoch 4/5 => Loss 2.132, Train_acc 88.63, Test_acc 85.56
2023-05-09 18:04:46,485 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:04:46,491 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 18:05:36,515 [base.py] => Constructing exemplars...(28 per classes)
2023-05-09 18:06:12,298 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 18:06:12,303 [trainer.py] => CNN: {'total': 89.27, '00-09': 88.51, '10-19': 90.43, '20-29': 87.47, '30-39': 88.45, '40-49': 91.55, 'old': 88.71, 'new': 91.55, 'harmonic': 90.11}
2023-05-09 18:06:12,303 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 18:06:12,303 [trainer.py] => CNN top1 curve: [97.87, 94.52, 92.25, 90.73, 89.27]
2023-05-09 18:06:12,303 [trainer.py] => CNN top5 curve: [99.85, 99.42, 99.23, 98.85, 98.44]
2023-05-09 18:06:12,304 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 18:06:12,304 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 18:06:12,304 [trainer.py] => Average Accuracy (CNN): 92.928
2023-05-09 18:06:12,304 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 18:06:12,304 [trainer.py] => ZS seen top1 curve: [97.77, 94.44, 91.7, 90.53, 88.64]
2023-05-09 18:06:12,304 [trainer.py] => ZS unseen top1 curve: [0.58, 1.87, 4.0, 8.72, 14.22]
2023-05-09 18:06:12,305 [trainer.py] => ZS harmonic top1 curve: [1.15, 3.67, 7.67, 15.91, 24.51]
2023-05-09 18:06:12,305 [trainer.py] => ZS total top1 curve: [10.39, 20.35, 30.28, 41.66, 51.57]
2023-05-09 18:06:12,305 [trainer.py] => Average Accuracy (ZS seen): 92.61599999999999
2023-05-09 18:06:12,305 [trainer.py] => Average Accuracy (ZS unseen): 5.878
2023-05-09 18:06:12,305 [trainer.py] => Average Accuracy (ZS harmonic): 10.581999999999999
2023-05-09 18:06:12,305 [trainer.py] => Average Accuracy (ZS total): 30.85
2023-05-09 18:06:12,306 [trainer.py] => All params: 153305089
2023-05-09 18:06:12,307 [trainer.py] => Trainable params: 2627585
2023-05-09 18:06:12,329 [memo_transformer.py] => Learning on 50-60
2023-05-09 18:07:12,811 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 18:07:12,826 [trainer.py] => CNN: {'total': 92.68, '00-09': 93.47, '10-19': 90.99, '20-29': 93.56, 'old': 92.24, 'new': 93.56, 'harmonic': 92.9}
2023-05-09 18:07:12,827 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 18:07:12,827 [trainer.py] => CNN top1 curve: [97.92, 94.87, 92.68]
2023-05-09 18:07:12,827 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.18]
2023-05-09 18:07:12,827 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 18:07:12,827 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 18:07:12,827 [trainer.py] => Average Accuracy (CNN): 95.15666666666668
2023-05-09 18:07:12,827 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 18:07:12,827 [trainer.py] => ZS seen top1 curve: [97.82, 94.72, 92.18]
2023-05-09 18:07:12,827 [trainer.py] => ZS unseen top1 curve: [1.38, 4.48, 7.04]
2023-05-09 18:07:12,827 [trainer.py] => ZS harmonic top1 curve: [2.72, 8.56, 13.08]
2023-05-09 18:07:12,827 [trainer.py] => ZS total top1 curve: [11.12, 22.5, 32.56]
2023-05-09 18:07:12,827 [trainer.py] => Average Accuracy (ZS seen): 94.90666666666668
2023-05-09 18:07:12,827 [trainer.py] => Average Accuracy (ZS unseen): 4.3
2023-05-09 18:07:12,827 [trainer.py] => Average Accuracy (ZS harmonic): 8.12
2023-05-09 18:07:12,827 [trainer.py] => Average Accuracy (ZS total): 22.060000000000002
2023-05-09 18:07:12,828 [trainer.py] => All params: 152251393
2023-05-09 18:07:12,829 [trainer.py] => Trainable params: 2102273
2023-05-09 18:07:12,844 [memo_transformer.py] => Learning on 30-40
2023-05-09 18:07:36,870 [trainer.py] => config: ././exp5_mlp//food101/food101_memo_transformer_clip_7_0.002_32_0.0005.json
2023-05-09 18:07:36,871 [trainer.py] => prefix: reproduce
2023-05-09 18:07:36,871 [trainer.py] => dataset: food101
2023-05-09 18:07:36,871 [trainer.py] => memory_size: 2000
2023-05-09 18:07:36,871 [trainer.py] => memory_per_class: 20
2023-05-09 18:07:36,871 [trainer.py] => fixed_memory: False
2023-05-09 18:07:36,871 [trainer.py] => shuffle: True
2023-05-09 18:07:36,871 [trainer.py] => init_cls: 10
2023-05-09 18:07:36,871 [trainer.py] => increment: 10
2023-05-09 18:07:36,871 [trainer.py] => model_name: memo_transformer
2023-05-09 18:07:36,871 [trainer.py] => convnet_type: clip
2023-05-09 18:07:36,871 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 18:07:36,871 [trainer.py] => seed: 1993
2023-05-09 18:07:36,871 [trainer.py] => projection_type: mlp
2023-05-09 18:07:36,871 [trainer.py] => fusion_choice: transformer
2023-05-09 18:07:36,871 [trainer.py] => split_train: False
2023-05-09 18:07:36,871 [trainer.py] => tsne_option: False
2023-05-09 18:07:36,871 [trainer.py] => laion_check: False
2023-05-09 18:07:36,871 [trainer.py] => train_tasks: 999
2023-05-09 18:07:36,871 [trainer.py] => frozen_layers: visual
2023-05-09 18:07:36,871 [trainer.py] => tuned_epoch: 5
2023-05-09 18:07:36,871 [trainer.py] => first_epoch: 7
2023-05-09 18:07:36,871 [trainer.py] => init_lr: 0.002
2023-05-09 18:07:36,871 [trainer.py] => batch_size: 32
2023-05-09 18:07:36,871 [trainer.py] => weight_decay: 0.0005
2023-05-09 18:07:36,871 [trainer.py] => min_lr: 0
2023-05-09 18:07:36,871 [trainer.py] => optimizer: sgd
2023-05-09 18:07:37,329 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 18:08:21,950 [instantiator.py] => Created a temporary directory at /tmp/tmp8gr5piet
2023-05-09 18:08:21,951 [instantiator.py] => Writing /tmp/tmp8gr5piet/_remote_module_non_sriptable.py
2023-05-09 18:08:23,381 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 18:08:26,986 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 18:08:27,374 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 18:08:29,961 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 18:08:30,379 [trainer.py] => All params: 150670849
2023-05-09 18:08:30,380 [trainer.py] => Trainable params: 150670849
2023-05-09 18:08:35,588 [memo_transformer.py] => Learning on 0-10
2023-05-09 18:09:31,381 [memo_transformer.py] => Exemplar size: 1960
2023-05-09 18:09:31,410 [trainer.py] => CNN: {'total': 85.56, '00-09': 88.27, '10-19': 86.18, '20-29': 84.72, '30-39': 83.4, '40-49': 85.66, '50-59': 83.08, '60-69': 87.68, 'old': 85.21, 'new': 87.68, 'harmonic': 86.43}
2023-05-09 18:09:31,410 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-09 18:09:31,410 [trainer.py] => CNN top1 curve: [97.97, 94.64, 92.21, 90.46, 89.36, 87.94, 85.56]
2023-05-09 18:09:31,410 [trainer.py] => CNN top5 curve: [99.95, 99.5, 99.23, 98.96, 98.59, 98.13, 97.65]
2023-05-09 18:09:31,410 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-09 18:09:31,410 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-09 18:09:31,410 [trainer.py] => Average Accuracy (CNN): 91.16285714285712
2023-05-09 18:09:31,410 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-09 18:09:31,410 [trainer.py] => ZS seen top1 curve: [96.49, 91.56, 89.38, 86.91, 85.11, 84.7, 82.87]
2023-05-09 18:09:31,410 [trainer.py] => ZS unseen top1 curve: [72.24, 78.05, 77.23, 76.6, 77.18, 77.39, 80.58]
2023-05-09 18:09:31,410 [trainer.py] => ZS harmonic top1 curve: [82.62, 84.27, 82.86, 81.43, 80.95, 80.88, 81.71]
2023-05-09 18:09:31,410 [trainer.py] => ZS total top1 curve: [74.69, 80.75, 80.87, 80.75, 81.16, 81.8, 82.19]
2023-05-09 18:09:31,410 [trainer.py] => Average Accuracy (ZS seen): 88.1457142857143
2023-05-09 18:09:31,410 [trainer.py] => Average Accuracy (ZS unseen): 77.03857142857143
2023-05-09 18:09:31,410 [trainer.py] => Average Accuracy (ZS harmonic): 82.10285714285715
2023-05-09 18:09:31,410 [trainer.py] => Average Accuracy (ZS total): 80.3157142857143
2023-05-09 18:09:31,411 [trainer.py] => All params: 154358785
2023-05-09 18:09:31,412 [trainer.py] => Trainable params: 3152897
2023-05-09 18:09:31,426 [memo_transformer.py] => Learning on 70-80
2023-05-09 18:14:43,949 [memo_transformer.py] => Task 0, Epoch 7/5 => Loss 1.572, Train_acc 98.47, Test_acc 97.97
2023-05-09 18:14:43,966 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:14:43,967 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 18:14:43,967 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 18:17:27,651 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 18:17:27,660 [trainer.py] => CNN: {'total': 97.97, '00-09': 97.97, 'old': 0, 'new': 97.97, 'harmonic': 0.0}
2023-05-09 18:17:27,660 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 18:17:27,660 [trainer.py] => CNN top1 curve: [97.97]
2023-05-09 18:17:27,660 [trainer.py] => CNN top5 curve: [99.95]
2023-05-09 18:17:27,660 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 18:17:27,660 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 18:17:27,660 [trainer.py] => Average Accuracy (CNN): 97.97
2023-05-09 18:17:27,660 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 18:17:27,660 [trainer.py] => ZS seen top1 curve: [97.43]
2023-05-09 18:17:27,660 [trainer.py] => ZS unseen top1 curve: [58.53]
2023-05-09 18:17:27,660 [trainer.py] => ZS harmonic top1 curve: [73.13]
2023-05-09 18:17:27,660 [trainer.py] => ZS total top1 curve: [62.46]
2023-05-09 18:17:27,660 [trainer.py] => Average Accuracy (ZS seen): 97.43
2023-05-09 18:17:27,660 [trainer.py] => Average Accuracy (ZS unseen): 58.53
2023-05-09 18:17:27,660 [trainer.py] => Average Accuracy (ZS harmonic): 73.13
2023-05-09 18:17:27,660 [trainer.py] => Average Accuracy (ZS total): 62.46
2023-05-09 18:17:27,662 [trainer.py] => All params: 151197697
2023-05-09 18:17:27,662 [trainer.py] => Trainable params: 1576961
2023-05-09 18:17:27,675 [memo_transformer.py] => Learning on 10-20
2023-05-09 18:18:14,223 [memo_transformer.py] => Task 3, Epoch 7/5 => Loss 1.365, Train_acc 96.65, Test_acc 91.16
2023-05-09 18:18:14,225 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:18:14,229 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 18:18:15,316 [memo_transformer.py] => Task 6, Epoch 7/5 => Loss 2.715, Train_acc 87.26, Test_acc 84.98
2023-05-09 18:18:15,387 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:18:15,387 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 18:18:33,915 [memo_transformer.py] => Task 7, Epoch 4/5 => Loss 1.854, Train_acc 91.95, Test_acc 84.98
2023-05-09 18:18:33,950 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:18:33,952 [base.py] => Reducing exemplars...(25 per classes)
2023-05-09 18:18:45,967 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 18:18:54,355 [base.py] => Constructing exemplars...(28 per classes)
2023-05-09 18:19:12,761 [memo_transformer.py] => Task 5, Epoch 7/5 => Loss 2.054, Train_acc 95.17, Test_acc 87.62
2023-05-09 18:19:12,762 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:19:12,763 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 18:19:22,164 [base.py] => Constructing exemplars...(25 per classes)
2023-05-09 18:20:02,145 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 18:22:27,543 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 18:22:27,550 [trainer.py] => CNN: {'total': 91.16, '00-09': 91.14, '10-19': 90.58, '20-29': 89.02, '30-39': 93.83, 'old': 90.25, 'new': 93.83, 'harmonic': 92.01}
2023-05-09 18:22:27,550 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 18:22:27,551 [trainer.py] => CNN top1 curve: [97.92, 94.87, 92.68, 91.16]
2023-05-09 18:22:27,551 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.18, 98.87]
2023-05-09 18:22:27,551 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 18:22:27,551 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 18:22:27,551 [trainer.py] => Average Accuracy (CNN): 94.1575
2023-05-09 18:22:27,551 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 18:22:27,551 [trainer.py] => ZS seen top1 curve: [97.82, 94.72, 92.18, 90.85]
2023-05-09 18:22:27,551 [trainer.py] => ZS unseen top1 curve: [1.38, 4.48, 7.04, 12.29]
2023-05-09 18:22:27,551 [trainer.py] => ZS harmonic top1 curve: [2.72, 8.56, 13.08, 21.65]
2023-05-09 18:22:27,551 [trainer.py] => ZS total top1 curve: [11.12, 22.5, 32.56, 43.92]
2023-05-09 18:22:27,551 [trainer.py] => Average Accuracy (ZS seen): 93.89250000000001
2023-05-09 18:22:27,551 [trainer.py] => Average Accuracy (ZS unseen): 6.297499999999999
2023-05-09 18:22:27,551 [trainer.py] => Average Accuracy (ZS harmonic): 11.5025
2023-05-09 18:22:27,551 [trainer.py] => Average Accuracy (ZS total): 27.525000000000002
2023-05-09 18:22:27,552 [trainer.py] => All params: 152778241
2023-05-09 18:22:27,553 [trainer.py] => Trainable params: 2364929
2023-05-09 18:22:27,567 [memo_transformer.py] => Learning on 40-50
2023-05-09 18:23:22,141 [memo_transformer.py] => Exemplar size: 1960
2023-05-09 18:23:22,206 [trainer.py] => CNN: {'total': 84.98, '00-09': 85.25, '10-19': 87.85, '20-29': 84.02, '30-39': 86.7, '40-49': 87.92, '50-59': 83.78, '60-69': 79.29, 'old': 85.91, 'new': 79.29, 'harmonic': 82.47}
2023-05-09 18:23:22,206 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-09 18:23:22,206 [trainer.py] => CNN top1 curve: [97.97, 94.22, 92.28, 90.57, 89.15, 87.47, 84.98]
2023-05-09 18:23:22,206 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.18, 99.02, 98.53, 98.08, 97.56]
2023-05-09 18:23:22,207 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-09 18:23:22,207 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-09 18:23:22,207 [trainer.py] => Average Accuracy (CNN): 90.94857142857144
2023-05-09 18:23:22,207 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-09 18:23:22,207 [trainer.py] => ZS seen top1 curve: [94.55, 91.04, 87.35, 86.15, 85.61, 85.45, 83.9]
2023-05-09 18:23:22,207 [trainer.py] => ZS unseen top1 curve: [69.14, 74.9, 77.52, 77.75, 77.24, 77.19, 79.05]
2023-05-09 18:23:22,207 [trainer.py] => ZS harmonic top1 curve: [79.87, 82.19, 82.14, 81.73, 81.21, 81.11, 81.4]
2023-05-09 18:23:22,207 [trainer.py] => ZS total top1 curve: [71.71, 78.12, 80.47, 81.13, 81.45, 82.17, 82.46]
2023-05-09 18:23:22,207 [trainer.py] => Average Accuracy (ZS seen): 87.72142857142858
2023-05-09 18:23:22,207 [trainer.py] => Average Accuracy (ZS unseen): 76.11285714285714
2023-05-09 18:23:22,207 [trainer.py] => Average Accuracy (ZS harmonic): 81.37857142857142
2023-05-09 18:23:22,207 [trainer.py] => Average Accuracy (ZS total): 79.64428571428572
2023-05-09 18:23:22,208 [trainer.py] => All params: 154358785
2023-05-09 18:23:22,209 [trainer.py] => Trainable params: 3152897
2023-05-09 18:23:22,222 [memo_transformer.py] => Learning on 70-80
2023-05-09 18:24:09,251 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 18:24:09,283 [trainer.py] => CNN: {'total': 84.98, '00-09': 86.58, '10-19': 85.87, '20-29': 83.82, '30-39': 82.28, '40-49': 85.25, '50-59': 83.68, '60-69': 78.99, '70-79': 93.35, 'old': 83.78, 'new': 93.35, 'harmonic': 88.31}
2023-05-09 18:24:09,283 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-09 18:24:09,283 [trainer.py] => CNN top1 curve: [97.97, 94.64, 92.21, 90.46, 89.36, 87.94, 85.56, 84.98]
2023-05-09 18:24:09,283 [trainer.py] => CNN top5 curve: [99.95, 99.5, 99.23, 98.96, 98.59, 98.13, 97.65, 97.19]
2023-05-09 18:24:09,283 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-09 18:24:09,283 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-09 18:24:09,283 [trainer.py] => Average Accuracy (CNN): 90.38999999999999
2023-05-09 18:24:09,283 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-09 18:24:09,283 [trainer.py] => ZS seen top1 curve: [96.49, 91.56, 89.38, 86.91, 85.11, 84.7, 82.87, 81.97]
2023-05-09 18:24:09,283 [trainer.py] => ZS unseen top1 curve: [72.24, 78.05, 77.23, 76.6, 77.18, 77.39, 80.58, 78.85]
2023-05-09 18:24:09,283 [trainer.py] => ZS harmonic top1 curve: [82.62, 84.27, 82.86, 81.43, 80.95, 80.88, 81.71, 80.38]
2023-05-09 18:24:09,283 [trainer.py] => ZS total top1 curve: [74.69, 80.75, 80.87, 80.75, 81.16, 81.8, 82.19, 81.35]
2023-05-09 18:24:09,283 [trainer.py] => Average Accuracy (ZS seen): 87.37375000000002
2023-05-09 18:24:09,283 [trainer.py] => Average Accuracy (ZS unseen): 77.265
2023-05-09 18:24:09,283 [trainer.py] => Average Accuracy (ZS harmonic): 81.8875
2023-05-09 18:24:09,283 [trainer.py] => Average Accuracy (ZS total): 80.44500000000001
2023-05-09 18:24:09,284 [trainer.py] => All params: 154885633
2023-05-09 18:24:09,285 [trainer.py] => Trainable params: 3415553
2023-05-09 18:24:09,299 [memo_transformer.py] => Learning on 80-90
2023-05-09 18:24:40,256 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 18:24:40,257 [trainer.py] => CNN: {'total': 87.62, '00-09': 88.22, '10-19': 88.25, '20-29': 85.97, '30-39': 85.87, '40-49': 89.18, '50-59': 88.31, 'old': 87.49, 'new': 88.31, 'harmonic': 87.9}
2023-05-09 18:24:40,257 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 18:24:40,257 [trainer.py] => CNN top1 curve: [97.87, 94.52, 92.25, 90.73, 89.27, 87.62]
2023-05-09 18:24:40,258 [trainer.py] => CNN top5 curve: [99.85, 99.42, 99.23, 98.85, 98.44, 98.16]
2023-05-09 18:24:40,258 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-09 18:24:40,258 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-09 18:24:40,258 [trainer.py] => Average Accuracy (CNN): 92.04333333333334
2023-05-09 18:24:40,258 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-09 18:24:40,258 [trainer.py] => ZS seen top1 curve: [97.77, 94.44, 91.7, 90.53, 88.64, 86.63]
2023-05-09 18:24:40,258 [trainer.py] => ZS unseen top1 curve: [0.58, 1.87, 4.0, 8.72, 14.22, 21.1]
2023-05-09 18:24:40,258 [trainer.py] => ZS harmonic top1 curve: [1.15, 3.67, 7.67, 15.91, 24.51, 33.93]
2023-05-09 18:24:40,258 [trainer.py] => ZS total top1 curve: [10.39, 20.35, 30.28, 41.66, 51.57, 60.57]
2023-05-09 18:24:40,258 [trainer.py] => Average Accuracy (ZS seen): 91.61833333333333
2023-05-09 18:24:40,258 [trainer.py] => Average Accuracy (ZS unseen): 8.415000000000001
2023-05-09 18:24:40,258 [trainer.py] => Average Accuracy (ZS harmonic): 14.473333333333334
2023-05-09 18:24:40,258 [trainer.py] => Average Accuracy (ZS total): 35.803333333333335
2023-05-09 18:24:40,259 [trainer.py] => All params: 153831937
2023-05-09 18:24:40,260 [trainer.py] => Trainable params: 2890241
2023-05-09 18:24:40,273 [memo_transformer.py] => Learning on 60-70
2023-05-09 18:25:58,742 [memo_transformer.py] => Task 1, Epoch 7/5 => Loss 1.555, Train_acc 95.36, Test_acc 94.97
2023-05-09 18:25:58,752 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:25:58,752 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 18:26:18,505 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 18:29:15,776 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 18:29:15,779 [trainer.py] => CNN: {'total': 94.97, '00-09': 96.19, '10-19': 93.72, 'old': 96.19, 'new': 93.72, 'harmonic': 94.94}
2023-05-09 18:29:15,779 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 18:29:15,779 [trainer.py] => CNN top1 curve: [97.97, 94.97]
2023-05-09 18:29:15,780 [trainer.py] => CNN top5 curve: [99.95, 99.47]
2023-05-09 18:29:15,780 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 18:29:15,780 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 18:29:15,780 [trainer.py] => Average Accuracy (CNN): 96.47
2023-05-09 18:29:15,780 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 18:29:15,780 [trainer.py] => ZS seen top1 curve: [97.43, 93.44]
2023-05-09 18:29:15,780 [trainer.py] => ZS unseen top1 curve: [58.53, 70.38]
2023-05-09 18:29:15,780 [trainer.py] => ZS harmonic top1 curve: [73.13, 80.29]
2023-05-09 18:29:15,780 [trainer.py] => ZS total top1 curve: [62.46, 74.98]
2023-05-09 18:29:15,780 [trainer.py] => Average Accuracy (ZS seen): 95.435
2023-05-09 18:29:15,780 [trainer.py] => Average Accuracy (ZS unseen): 64.455
2023-05-09 18:29:15,780 [trainer.py] => Average Accuracy (ZS harmonic): 76.71000000000001
2023-05-09 18:29:15,780 [trainer.py] => Average Accuracy (ZS total): 68.72
2023-05-09 18:29:15,781 [trainer.py] => All params: 151724545
2023-05-09 18:29:15,782 [trainer.py] => Trainable params: 1839617
2023-05-09 18:29:15,796 [memo_transformer.py] => Learning on 20-30
2023-05-09 18:34:01,845 [memo_transformer.py] => Task 8, Epoch 4/5 => Loss 1.888, Train_acc 91.40, Test_acc 84.10
2023-05-09 18:34:01,896 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:34:01,900 [base.py] => Reducing exemplars...(22 per classes)
2023-05-09 18:34:50,966 [base.py] => Constructing exemplars...(22 per classes)
2023-05-09 18:34:51,486 [memo_transformer.py] => Task 4, Epoch 7/5 => Loss 1.287, Train_acc 97.77, Test_acc 89.59
2023-05-09 18:34:51,493 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:34:51,497 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 18:35:28,097 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 18:37:57,963 [memo_transformer.py] => Task 7, Epoch 7/5 => Loss 2.367, Train_acc 91.65, Test_acc 84.14
2023-05-09 18:37:58,045 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:37:58,045 [base.py] => Reducing exemplars...(25 per classes)
2023-05-09 18:38:41,350 [base.py] => Constructing exemplars...(25 per classes)
2023-05-09 18:38:53,005 [memo_transformer.py] => Task 6, Epoch 7/5 => Loss 2.366, Train_acc 91.44, Test_acc 85.17
2023-05-09 18:38:53,010 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:38:53,010 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 18:38:55,691 [memo_transformer.py] => Task 2, Epoch 7/5 => Loss 1.552, Train_acc 94.55, Test_acc 92.48
2023-05-09 18:38:55,762 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:38:55,763 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 18:39:22,276 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 18:39:35,933 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 18:39:35,942 [trainer.py] => CNN: {'total': 89.59, '00-09': 89.21, '10-19': 90.13, '20-29': 87.02, '30-39': 88.5, '40-49': 93.16, 'old': 88.71, 'new': 93.16, 'harmonic': 90.88}
2023-05-09 18:39:35,942 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 18:39:35,942 [trainer.py] => CNN top1 curve: [97.92, 94.87, 92.68, 91.16, 89.59]
2023-05-09 18:39:35,942 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.18, 98.87, 98.39]
2023-05-09 18:39:35,942 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 18:39:35,942 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 18:39:35,942 [trainer.py] => Average Accuracy (CNN): 93.244
2023-05-09 18:39:35,943 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 18:39:35,943 [trainer.py] => ZS seen top1 curve: [97.82, 94.72, 92.18, 90.85, 89.24]
2023-05-09 18:39:35,943 [trainer.py] => ZS unseen top1 curve: [1.38, 4.48, 7.04, 12.29, 17.65]
2023-05-09 18:39:35,943 [trainer.py] => ZS harmonic top1 curve: [2.72, 8.56, 13.08, 21.65, 29.47]
2023-05-09 18:39:35,943 [trainer.py] => ZS total top1 curve: [11.12, 22.5, 32.56, 43.92, 53.58]
2023-05-09 18:39:35,943 [trainer.py] => Average Accuracy (ZS seen): 92.96200000000002
2023-05-09 18:39:35,943 [trainer.py] => Average Accuracy (ZS unseen): 8.568
2023-05-09 18:39:35,943 [trainer.py] => Average Accuracy (ZS harmonic): 15.095999999999998
2023-05-09 18:39:35,943 [trainer.py] => Average Accuracy (ZS total): 32.736000000000004
2023-05-09 18:39:35,944 [trainer.py] => All params: 153305089
2023-05-09 18:39:35,945 [trainer.py] => Trainable params: 2627585
2023-05-09 18:39:35,959 [memo_transformer.py] => Learning on 50-60
2023-05-09 18:39:49,495 [base.py] => Constructing exemplars...(28 per classes)
2023-05-09 18:39:55,754 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 18:39:55,794 [trainer.py] => CNN: {'total': 84.1, '00-09': 87.18, '10-19': 84.56, '20-29': 84.22, '30-39': 81.7, '40-49': 82.23, '50-59': 83.48, '60-69': 73.03, '70-79': 87.16, '80-89': 93.27, 'old': 82.96, 'new': 93.27, 'harmonic': 87.81}
2023-05-09 18:39:55,794 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-09 18:39:55,794 [trainer.py] => CNN top1 curve: [97.97, 94.64, 92.21, 90.46, 89.36, 87.94, 85.56, 84.98, 84.1]
2023-05-09 18:39:55,794 [trainer.py] => CNN top5 curve: [99.95, 99.5, 99.23, 98.96, 98.59, 98.13, 97.65, 97.19, 96.95]
2023-05-09 18:39:55,794 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-09 18:39:55,794 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-09 18:39:55,794 [trainer.py] => Average Accuracy (CNN): 89.6911111111111
2023-05-09 18:39:55,794 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-09 18:39:55,795 [trainer.py] => ZS seen top1 curve: [96.49, 91.56, 89.38, 86.91, 85.11, 84.7, 82.87, 81.97, 82.08]
2023-05-09 18:39:55,795 [trainer.py] => ZS unseen top1 curve: [72.24, 78.05, 77.23, 76.6, 77.18, 77.39, 80.58, 78.85, 74.45]
2023-05-09 18:39:55,795 [trainer.py] => ZS harmonic top1 curve: [82.62, 84.27, 82.86, 81.43, 80.95, 80.88, 81.71, 80.38, 78.08]
2023-05-09 18:39:55,795 [trainer.py] => ZS total top1 curve: [74.69, 80.75, 80.87, 80.75, 81.16, 81.8, 82.19, 81.35, 81.33]
2023-05-09 18:39:55,795 [trainer.py] => Average Accuracy (ZS seen): 86.78555555555558
2023-05-09 18:39:55,795 [trainer.py] => Average Accuracy (ZS unseen): 76.95222222222223
2023-05-09 18:39:55,795 [trainer.py] => Average Accuracy (ZS harmonic): 81.46444444444445
2023-05-09 18:39:55,795 [trainer.py] => Average Accuracy (ZS total): 80.54333333333335
2023-05-09 18:39:55,796 [trainer.py] => All params: 155412481
2023-05-09 18:39:55,797 [trainer.py] => Trainable params: 3678209
2023-05-09 18:39:55,811 [memo_transformer.py] => Learning on 90-100
2023-05-09 18:42:34,685 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 18:42:34,713 [trainer.py] => CNN: {'total': 92.48, '00-09': 93.17, '10-19': 92.1, '20-29': 92.16, 'old': 92.64, 'new': 92.16, 'harmonic': 92.4}
2023-05-09 18:42:34,713 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 18:42:34,713 [trainer.py] => CNN top1 curve: [97.97, 94.97, 92.48]
2023-05-09 18:42:34,713 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.23]
2023-05-09 18:42:34,713 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 18:42:34,713 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 18:42:34,713 [trainer.py] => Average Accuracy (CNN): 95.14
2023-05-09 18:42:34,713 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 18:42:34,713 [trainer.py] => ZS seen top1 curve: [97.43, 93.44, 89.31]
2023-05-09 18:42:34,713 [trainer.py] => ZS unseen top1 curve: [58.53, 70.38, 75.26]
2023-05-09 18:42:34,714 [trainer.py] => ZS harmonic top1 curve: [73.13, 80.29, 81.69]
2023-05-09 18:42:34,714 [trainer.py] => ZS total top1 curve: [62.46, 74.98, 79.47]
2023-05-09 18:42:34,714 [trainer.py] => Average Accuracy (ZS seen): 93.39333333333333
2023-05-09 18:42:34,714 [trainer.py] => Average Accuracy (ZS unseen): 68.05666666666667
2023-05-09 18:42:34,714 [trainer.py] => Average Accuracy (ZS harmonic): 78.37
2023-05-09 18:42:34,714 [trainer.py] => Average Accuracy (ZS total): 72.30333333333333
2023-05-09 18:42:34,715 [trainer.py] => All params: 152251393
2023-05-09 18:42:34,716 [trainer.py] => Trainable params: 2102273
2023-05-09 18:42:34,730 [memo_transformer.py] => Learning on 30-40
2023-05-09 18:43:25,864 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 18:43:25,943 [trainer.py] => CNN: {'total': 84.14, '00-09': 84.85, '10-19': 85.67, '20-29': 83.28, '30-39': 84.71, '40-49': 87.02, '50-59': 82.84, '60-69': 78.99, '70-79': 85.71, 'old': 83.91, 'new': 85.71, 'harmonic': 84.8}
2023-05-09 18:43:25,943 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-09 18:43:25,944 [trainer.py] => CNN top1 curve: [97.97, 94.22, 92.28, 90.57, 89.15, 87.47, 84.98, 84.14]
2023-05-09 18:43:25,944 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.18, 99.02, 98.53, 98.08, 97.56, 97.15]
2023-05-09 18:43:25,944 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-09 18:43:25,944 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-09 18:43:25,944 [trainer.py] => Average Accuracy (CNN): 90.09750000000001
2023-05-09 18:43:25,944 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-09 18:43:25,944 [trainer.py] => ZS seen top1 curve: [94.55, 91.04, 87.35, 86.15, 85.61, 85.45, 83.9, 83.99]
2023-05-09 18:43:25,944 [trainer.py] => ZS unseen top1 curve: [69.14, 74.9, 77.52, 77.75, 77.24, 77.19, 79.05, 77.52]
2023-05-09 18:43:25,944 [trainer.py] => ZS harmonic top1 curve: [79.87, 82.19, 82.14, 81.73, 81.21, 81.11, 81.4, 80.63]
2023-05-09 18:43:25,944 [trainer.py] => ZS total top1 curve: [71.71, 78.12, 80.47, 81.13, 81.45, 82.17, 82.46, 82.7]
2023-05-09 18:43:25,944 [trainer.py] => Average Accuracy (ZS seen): 87.25500000000001
2023-05-09 18:43:25,944 [trainer.py] => Average Accuracy (ZS unseen): 76.28875
2023-05-09 18:43:25,944 [trainer.py] => Average Accuracy (ZS harmonic): 81.285
2023-05-09 18:43:25,944 [trainer.py] => Average Accuracy (ZS total): 80.02625
2023-05-09 18:43:25,945 [trainer.py] => All params: 154885633
2023-05-09 18:43:25,947 [trainer.py] => Trainable params: 3415553
2023-05-09 18:43:25,978 [memo_transformer.py] => Learning on 80-90
2023-05-09 18:44:51,795 [memo_transformer.py] => Exemplar size: 1960
2023-05-09 18:44:51,800 [trainer.py] => CNN: {'total': 85.17, '00-09': 85.69, '10-19': 88.2, '20-29': 83.97, '30-39': 86.12, '40-49': 88.02, '50-59': 82.14, '60-69': 82.02, 'old': 85.68, 'new': 82.02, 'harmonic': 83.81}
2023-05-09 18:44:51,800 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-09 18:44:51,800 [trainer.py] => CNN top1 curve: [97.87, 94.52, 92.25, 90.73, 89.27, 87.62, 85.17]
2023-05-09 18:44:51,800 [trainer.py] => CNN top5 curve: [99.85, 99.42, 99.23, 98.85, 98.44, 98.16, 97.61]
2023-05-09 18:44:51,800 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-09 18:44:51,800 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-09 18:44:51,800 [trainer.py] => Average Accuracy (CNN): 91.06142857142856
2023-05-09 18:44:51,800 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-09 18:44:51,800 [trainer.py] => ZS seen top1 curve: [97.77, 94.44, 91.7, 90.53, 88.64, 86.63, 84.17]
2023-05-09 18:44:51,800 [trainer.py] => ZS unseen top1 curve: [0.58, 1.87, 4.0, 8.72, 14.22, 21.1, 21.6]
2023-05-09 18:44:51,800 [trainer.py] => ZS harmonic top1 curve: [1.15, 3.67, 7.67, 15.91, 24.51, 33.93, 34.38]
2023-05-09 18:44:51,800 [trainer.py] => ZS total top1 curve: [10.39, 20.35, 30.28, 41.66, 51.57, 60.57, 65.48]
2023-05-09 18:44:51,800 [trainer.py] => Average Accuracy (ZS seen): 90.5542857142857
2023-05-09 18:44:51,800 [trainer.py] => Average Accuracy (ZS unseen): 10.29857142857143
2023-05-09 18:44:51,800 [trainer.py] => Average Accuracy (ZS harmonic): 17.31714285714286
2023-05-09 18:44:51,800 [trainer.py] => Average Accuracy (ZS total): 40.042857142857144
2023-05-09 18:44:51,801 [trainer.py] => All params: 154358785
2023-05-09 18:44:51,802 [trainer.py] => Trainable params: 3152897
2023-05-09 18:44:51,815 [memo_transformer.py] => Learning on 70-80
2023-05-09 18:50:25,791 [memo_transformer.py] => Task 9, Epoch 4/5 => Loss 2.068, Train_acc 89.69, Test_acc 82.39
2023-05-09 18:50:25,880 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:50:25,884 [base.py] => Reducing exemplars...(20 per classes)
2023-05-09 18:51:17,858 [base.py] => Constructing exemplars...(20 per classes)
2023-05-09 18:53:04,820 [memo_transformer.py] => Task 5, Epoch 7/5 => Loss 1.341, Train_acc 97.47, Test_acc 88.03
2023-05-09 18:53:04,824 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:53:04,831 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 18:53:20,198 [memo_transformer.py] => Task 3, Epoch 7/5 => Loss 1.586, Train_acc 94.30, Test_acc 90.52
2023-05-09 18:53:20,201 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:53:20,202 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 18:53:45,156 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 18:53:54,911 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 18:56:39,659 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 18:56:39,695 [trainer.py] => CNN: {'total': 82.39, '00-09': 86.19, '10-19': 85.06, '20-29': 78.33, '30-39': 81.55, '40-49': 81.08, '50-59': 78.86, '60-69': 73.43, '70-79': 83.06, '80-89': 86.75, '90-99': 89.57, 'old': 81.6, 'new': 89.57, 'harmonic': 85.4}
2023-05-09 18:56:39,695 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-09 18:56:39,695 [trainer.py] => CNN top1 curve: [97.97, 94.64, 92.21, 90.46, 89.36, 87.94, 85.56, 84.98, 84.1, 82.39]
2023-05-09 18:56:39,695 [trainer.py] => CNN top5 curve: [99.95, 99.5, 99.23, 98.96, 98.59, 98.13, 97.65, 97.19, 96.95, 96.53]
2023-05-09 18:56:39,695 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-09 18:56:39,695 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-09 18:56:39,695 [trainer.py] => Average Accuracy (CNN): 88.96099999999998
2023-05-09 18:56:39,695 [trainer.py] => Average Accuracy (NME): 87.828
2023-05-09 18:56:39,696 [trainer.py] => ZS seen top1 curve: [96.49, 91.56, 89.38, 86.91, 85.11, 84.7, 82.87, 81.97, 82.08, 81.93]
2023-05-09 18:56:39,696 [trainer.py] => ZS unseen top1 curve: [72.24, 78.05, 77.23, 76.6, 77.18, 77.39, 80.58, 78.85, 74.45, 0]
2023-05-09 18:56:39,696 [trainer.py] => ZS harmonic top1 curve: [82.62, 84.27, 82.86, 81.43, 80.95, 80.88, 81.71, 80.38, 78.08, 0.0]
2023-05-09 18:56:39,696 [trainer.py] => ZS total top1 curve: [74.69, 80.75, 80.87, 80.75, 81.16, 81.8, 82.19, 81.35, 81.33, 81.93]
2023-05-09 18:56:39,696 [trainer.py] => Average Accuracy (ZS seen): 86.30000000000003
2023-05-09 18:56:39,696 [trainer.py] => Average Accuracy (ZS unseen): 69.257
2023-05-09 18:56:39,696 [trainer.py] => Average Accuracy (ZS harmonic): 73.31800000000001
2023-05-09 18:56:39,696 [trainer.py] => Average Accuracy (ZS total): 80.68200000000002
2023-05-09 18:57:19,121 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 18:57:19,132 [trainer.py] => CNN: {'total': 90.52, '00-09': 90.84, '10-19': 90.58, '20-29': 88.77, '30-39': 91.84, 'old': 90.06, 'new': 91.84, 'harmonic': 90.94}
2023-05-09 18:57:19,132 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 18:57:19,132 [trainer.py] => CNN top1 curve: [97.97, 94.97, 92.48, 90.52]
2023-05-09 18:57:19,132 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.23, 98.88]
2023-05-09 18:57:19,132 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 18:57:19,132 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 18:57:19,132 [trainer.py] => Average Accuracy (CNN): 93.985
2023-05-09 18:57:19,132 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 18:57:19,132 [trainer.py] => ZS seen top1 curve: [97.43, 93.44, 89.31, 88.5]
2023-05-09 18:57:19,132 [trainer.py] => ZS unseen top1 curve: [58.53, 70.38, 75.26, 76.0]
2023-05-09 18:57:19,132 [trainer.py] => ZS harmonic top1 curve: [73.13, 80.29, 81.69, 81.78]
2023-05-09 18:57:19,132 [trainer.py] => ZS total top1 curve: [62.46, 74.98, 79.47, 81.03]
2023-05-09 18:57:19,132 [trainer.py] => Average Accuracy (ZS seen): 92.17
2023-05-09 18:57:19,132 [trainer.py] => Average Accuracy (ZS unseen): 70.0425
2023-05-09 18:57:19,132 [trainer.py] => Average Accuracy (ZS harmonic): 79.2225
2023-05-09 18:57:19,132 [trainer.py] => Average Accuracy (ZS total): 74.485
2023-05-09 18:57:19,134 [trainer.py] => All params: 152778241
2023-05-09 18:57:19,134 [trainer.py] => Trainable params: 2364929
2023-05-09 18:57:19,147 [memo_transformer.py] => Learning on 40-50
2023-05-09 18:57:59,104 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 18:57:59,105 [trainer.py] => CNN: {'total': 88.03, '00-09': 88.32, '10-19': 87.7, '20-29': 86.32, '30-39': 85.44, '40-49': 89.08, '50-59': 91.39, 'old': 87.36, 'new': 91.39, 'harmonic': 89.33}
2023-05-09 18:57:59,105 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 18:57:59,105 [trainer.py] => CNN top1 curve: [97.92, 94.87, 92.68, 91.16, 89.59, 88.03]
2023-05-09 18:57:59,105 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.18, 98.87, 98.39, 98.09]
2023-05-09 18:57:59,105 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-09 18:57:59,105 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-09 18:57:59,105 [trainer.py] => Average Accuracy (CNN): 92.375
2023-05-09 18:57:59,106 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-09 18:57:59,106 [trainer.py] => ZS seen top1 curve: [97.82, 94.72, 92.18, 90.85, 89.24, 87.87]
2023-05-09 18:57:59,106 [trainer.py] => ZS unseen top1 curve: [1.38, 4.48, 7.04, 12.29, 17.65, 23.5]
2023-05-09 18:57:59,106 [trainer.py] => ZS harmonic top1 curve: [2.72, 8.56, 13.08, 21.65, 29.47, 37.08]
2023-05-09 18:57:59,106 [trainer.py] => ZS total top1 curve: [11.12, 22.5, 32.56, 43.92, 53.58, 62.28]
2023-05-09 18:57:59,106 [trainer.py] => Average Accuracy (ZS seen): 92.11333333333334
2023-05-09 18:57:59,106 [trainer.py] => Average Accuracy (ZS unseen): 11.056666666666667
2023-05-09 18:57:59,106 [trainer.py] => Average Accuracy (ZS harmonic): 18.759999999999998
2023-05-09 18:57:59,106 [trainer.py] => Average Accuracy (ZS total): 37.660000000000004
2023-05-09 18:57:59,108 [trainer.py] => All params: 153831937
2023-05-09 18:57:59,109 [trainer.py] => Trainable params: 2890241
2023-05-09 18:57:59,126 [memo_transformer.py] => Learning on 60-70
2023-05-09 18:59:04,525 [memo_transformer.py] => Task 8, Epoch 7/5 => Loss 2.374, Train_acc 91.67, Test_acc 83.93
2023-05-09 18:59:04,591 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 18:59:04,595 [base.py] => Reducing exemplars...(22 per classes)
2023-05-09 18:59:50,244 [base.py] => Constructing exemplars...(22 per classes)
2023-05-09 19:00:23,114 [memo_transformer.py] => Task 7, Epoch 7/5 => Loss 2.060, Train_acc 95.00, Test_acc 84.63
2023-05-09 19:00:23,115 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 19:00:23,115 [base.py] => Reducing exemplars...(25 per classes)
2023-05-09 19:01:25,099 [base.py] => Constructing exemplars...(25 per classes)
2023-05-09 19:04:51,028 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 19:04:51,088 [trainer.py] => CNN: {'total': 83.93, '00-09': 85.0, '10-19': 84.96, '20-29': 83.97, '30-39': 83.54, '40-49': 86.06, '50-59': 82.69, '60-69': 76.31, '70-79': 86.01, '80-89': 86.75, 'old': 83.57, 'new': 86.75, 'harmonic': 85.13}
2023-05-09 19:04:51,088 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-09 19:04:51,088 [trainer.py] => CNN top1 curve: [97.97, 94.22, 92.28, 90.57, 89.15, 87.47, 84.98, 84.14, 83.93]
2023-05-09 19:04:51,088 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.18, 99.02, 98.53, 98.08, 97.56, 97.15, 96.88]
2023-05-09 19:04:51,088 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-09 19:04:51,088 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-09 19:04:51,088 [trainer.py] => Average Accuracy (CNN): 89.41222222222223
2023-05-09 19:04:51,088 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-09 19:04:51,088 [trainer.py] => ZS seen top1 curve: [94.55, 91.04, 87.35, 86.15, 85.61, 85.45, 83.9, 83.99, 84.04]
2023-05-09 19:04:51,088 [trainer.py] => ZS unseen top1 curve: [69.14, 74.9, 77.52, 77.75, 77.24, 77.19, 79.05, 77.52, 74.29]
2023-05-09 19:04:51,088 [trainer.py] => ZS harmonic top1 curve: [79.87, 82.19, 82.14, 81.73, 81.21, 81.11, 81.4, 80.63, 78.86]
2023-05-09 19:04:51,088 [trainer.py] => ZS total top1 curve: [71.71, 78.12, 80.47, 81.13, 81.45, 82.17, 82.46, 82.7, 83.07]
2023-05-09 19:04:51,088 [trainer.py] => Average Accuracy (ZS seen): 86.89777777777778
2023-05-09 19:04:51,088 [trainer.py] => Average Accuracy (ZS unseen): 76.06666666666666
2023-05-09 19:04:51,088 [trainer.py] => Average Accuracy (ZS harmonic): 81.01555555555555
2023-05-09 19:04:51,088 [trainer.py] => Average Accuracy (ZS total): 80.36444444444444
2023-05-09 19:04:51,089 [trainer.py] => All params: 155412481
2023-05-09 19:04:51,090 [trainer.py] => Trainable params: 3678209
2023-05-09 19:04:51,104 [memo_transformer.py] => Learning on 90-100
2023-05-09 19:06:42,212 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 19:06:42,233 [trainer.py] => CNN: {'total': 84.63, '00-09': 86.39, '10-19': 87.19, '20-29': 82.48, '30-39': 83.5, '40-49': 88.73, '50-59': 82.14, '60-69': 77.63, '70-79': 89.06, 'old': 84.0, 'new': 89.06, 'harmonic': 86.46}
2023-05-09 19:06:42,233 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-09 19:06:42,233 [trainer.py] => CNN top1 curve: [97.87, 94.52, 92.25, 90.73, 89.27, 87.62, 85.17, 84.63]
2023-05-09 19:06:42,233 [trainer.py] => CNN top5 curve: [99.85, 99.42, 99.23, 98.85, 98.44, 98.16, 97.61, 97.12]
2023-05-09 19:06:42,233 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-09 19:06:42,233 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-09 19:06:42,234 [trainer.py] => Average Accuracy (CNN): 90.2575
2023-05-09 19:06:42,234 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-09 19:06:42,234 [trainer.py] => ZS seen top1 curve: [97.77, 94.44, 91.7, 90.53, 88.64, 86.63, 84.17, 83.49]
2023-05-09 19:06:42,234 [trainer.py] => ZS unseen top1 curve: [0.58, 1.87, 4.0, 8.72, 14.22, 21.1, 21.6, 26.74]
2023-05-09 19:06:42,234 [trainer.py] => ZS harmonic top1 curve: [1.15, 3.67, 7.67, 15.91, 24.51, 33.93, 34.38, 40.51]
2023-05-09 19:06:42,234 [trainer.py] => ZS total top1 curve: [10.39, 20.35, 30.28, 41.66, 51.57, 60.57, 65.48, 72.21]
2023-05-09 19:06:42,234 [trainer.py] => Average Accuracy (ZS seen): 89.67124999999999
2023-05-09 19:06:42,234 [trainer.py] => Average Accuracy (ZS unseen): 12.35375
2023-05-09 19:06:42,234 [trainer.py] => Average Accuracy (ZS harmonic): 20.21625
2023-05-09 19:06:42,234 [trainer.py] => Average Accuracy (ZS total): 44.06375
2023-05-09 19:06:42,236 [trainer.py] => All params: 154885633
2023-05-09 19:06:42,236 [trainer.py] => Trainable params: 3415553
2023-05-09 19:06:42,253 [memo_transformer.py] => Learning on 80-90
2023-05-09 19:07:27,204 [trainer.py] => config: ././exp5_mlp//food101/food101_memo_transformer_clip_1_0.002_32_0.0005.json
2023-05-09 19:07:27,207 [trainer.py] => prefix: reproduce
2023-05-09 19:07:27,207 [trainer.py] => dataset: food101
2023-05-09 19:07:27,207 [trainer.py] => memory_size: 2000
2023-05-09 19:07:27,207 [trainer.py] => memory_per_class: 20
2023-05-09 19:07:27,207 [trainer.py] => fixed_memory: False
2023-05-09 19:07:27,207 [trainer.py] => shuffle: True
2023-05-09 19:07:27,207 [trainer.py] => init_cls: 10
2023-05-09 19:07:27,207 [trainer.py] => increment: 10
2023-05-09 19:07:27,207 [trainer.py] => model_name: memo_transformer
2023-05-09 19:07:27,207 [trainer.py] => convnet_type: clip
2023-05-09 19:07:27,208 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 19:07:27,208 [trainer.py] => seed: 1993
2023-05-09 19:07:27,208 [trainer.py] => projection_type: mlp
2023-05-09 19:07:27,208 [trainer.py] => fusion_choice: transformer
2023-05-09 19:07:27,208 [trainer.py] => split_train: False
2023-05-09 19:07:27,208 [trainer.py] => tsne_option: False
2023-05-09 19:07:27,208 [trainer.py] => laion_check: False
2023-05-09 19:07:27,208 [trainer.py] => train_tasks: 999
2023-05-09 19:07:27,208 [trainer.py] => frozen_layers: visual
2023-05-09 19:07:27,208 [trainer.py] => tuned_epoch: 5
2023-05-09 19:07:27,208 [trainer.py] => first_epoch: 1
2023-05-09 19:07:27,208 [trainer.py] => init_lr: 0.002
2023-05-09 19:07:27,208 [trainer.py] => batch_size: 32
2023-05-09 19:07:27,209 [trainer.py] => weight_decay: 0.0005
2023-05-09 19:07:27,209 [trainer.py] => min_lr: 0
2023-05-09 19:07:27,209 [trainer.py] => optimizer: sgd
2023-05-09 19:07:27,886 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 19:08:24,457 [instantiator.py] => Created a temporary directory at /tmp/tmporpyujwq
2023-05-09 19:08:24,458 [instantiator.py] => Writing /tmp/tmporpyujwq/_remote_module_non_sriptable.py
2023-05-09 19:08:26,317 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 19:08:30,716 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 19:08:31,748 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 19:08:35,481 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 19:08:36,536 [trainer.py] => All params: 150670849
2023-05-09 19:08:36,537 [trainer.py] => Trainable params: 150670849
2023-05-09 19:08:44,634 [memo_transformer.py] => Learning on 0-10
2023-05-09 19:09:18,078 [memo_transformer.py] => Task 4, Epoch 7/5 => Loss 1.509, Train_acc 94.71, Test_acc 89.04
2023-05-09 19:09:18,093 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 19:09:18,093 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 19:09:54,717 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 19:10:09,338 [memo_transformer.py] => Task 0, Epoch 1/5 => Loss 2.032, Train_acc 93.52, Test_acc 97.97
2023-05-09 19:10:09,339 [memo_transformer.py] => Laion scores: [0] 
2023-05-09 19:10:09,340 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 19:10:09,340 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 19:12:41,199 [memo_transformer.py] => Task 6, Epoch 7/5 => Loss 1.588, Train_acc 94.29, Test_acc 85.81
2023-05-09 19:12:41,207 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 19:12:41,212 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 19:13:25,229 [base.py] => Constructing exemplars...(28 per classes)
2023-05-09 19:13:32,633 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 19:13:32,634 [trainer.py] => CNN: {'total': 97.97, '00-09': 97.97, 'old': 0, 'new': 97.97, 'harmonic': 0.0}
2023-05-09 19:13:32,635 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 19:13:32,635 [trainer.py] => CNN top1 curve: [97.97]
2023-05-09 19:13:32,635 [trainer.py] => CNN top5 curve: [99.9]
2023-05-09 19:13:32,635 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 19:13:32,635 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 19:13:32,635 [trainer.py] => Average Accuracy (CNN): 97.97
2023-05-09 19:13:32,635 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 19:13:32,635 [trainer.py] => ZS seen top1 curve: [96.73]
2023-05-09 19:13:32,635 [trainer.py] => ZS unseen top1 curve: [61.84]
2023-05-09 19:13:32,635 [trainer.py] => ZS harmonic top1 curve: [75.45]
2023-05-09 19:13:32,636 [trainer.py] => ZS total top1 curve: [65.36]
2023-05-09 19:13:32,636 [trainer.py] => Average Accuracy (ZS seen): 96.73
2023-05-09 19:13:32,636 [trainer.py] => Average Accuracy (ZS unseen): 61.84
2023-05-09 19:13:32,636 [trainer.py] => Average Accuracy (ZS harmonic): 75.45
2023-05-09 19:13:32,636 [trainer.py] => Average Accuracy (ZS total): 65.36
2023-05-09 19:13:32,637 [trainer.py] => All params: 151197697
2023-05-09 19:13:32,638 [trainer.py] => Trainable params: 1576961
2023-05-09 19:13:32,652 [memo_transformer.py] => Learning on 10-20
2023-05-09 19:13:42,896 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 19:13:42,905 [trainer.py] => CNN: {'total': 89.04, '00-09': 89.31, '10-19': 89.32, '20-29': 86.12, '30-39': 90.0, '40-49': 90.44, 'old': 88.69, 'new': 90.44, 'harmonic': 89.56}
2023-05-09 19:13:42,905 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 19:13:42,905 [trainer.py] => CNN top1 curve: [97.97, 94.97, 92.48, 90.52, 89.04]
2023-05-09 19:13:42,905 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.23, 98.88, 98.5]
2023-05-09 19:13:42,905 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 19:13:42,905 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 19:13:42,905 [trainer.py] => Average Accuracy (CNN): 92.99600000000001
2023-05-09 19:13:42,905 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 19:13:42,905 [trainer.py] => ZS seen top1 curve: [97.43, 93.44, 89.31, 88.5, 87.57]
2023-05-09 19:13:42,905 [trainer.py] => ZS unseen top1 curve: [58.53, 70.38, 75.26, 76.0, 75.33]
2023-05-09 19:13:42,905 [trainer.py] => ZS harmonic top1 curve: [73.13, 80.29, 81.69, 81.78, 80.99]
2023-05-09 19:13:42,905 [trainer.py] => ZS total top1 curve: [62.46, 74.98, 79.47, 81.03, 81.47]
2023-05-09 19:13:42,905 [trainer.py] => Average Accuracy (ZS seen): 91.25
2023-05-09 19:13:42,906 [trainer.py] => Average Accuracy (ZS unseen): 71.1
2023-05-09 19:13:42,906 [trainer.py] => Average Accuracy (ZS harmonic): 79.576
2023-05-09 19:13:42,906 [trainer.py] => Average Accuracy (ZS total): 75.88199999999999
2023-05-09 19:13:42,907 [trainer.py] => All params: 153305089
2023-05-09 19:13:42,907 [trainer.py] => Trainable params: 2627585
2023-05-09 19:13:42,921 [memo_transformer.py] => Learning on 50-60
2023-05-09 19:15:19,567 [memo_transformer.py] => Task 1, Epoch 1/5 => Loss 1.936, Train_acc 89.70, Test_acc 94.37
2023-05-09 19:15:19,568 [memo_transformer.py] => Laion scores: [0, 0] 
2023-05-09 19:15:19,568 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 19:15:43,392 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 19:18:04,080 [memo_transformer.py] => Exemplar size: 1960
2023-05-09 19:18:04,136 [trainer.py] => CNN: {'total': 85.81, '00-09': 85.5, '10-19': 88.3, '20-29': 83.67, '30-39': 86.46, '40-49': 87.97, '50-59': 82.79, '60-69': 86.01, 'old': 85.77, 'new': 86.01, 'harmonic': 85.89}
2023-05-09 19:18:04,136 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-09 19:18:04,136 [trainer.py] => CNN top1 curve: [97.92, 94.87, 92.68, 91.16, 89.59, 88.03, 85.81]
2023-05-09 19:18:04,136 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.18, 98.87, 98.39, 98.09, 97.68]
2023-05-09 19:18:04,136 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-09 19:18:04,136 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-09 19:18:04,137 [trainer.py] => Average Accuracy (CNN): 91.43714285714285
2023-05-09 19:18:04,137 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-09 19:18:04,137 [trainer.py] => ZS seen top1 curve: [97.82, 94.72, 92.18, 90.85, 89.24, 87.87, 85.59]
2023-05-09 19:18:04,137 [trainer.py] => ZS unseen top1 curve: [1.38, 4.48, 7.04, 12.29, 17.65, 23.5, 26.95]
2023-05-09 19:18:04,137 [trainer.py] => ZS harmonic top1 curve: [2.72, 8.56, 13.08, 21.65, 29.47, 37.08, 40.99]
2023-05-09 19:18:04,137 [trainer.py] => ZS total top1 curve: [11.12, 22.5, 32.56, 43.92, 53.58, 62.28, 68.08]
2023-05-09 19:18:04,137 [trainer.py] => Average Accuracy (ZS seen): 91.18142857142858
2023-05-09 19:18:04,137 [trainer.py] => Average Accuracy (ZS unseen): 13.327142857142858
2023-05-09 19:18:04,137 [trainer.py] => Average Accuracy (ZS harmonic): 21.935714285714283
2023-05-09 19:18:04,137 [trainer.py] => Average Accuracy (ZS total): 42.00571428571429
2023-05-09 19:18:04,138 [trainer.py] => All params: 154358785
2023-05-09 19:18:04,139 [trainer.py] => Trainable params: 3152897
2023-05-09 19:18:04,152 [memo_transformer.py] => Learning on 70-80
2023-05-09 19:19:13,004 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 19:19:13,005 [trainer.py] => CNN: {'total': 94.37, '00-09': 95.54, '10-19': 93.16, 'old': 95.54, 'new': 93.16, 'harmonic': 94.33}
2023-05-09 19:19:13,005 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 19:19:13,005 [trainer.py] => CNN top1 curve: [97.97, 94.37]
2023-05-09 19:19:13,005 [trainer.py] => CNN top5 curve: [99.9, 99.52]
2023-05-09 19:19:13,005 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 19:19:13,005 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 19:19:13,006 [trainer.py] => Average Accuracy (CNN): 96.17
2023-05-09 19:19:13,006 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 19:19:13,006 [trainer.py] => ZS seen top1 curve: [96.73, 91.76]
2023-05-09 19:19:13,006 [trainer.py] => ZS unseen top1 curve: [61.84, 74.05]
2023-05-09 19:19:13,006 [trainer.py] => ZS harmonic top1 curve: [75.45, 81.96]
2023-05-09 19:19:13,006 [trainer.py] => ZS total top1 curve: [65.36, 77.58]
2023-05-09 19:19:13,006 [trainer.py] => Average Accuracy (ZS seen): 94.245
2023-05-09 19:19:13,006 [trainer.py] => Average Accuracy (ZS unseen): 67.945
2023-05-09 19:19:13,006 [trainer.py] => Average Accuracy (ZS harmonic): 78.705
2023-05-09 19:19:13,006 [trainer.py] => Average Accuracy (ZS total): 71.47
2023-05-09 19:19:13,008 [trainer.py] => All params: 151724545
2023-05-09 19:19:13,008 [trainer.py] => Trainable params: 1839617
2023-05-09 19:19:13,028 [memo_transformer.py] => Learning on 20-30
2023-05-09 19:21:09,269 [memo_transformer.py] => Task 2, Epoch 1/5 => Loss 1.926, Train_acc 89.26, Test_acc 92.25
2023-05-09 19:21:09,269 [memo_transformer.py] => Laion scores: [0, 0, 0] 
2023-05-09 19:21:09,270 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 19:21:35,618 [memo_transformer.py] => Task 9, Epoch 7/5 => Loss 2.515, Train_acc 89.77, Test_acc 82.36
2023-05-09 19:21:35,665 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 19:21:35,669 [base.py] => Reducing exemplars...(20 per classes)
2023-05-09 19:21:45,479 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 19:22:24,721 [base.py] => Constructing exemplars...(20 per classes)
2023-05-09 19:23:00,937 [memo_transformer.py] => Task 8, Epoch 7/5 => Loss 2.089, Train_acc 94.75, Test_acc 84.05
2023-05-09 19:23:00,940 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 19:23:00,940 [base.py] => Reducing exemplars...(22 per classes)
2023-05-09 19:24:01,899 [base.py] => Constructing exemplars...(22 per classes)
2023-05-09 19:25:27,031 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 19:25:27,032 [trainer.py] => CNN: {'total': 92.25, '00-09': 93.02, '10-19': 90.84, '20-29': 92.86, 'old': 91.94, 'new': 92.86, 'harmonic': 92.4}
2023-05-09 19:25:27,032 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 19:25:27,032 [trainer.py] => CNN top1 curve: [97.97, 94.37, 92.25]
2023-05-09 19:25:27,032 [trainer.py] => CNN top5 curve: [99.9, 99.52, 99.25]
2023-05-09 19:25:27,032 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 19:25:27,032 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 19:25:27,033 [trainer.py] => Average Accuracy (CNN): 94.86333333333334
2023-05-09 19:25:27,033 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 19:25:27,033 [trainer.py] => ZS seen top1 curve: [96.73, 91.76, 87.8]
2023-05-09 19:25:27,033 [trainer.py] => ZS unseen top1 curve: [61.84, 74.05, 76.26]
2023-05-09 19:25:27,033 [trainer.py] => ZS harmonic top1 curve: [75.45, 81.96, 81.62]
2023-05-09 19:25:27,033 [trainer.py] => ZS total top1 curve: [65.36, 77.58, 79.72]
2023-05-09 19:25:27,033 [trainer.py] => Average Accuracy (ZS seen): 92.09666666666668
2023-05-09 19:25:27,033 [trainer.py] => Average Accuracy (ZS unseen): 70.71666666666665
2023-05-09 19:25:27,033 [trainer.py] => Average Accuracy (ZS harmonic): 79.67666666666666
2023-05-09 19:25:27,033 [trainer.py] => Average Accuracy (ZS total): 74.22
2023-05-09 19:25:27,035 [trainer.py] => All params: 152251393
2023-05-09 19:25:27,036 [trainer.py] => Trainable params: 2102273
2023-05-09 19:25:27,053 [memo_transformer.py] => Learning on 30-40
2023-05-09 19:26:52,749 [memo_transformer.py] => Task 5, Epoch 7/5 => Loss 1.618, Train_acc 94.36, Test_acc 87.57
2023-05-09 19:26:52,754 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 19:26:52,759 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 19:27:30,057 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 19:27:31,460 [memo_transformer.py] => Task 3, Epoch 1/5 => Loss 1.951, Train_acc 89.39, Test_acc 90.43
2023-05-09 19:27:31,462 [memo_transformer.py] => Laion scores: [0, 0, 0, 0] 
2023-05-09 19:27:31,467 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 19:27:39,471 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 19:27:39,548 [trainer.py] => CNN: {'total': 82.36, '00-09': 84.7, '10-19': 84.51, '20-29': 81.28, '30-39': 82.91, '40-49': 84.95, '50-59': 82.14, '60-69': 75.15, '70-79': 84.71, '80-89': 86.45, '90-99': 76.66, 'old': 82.98, 'new': 76.66, 'harmonic': 79.69}
2023-05-09 19:27:39,548 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-09 19:27:39,548 [trainer.py] => CNN top1 curve: [97.97, 94.22, 92.28, 90.57, 89.15, 87.47, 84.98, 84.14, 83.93, 82.36]
2023-05-09 19:27:39,548 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.18, 99.02, 98.53, 98.08, 97.56, 97.15, 96.88, 96.5]
2023-05-09 19:27:39,548 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-09 19:27:39,548 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-09 19:27:39,548 [trainer.py] => Average Accuracy (CNN): 88.70700000000001
2023-05-09 19:27:39,548 [trainer.py] => Average Accuracy (NME): 87.828
2023-05-09 19:27:39,548 [trainer.py] => ZS seen top1 curve: [94.55, 91.04, 87.35, 86.15, 85.61, 85.45, 83.9, 83.99, 84.04, 83.18]
2023-05-09 19:27:39,549 [trainer.py] => ZS unseen top1 curve: [69.14, 74.9, 77.52, 77.75, 77.24, 77.19, 79.05, 77.52, 74.29, 0]
2023-05-09 19:27:39,549 [trainer.py] => ZS harmonic top1 curve: [79.87, 82.19, 82.14, 81.73, 81.21, 81.11, 81.4, 80.63, 78.86, 0.0]
2023-05-09 19:27:39,549 [trainer.py] => ZS total top1 curve: [71.71, 78.12, 80.47, 81.13, 81.45, 82.17, 82.46, 82.7, 83.07, 83.18]
2023-05-09 19:27:39,549 [trainer.py] => Average Accuracy (ZS seen): 86.526
2023-05-09 19:27:39,549 [trainer.py] => Average Accuracy (ZS unseen): 68.46
2023-05-09 19:27:39,549 [trainer.py] => Average Accuracy (ZS harmonic): 72.914
2023-05-09 19:27:39,549 [trainer.py] => Average Accuracy (ZS total): 80.646
2023-05-09 19:28:09,905 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 19:29:26,406 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 19:29:26,408 [trainer.py] => CNN: {'total': 84.05, '00-09': 86.14, '10-19': 84.91, '20-29': 84.72, '30-39': 82.28, '40-49': 86.31, '50-59': 81.64, '60-69': 76.36, '70-79': 85.61, '80-89': 88.5, 'old': 83.5, 'new': 88.5, 'harmonic': 85.93}
2023-05-09 19:29:26,408 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-09 19:29:26,408 [trainer.py] => CNN top1 curve: [97.87, 94.52, 92.25, 90.73, 89.27, 87.62, 85.17, 84.63, 84.05]
2023-05-09 19:29:26,408 [trainer.py] => CNN top5 curve: [99.85, 99.42, 99.23, 98.85, 98.44, 98.16, 97.61, 97.12, 96.98]
2023-05-09 19:29:26,408 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-09 19:29:26,408 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-09 19:29:26,408 [trainer.py] => Average Accuracy (CNN): 89.56777777777776
2023-05-09 19:29:26,409 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-09 19:29:26,409 [trainer.py] => ZS seen top1 curve: [97.77, 94.44, 91.7, 90.53, 88.64, 86.63, 84.17, 83.49, 83.01]
2023-05-09 19:29:26,409 [trainer.py] => ZS unseen top1 curve: [0.58, 1.87, 4.0, 8.72, 14.22, 21.1, 21.6, 26.74, 30.85]
2023-05-09 19:29:26,409 [trainer.py] => ZS harmonic top1 curve: [1.15, 3.67, 7.67, 15.91, 24.51, 33.93, 34.38, 40.51, 44.98]
2023-05-09 19:29:26,409 [trainer.py] => ZS total top1 curve: [10.39, 20.35, 30.28, 41.66, 51.57, 60.57, 65.48, 72.21, 77.84]
2023-05-09 19:29:26,409 [trainer.py] => Average Accuracy (ZS seen): 88.9311111111111
2023-05-09 19:29:26,409 [trainer.py] => Average Accuracy (ZS unseen): 14.408888888888889
2023-05-09 19:29:26,409 [trainer.py] => Average Accuracy (ZS harmonic): 22.967777777777776
2023-05-09 19:29:26,409 [trainer.py] => Average Accuracy (ZS total): 47.81666666666667
2023-05-09 19:29:26,410 [trainer.py] => All params: 155412481
2023-05-09 19:29:26,411 [trainer.py] => Trainable params: 3678209
2023-05-09 19:29:26,424 [memo_transformer.py] => Learning on 90-100
2023-05-09 19:31:24,503 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 19:31:24,519 [trainer.py] => CNN: {'total': 87.57, '00-09': 88.27, '10-19': 88.15, '20-29': 85.62, '30-39': 87.48, '40-49': 90.29, '50-59': 85.67, 'old': 87.95, 'new': 85.67, 'harmonic': 86.8}
2023-05-09 19:31:24,519 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 19:31:24,519 [trainer.py] => CNN top1 curve: [97.97, 94.97, 92.48, 90.52, 89.04, 87.57]
2023-05-09 19:31:24,519 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.23, 98.88, 98.5, 98.11]
2023-05-09 19:31:24,519 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-09 19:31:24,519 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-09 19:31:24,519 [trainer.py] => Average Accuracy (CNN): 92.09166666666665
2023-05-09 19:31:24,519 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-09 19:31:24,519 [trainer.py] => ZS seen top1 curve: [97.43, 93.44, 89.31, 88.5, 87.57, 86.38]
2023-05-09 19:31:24,519 [trainer.py] => ZS unseen top1 curve: [58.53, 70.38, 75.26, 76.0, 75.33, 76.34]
2023-05-09 19:31:24,519 [trainer.py] => ZS harmonic top1 curve: [73.13, 80.29, 81.69, 81.78, 80.99, 81.05]
2023-05-09 19:31:24,519 [trainer.py] => ZS total top1 curve: [62.46, 74.98, 79.47, 81.03, 81.47, 82.39]
2023-05-09 19:31:24,519 [trainer.py] => Average Accuracy (ZS seen): 90.43833333333333
2023-05-09 19:31:24,519 [trainer.py] => Average Accuracy (ZS unseen): 71.97333333333334
2023-05-09 19:31:24,519 [trainer.py] => Average Accuracy (ZS harmonic): 79.82166666666667
2023-05-09 19:31:24,520 [trainer.py] => Average Accuracy (ZS total): 76.96666666666665
2023-05-09 19:31:24,521 [trainer.py] => All params: 153831937
2023-05-09 19:31:24,521 [trainer.py] => Trainable params: 2890241
2023-05-09 19:31:24,533 [memo_transformer.py] => Learning on 60-70
2023-05-09 19:32:05,449 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 19:32:05,451 [trainer.py] => CNN: {'total': 90.43, '00-09': 90.69, '10-19': 90.63, '20-29': 89.67, '30-39': 90.73, 'old': 90.33, 'new': 90.73, 'harmonic': 90.53}
2023-05-09 19:32:05,451 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 19:32:05,451 [trainer.py] => CNN top1 curve: [97.97, 94.37, 92.25, 90.43]
2023-05-09 19:32:05,451 [trainer.py] => CNN top5 curve: [99.9, 99.52, 99.25, 98.92]
2023-05-09 19:32:05,451 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 19:32:05,451 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 19:32:05,452 [trainer.py] => Average Accuracy (CNN): 93.75500000000001
2023-05-09 19:32:05,452 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 19:32:05,452 [trainer.py] => ZS seen top1 curve: [96.73, 91.76, 87.8, 86.91]
2023-05-09 19:32:05,452 [trainer.py] => ZS unseen top1 curve: [61.84, 74.05, 76.26, 76.95]
2023-05-09 19:32:05,452 [trainer.py] => ZS harmonic top1 curve: [75.45, 81.96, 81.62, 81.63]
2023-05-09 19:32:05,452 [trainer.py] => ZS total top1 curve: [65.36, 77.58, 79.72, 80.96]
2023-05-09 19:32:05,452 [trainer.py] => Average Accuracy (ZS seen): 90.80000000000001
2023-05-09 19:32:05,453 [trainer.py] => Average Accuracy (ZS unseen): 72.27499999999999
2023-05-09 19:32:05,453 [trainer.py] => Average Accuracy (ZS harmonic): 80.16499999999999
2023-05-09 19:32:05,453 [trainer.py] => Average Accuracy (ZS total): 75.905
2023-05-09 19:32:05,454 [trainer.py] => All params: 152778241
2023-05-09 19:32:05,455 [trainer.py] => Trainable params: 2364929
2023-05-09 19:32:05,472 [memo_transformer.py] => Learning on 40-50
2023-05-09 19:34:00,838 [memo_transformer.py] => Task 7, Epoch 7/5 => Loss 1.330, Train_acc 98.03, Test_acc 85.36
2023-05-09 19:34:00,839 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 19:34:00,843 [base.py] => Reducing exemplars...(25 per classes)
2023-05-09 19:34:22,310 [memo_transformer.py] => Task 4, Epoch 1/5 => Loss 1.839, Train_acc 90.69, Test_acc 88.55
2023-05-09 19:34:22,312 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0] 
2023-05-09 19:34:22,316 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 19:34:49,366 [base.py] => Constructing exemplars...(25 per classes)
2023-05-09 19:35:07,328 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 19:39:14,690 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 19:39:14,724 [trainer.py] => CNN: {'total': 88.55, '00-09': 88.37, '10-19': 88.05, '20-29': 87.77, '30-39': 88.45, '40-49': 90.14, 'old': 88.16, 'new': 90.14, 'harmonic': 89.14}
2023-05-09 19:39:14,725 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 19:39:14,725 [trainer.py] => CNN top1 curve: [97.97, 94.37, 92.25, 90.43, 88.55]
2023-05-09 19:39:14,725 [trainer.py] => CNN top5 curve: [99.9, 99.52, 99.25, 98.92, 98.43]
2023-05-09 19:39:14,725 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 19:39:14,725 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 19:39:14,726 [trainer.py] => Average Accuracy (CNN): 92.71400000000001
2023-05-09 19:39:14,726 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 19:39:14,726 [trainer.py] => ZS seen top1 curve: [96.73, 91.76, 87.8, 86.91, 86.11]
2023-05-09 19:39:14,726 [trainer.py] => ZS unseen top1 curve: [61.84, 74.05, 76.26, 76.95, 77.36]
2023-05-09 19:39:14,726 [trainer.py] => ZS harmonic top1 curve: [75.45, 81.96, 81.62, 81.63, 81.5]
2023-05-09 19:39:14,726 [trainer.py] => ZS total top1 curve: [65.36, 77.58, 79.72, 80.96, 81.75]
2023-05-09 19:39:14,726 [trainer.py] => Average Accuracy (ZS seen): 89.86200000000001
2023-05-09 19:39:14,726 [trainer.py] => Average Accuracy (ZS unseen): 73.292
2023-05-09 19:39:14,726 [trainer.py] => Average Accuracy (ZS harmonic): 80.43199999999999
2023-05-09 19:39:14,726 [trainer.py] => Average Accuracy (ZS total): 77.074
2023-05-09 19:39:14,728 [trainer.py] => All params: 153305089
2023-05-09 19:39:14,730 [trainer.py] => Trainable params: 2627585
2023-05-09 19:39:14,754 [memo_transformer.py] => Learning on 50-60
2023-05-09 19:39:37,978 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 19:39:37,989 [trainer.py] => CNN: {'total': 85.36, '00-09': 86.83, '10-19': 86.58, '20-29': 82.78, '30-39': 82.48, '40-49': 88.32, '50-59': 83.38, '60-69': 79.75, '70-79': 92.8, 'old': 84.3, 'new': 92.8, 'harmonic': 88.35}
2023-05-09 19:39:37,990 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-09 19:39:37,990 [trainer.py] => CNN top1 curve: [97.92, 94.87, 92.68, 91.16, 89.59, 88.03, 85.81, 85.36]
2023-05-09 19:39:37,990 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.18, 98.87, 98.39, 98.09, 97.68, 97.08]
2023-05-09 19:39:37,990 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-09 19:39:37,990 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-09 19:39:37,990 [trainer.py] => Average Accuracy (CNN): 90.6775
2023-05-09 19:39:37,990 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-09 19:39:37,990 [trainer.py] => ZS seen top1 curve: [97.82, 94.72, 92.18, 90.85, 89.24, 87.87, 85.59, 84.92]
2023-05-09 19:39:37,990 [trainer.py] => ZS unseen top1 curve: [1.38, 4.48, 7.04, 12.29, 17.65, 23.5, 26.95, 31.39]
2023-05-09 19:39:37,990 [trainer.py] => ZS harmonic top1 curve: [2.72, 8.56, 13.08, 21.65, 29.47, 37.08, 40.99, 45.84]
2023-05-09 19:39:37,990 [trainer.py] => ZS total top1 curve: [11.12, 22.5, 32.56, 43.92, 53.58, 62.28, 68.08, 74.28]
2023-05-09 19:39:37,990 [trainer.py] => Average Accuracy (ZS seen): 90.39875
2023-05-09 19:39:37,990 [trainer.py] => Average Accuracy (ZS unseen): 15.585
2023-05-09 19:39:37,990 [trainer.py] => Average Accuracy (ZS harmonic): 24.92375
2023-05-09 19:39:37,990 [trainer.py] => Average Accuracy (ZS total): 46.040000000000006
2023-05-09 19:39:37,991 [trainer.py] => All params: 154885633
2023-05-09 19:39:37,992 [trainer.py] => Trainable params: 3415553
2023-05-09 19:39:38,006 [memo_transformer.py] => Learning on 80-90
2023-05-09 19:41:45,649 [memo_transformer.py] => Task 5, Epoch 1/5 => Loss 2.016, Train_acc 88.97, Test_acc 87.03
2023-05-09 19:41:45,649 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0] 
2023-05-09 19:41:45,654 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 19:42:39,923 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 19:45:47,060 [memo_transformer.py] => Task 6, Epoch 7/5 => Loss 1.905, Train_acc 90.81, Test_acc 85.54
2023-05-09 19:45:47,084 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 19:45:47,088 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 19:46:28,615 [base.py] => Constructing exemplars...(28 per classes)
2023-05-09 19:47:04,633 [memo_transformer.py] => Task 9, Epoch 7/5 => Loss 2.204, Train_acc 93.81, Test_acc 82.78
2023-05-09 19:47:04,638 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 19:47:04,643 [base.py] => Reducing exemplars...(20 per classes)
2023-05-09 19:47:24,736 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 19:47:24,738 [trainer.py] => CNN: {'total': 87.03, '00-09': 86.34, '10-19': 86.43, '20-29': 86.22, '30-39': 86.26, '40-49': 89.33, '50-59': 87.66, 'old': 86.91, 'new': 87.66, 'harmonic': 87.28}
2023-05-09 19:47:24,738 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 19:47:24,738 [trainer.py] => CNN top1 curve: [97.97, 94.37, 92.25, 90.43, 88.55, 87.03]
2023-05-09 19:47:24,738 [trainer.py] => CNN top5 curve: [99.9, 99.52, 99.25, 98.92, 98.43, 97.99]
2023-05-09 19:47:24,738 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-09 19:47:24,738 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-09 19:47:24,739 [trainer.py] => Average Accuracy (CNN): 91.76666666666667
2023-05-09 19:47:24,739 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-09 19:47:24,739 [trainer.py] => ZS seen top1 curve: [96.73, 91.76, 87.8, 86.91, 86.11, 85.91]
2023-05-09 19:47:24,739 [trainer.py] => ZS unseen top1 curve: [61.84, 74.05, 76.26, 76.95, 77.36, 76.69]
2023-05-09 19:47:24,739 [trainer.py] => ZS harmonic top1 curve: [75.45, 81.96, 81.62, 81.63, 81.5, 81.04]
2023-05-09 19:47:24,739 [trainer.py] => ZS total top1 curve: [65.36, 77.58, 79.72, 80.96, 81.75, 82.25]
2023-05-09 19:47:24,739 [trainer.py] => Average Accuracy (ZS seen): 89.20333333333333
2023-05-09 19:47:24,739 [trainer.py] => Average Accuracy (ZS unseen): 73.85833333333333
2023-05-09 19:47:24,739 [trainer.py] => Average Accuracy (ZS harmonic): 80.53333333333333
2023-05-09 19:47:24,739 [trainer.py] => Average Accuracy (ZS total): 77.93666666666667
2023-05-09 19:47:24,740 [trainer.py] => All params: 153831937
2023-05-09 19:47:24,741 [trainer.py] => Trainable params: 2890241
2023-05-09 19:47:24,758 [memo_transformer.py] => Learning on 60-70
2023-05-09 19:48:18,552 [base.py] => Constructing exemplars...(20 per classes)
2023-05-09 19:50:06,296 [memo_transformer.py] => Task 6, Epoch 1/5 => Loss 2.359, Train_acc 85.12, Test_acc 84.45
2023-05-09 19:50:06,301 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0] 
2023-05-09 19:50:06,305 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 19:50:33,614 [memo_transformer.py] => Exemplar size: 1960
2023-05-09 19:50:33,625 [trainer.py] => CNN: {'total': 85.54, '00-09': 87.87, '10-19': 87.95, '20-29': 83.03, '30-39': 87.82, '40-49': 88.63, '50-59': 82.79, '60-69': 80.66, 'old': 86.35, 'new': 80.66, 'harmonic': 83.41}
2023-05-09 19:50:33,625 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-09 19:50:33,625 [trainer.py] => CNN top1 curve: [97.97, 94.97, 92.48, 90.52, 89.04, 87.57, 85.54]
2023-05-09 19:50:33,625 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.23, 98.88, 98.5, 98.11, 97.62]
2023-05-09 19:50:33,625 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-09 19:50:33,625 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-09 19:50:33,625 [trainer.py] => Average Accuracy (CNN): 91.15571428571427
2023-05-09 19:50:33,625 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-09 19:50:33,625 [trainer.py] => ZS seen top1 curve: [97.43, 93.44, 89.31, 88.5, 87.57, 86.38, 85.31]
2023-05-09 19:50:33,625 [trainer.py] => ZS unseen top1 curve: [58.53, 70.38, 75.26, 76.0, 75.33, 76.34, 78.6]
2023-05-09 19:50:33,626 [trainer.py] => ZS harmonic top1 curve: [73.13, 80.29, 81.69, 81.78, 80.99, 81.05, 81.82]
2023-05-09 19:50:33,626 [trainer.py] => ZS total top1 curve: [62.46, 74.98, 79.47, 81.03, 81.47, 82.39, 83.31]
2023-05-09 19:50:33,626 [trainer.py] => Average Accuracy (ZS seen): 89.7057142857143
2023-05-09 19:50:33,626 [trainer.py] => Average Accuracy (ZS unseen): 72.92
2023-05-09 19:50:33,626 [trainer.py] => Average Accuracy (ZS harmonic): 80.10714285714286
2023-05-09 19:50:33,626 [trainer.py] => Average Accuracy (ZS total): 77.87285714285713
2023-05-09 19:50:33,627 [trainer.py] => All params: 154358785
2023-05-09 19:50:33,628 [trainer.py] => Trainable params: 3152897
2023-05-09 19:50:33,641 [memo_transformer.py] => Learning on 70-80
2023-05-09 19:51:05,460 [base.py] => Constructing exemplars...(28 per classes)
2023-05-09 19:54:11,536 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 19:54:11,536 [trainer.py] => CNN: {'total': 82.78, '00-09': 85.54, '10-19': 85.57, '20-29': 80.88, '30-39': 81.36, '40-49': 85.71, '50-59': 81.34, '60-69': 73.94, '70-79': 86.01, '80-89': 85.04, '90-99': 82.41, 'old': 82.82, 'new': 82.41, 'harmonic': 82.61}
2023-05-09 19:54:11,537 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-09 19:54:11,537 [trainer.py] => CNN top1 curve: [97.87, 94.52, 92.25, 90.73, 89.27, 87.62, 85.17, 84.63, 84.05, 82.78]
2023-05-09 19:54:11,537 [trainer.py] => CNN top5 curve: [99.85, 99.42, 99.23, 98.85, 98.44, 98.16, 97.61, 97.12, 96.98, 96.46]
2023-05-09 19:54:11,537 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-09 19:54:11,537 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-09 19:54:11,537 [trainer.py] => Average Accuracy (CNN): 88.88899999999998
2023-05-09 19:54:11,537 [trainer.py] => Average Accuracy (NME): 87.828
2023-05-09 19:54:11,537 [trainer.py] => ZS seen top1 curve: [97.77, 94.44, 91.7, 90.53, 88.64, 86.63, 84.17, 83.49, 83.01, 81.6]
2023-05-09 19:54:11,537 [trainer.py] => ZS unseen top1 curve: [0.58, 1.87, 4.0, 8.72, 14.22, 21.1, 21.6, 26.74, 30.85, 0]
2023-05-09 19:54:11,537 [trainer.py] => ZS harmonic top1 curve: [1.15, 3.67, 7.67, 15.91, 24.51, 33.93, 34.38, 40.51, 44.98, 0.0]
2023-05-09 19:54:11,537 [trainer.py] => ZS total top1 curve: [10.39, 20.35, 30.28, 41.66, 51.57, 60.57, 65.48, 72.21, 77.84, 81.6]
2023-05-09 19:54:11,537 [trainer.py] => Average Accuracy (ZS seen): 88.198
2023-05-09 19:54:11,537 [trainer.py] => Average Accuracy (ZS unseen): 12.968
2023-05-09 19:54:11,537 [trainer.py] => Average Accuracy (ZS harmonic): 20.671
2023-05-09 19:54:11,538 [trainer.py] => Average Accuracy (ZS total): 51.19500000000001
2023-05-09 19:54:57,428 [trainer.py] => config: ././exp5_mlp//food101/food101_memo_transformer_clip_7_0.002_64_0.005.json
2023-05-09 19:54:57,429 [trainer.py] => prefix: reproduce
2023-05-09 19:54:57,429 [trainer.py] => dataset: food101
2023-05-09 19:54:57,429 [trainer.py] => memory_size: 2000
2023-05-09 19:54:57,429 [trainer.py] => memory_per_class: 20
2023-05-09 19:54:57,429 [trainer.py] => fixed_memory: False
2023-05-09 19:54:57,429 [trainer.py] => shuffle: True
2023-05-09 19:54:57,429 [trainer.py] => init_cls: 10
2023-05-09 19:54:57,429 [trainer.py] => increment: 10
2023-05-09 19:54:57,429 [trainer.py] => model_name: memo_transformer
2023-05-09 19:54:57,429 [trainer.py] => convnet_type: clip
2023-05-09 19:54:57,429 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 19:54:57,430 [trainer.py] => seed: 1993
2023-05-09 19:54:57,430 [trainer.py] => projection_type: mlp
2023-05-09 19:54:57,430 [trainer.py] => fusion_choice: transformer
2023-05-09 19:54:57,430 [trainer.py] => split_train: False
2023-05-09 19:54:57,430 [trainer.py] => tsne_option: False
2023-05-09 19:54:57,430 [trainer.py] => laion_check: False
2023-05-09 19:54:57,430 [trainer.py] => train_tasks: 999
2023-05-09 19:54:57,430 [trainer.py] => frozen_layers: visual
2023-05-09 19:54:57,430 [trainer.py] => tuned_epoch: 5
2023-05-09 19:54:57,430 [trainer.py] => first_epoch: 7
2023-05-09 19:54:57,430 [trainer.py] => init_lr: 0.002
2023-05-09 19:54:57,430 [trainer.py] => batch_size: 64
2023-05-09 19:54:57,430 [trainer.py] => weight_decay: 0.005
2023-05-09 19:54:57,430 [trainer.py] => min_lr: 0
2023-05-09 19:54:57,430 [trainer.py] => optimizer: sgd
2023-05-09 19:54:58,007 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 19:55:57,351 [instantiator.py] => Created a temporary directory at /tmp/tmplnji_u9z
2023-05-09 19:55:57,352 [instantiator.py] => Writing /tmp/tmplnji_u9z/_remote_module_non_sriptable.py
2023-05-09 19:55:59,333 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 19:56:01,075 [memo_transformer.py] => Exemplar size: 1960
2023-05-09 19:56:01,075 [trainer.py] => CNN: {'total': 84.45, '00-09': 84.46, '10-19': 85.97, '20-29': 82.88, '30-39': 85.53, '40-49': 87.37, '50-59': 83.13, '60-69': 81.82, 'old': 84.89, 'new': 81.82, 'harmonic': 83.33}
2023-05-09 19:56:01,075 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-09 19:56:01,075 [trainer.py] => CNN top1 curve: [97.97, 94.37, 92.25, 90.43, 88.55, 87.03, 84.45]
2023-05-09 19:56:01,075 [trainer.py] => CNN top5 curve: [99.9, 99.52, 99.25, 98.92, 98.43, 97.99, 97.41]
2023-05-09 19:56:01,076 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-09 19:56:01,076 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-09 19:56:01,076 [trainer.py] => Average Accuracy (CNN): 90.72142857142858
2023-05-09 19:56:01,076 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-09 19:56:01,076 [trainer.py] => ZS seen top1 curve: [96.73, 91.76, 87.8, 86.91, 86.11, 85.91, 84.6]
2023-05-09 19:56:01,076 [trainer.py] => ZS unseen top1 curve: [61.84, 74.05, 76.26, 76.95, 77.36, 76.69, 79.09]
2023-05-09 19:56:01,076 [trainer.py] => ZS harmonic top1 curve: [75.45, 81.96, 81.62, 81.63, 81.5, 81.04, 81.75]
2023-05-09 19:56:01,076 [trainer.py] => ZS total top1 curve: [65.36, 77.58, 79.72, 80.96, 81.75, 82.25, 82.95]
2023-05-09 19:56:01,076 [trainer.py] => Average Accuracy (ZS seen): 88.5457142857143
2023-05-09 19:56:01,076 [trainer.py] => Average Accuracy (ZS unseen): 74.60571428571428
2023-05-09 19:56:01,076 [trainer.py] => Average Accuracy (ZS harmonic): 80.70714285714287
2023-05-09 19:56:01,076 [trainer.py] => Average Accuracy (ZS total): 78.65285714285714
2023-05-09 19:56:01,077 [trainer.py] => All params: 154358785
2023-05-09 19:56:01,078 [trainer.py] => Trainable params: 3152897
2023-05-09 19:56:01,089 [memo_transformer.py] => Learning on 70-80
2023-05-09 19:56:03,088 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 19:56:03,526 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 19:56:07,045 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 19:56:08,164 [trainer.py] => All params: 150670849
2023-05-09 19:56:08,165 [trainer.py] => Trainable params: 150670849
2023-05-09 19:56:15,921 [memo_transformer.py] => Learning on 0-10
2023-05-09 19:56:46,844 [memo_transformer.py] => Task 8, Epoch 7/5 => Loss 1.348, Train_acc 97.76, Test_acc 84.86
2023-05-09 19:56:46,850 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 19:56:46,854 [base.py] => Reducing exemplars...(22 per classes)
2023-05-09 19:57:35,598 [base.py] => Constructing exemplars...(22 per classes)
2023-05-09 19:58:49,468 [memo_transformer.py] => Task 7, Epoch 1/5 => Loss 1.970, Train_acc 89.69, Test_acc 84.27
2023-05-09 19:58:49,472 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 19:58:49,472 [base.py] => Reducing exemplars...(25 per classes)
2023-05-09 19:59:45,345 [base.py] => Constructing exemplars...(25 per classes)
2023-05-09 20:02:36,812 [memo_transformer.py] => Task 0, Epoch 7/5 => Loss 2.242, Train_acc 98.31, Test_acc 97.82
2023-05-09 20:02:36,813 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:02:36,813 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 20:02:36,814 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 20:02:42,710 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 20:02:42,715 [trainer.py] => CNN: {'total': 84.86, '00-09': 87.08, '10-19': 85.16, '20-29': 84.47, '30-39': 81.89, '40-49': 86.11, '50-59': 82.59, '60-69': 76.97, '70-79': 86.91, '80-89': 92.57, 'old': 83.9, 'new': 92.57, 'harmonic': 88.02}
2023-05-09 20:02:42,715 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-09 20:02:42,715 [trainer.py] => CNN top1 curve: [97.92, 94.87, 92.68, 91.16, 89.59, 88.03, 85.81, 85.36, 84.86]
2023-05-09 20:02:42,715 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.18, 98.87, 98.39, 98.09, 97.68, 97.08, 96.89]
2023-05-09 20:02:42,715 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-09 20:02:42,715 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-09 20:02:42,715 [trainer.py] => Average Accuracy (CNN): 90.0311111111111
2023-05-09 20:02:42,715 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-09 20:02:42,715 [trainer.py] => ZS seen top1 curve: [97.82, 94.72, 92.18, 90.85, 89.24, 87.87, 85.59, 84.92, 84.47]
2023-05-09 20:02:42,715 [trainer.py] => ZS unseen top1 curve: [1.38, 4.48, 7.04, 12.29, 17.65, 23.5, 26.95, 31.39, 31.55]
2023-05-09 20:02:42,715 [trainer.py] => ZS harmonic top1 curve: [2.72, 8.56, 13.08, 21.65, 29.47, 37.08, 40.99, 45.84, 45.94]
2023-05-09 20:02:42,715 [trainer.py] => ZS total top1 curve: [11.12, 22.5, 32.56, 43.92, 53.58, 62.28, 68.08, 74.28, 79.22]
2023-05-09 20:02:42,716 [trainer.py] => Average Accuracy (ZS seen): 89.74000000000001
2023-05-09 20:02:42,716 [trainer.py] => Average Accuracy (ZS unseen): 17.35888888888889
2023-05-09 20:02:42,716 [trainer.py] => Average Accuracy (ZS harmonic): 27.258888888888887
2023-05-09 20:02:42,716 [trainer.py] => Average Accuracy (ZS total): 49.726666666666674
2023-05-09 20:02:42,717 [trainer.py] => All params: 155412481
2023-05-09 20:02:42,718 [trainer.py] => Trainable params: 3678209
2023-05-09 20:02:42,731 [memo_transformer.py] => Learning on 90-100
2023-05-09 20:04:20,359 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 20:04:20,377 [trainer.py] => CNN: {'total': 84.27, '00-09': 84.55, '10-19': 84.66, '20-29': 82.13, '30-39': 83.3, '40-49': 87.27, '50-59': 82.84, '60-69': 81.52, '70-79': 87.91, 'old': 83.75, 'new': 87.91, 'harmonic': 85.78}
2023-05-09 20:04:20,377 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-09 20:04:20,377 [trainer.py] => CNN top1 curve: [97.97, 94.37, 92.25, 90.43, 88.55, 87.03, 84.45, 84.27]
2023-05-09 20:04:20,377 [trainer.py] => CNN top5 curve: [99.9, 99.52, 99.25, 98.92, 98.43, 97.99, 97.41, 96.99]
2023-05-09 20:04:20,377 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-09 20:04:20,377 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-09 20:04:20,378 [trainer.py] => Average Accuracy (CNN): 89.915
2023-05-09 20:04:20,378 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-09 20:04:20,378 [trainer.py] => ZS seen top1 curve: [96.73, 91.76, 87.8, 86.91, 86.11, 85.91, 84.6, 84.67]
2023-05-09 20:04:20,378 [trainer.py] => ZS unseen top1 curve: [61.84, 74.05, 76.26, 76.95, 77.36, 76.69, 79.09, 77.34]
2023-05-09 20:04:20,378 [trainer.py] => ZS harmonic top1 curve: [75.45, 81.96, 81.62, 81.63, 81.5, 81.04, 81.75, 80.84]
2023-05-09 20:04:20,378 [trainer.py] => ZS total top1 curve: [65.36, 77.58, 79.72, 80.96, 81.75, 82.25, 82.95, 83.22]
2023-05-09 20:04:20,378 [trainer.py] => Average Accuracy (ZS seen): 88.06125
2023-05-09 20:04:20,378 [trainer.py] => Average Accuracy (ZS unseen): 74.9475
2023-05-09 20:04:20,378 [trainer.py] => Average Accuracy (ZS harmonic): 80.72375000000001
2023-05-09 20:04:20,378 [trainer.py] => Average Accuracy (ZS total): 79.22375000000001
2023-05-09 20:04:20,379 [trainer.py] => All params: 154885633
2023-05-09 20:04:20,380 [trainer.py] => Trainable params: 3415553
2023-05-09 20:04:20,394 [memo_transformer.py] => Learning on 80-90
2023-05-09 20:05:29,777 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 20:05:29,778 [trainer.py] => CNN: {'total': 97.82, '00-09': 97.82, 'old': 0, 'new': 97.82, 'harmonic': 0.0}
2023-05-09 20:05:29,778 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 20:05:29,778 [trainer.py] => CNN top1 curve: [97.82]
2023-05-09 20:05:29,778 [trainer.py] => CNN top5 curve: [99.95]
2023-05-09 20:05:29,778 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 20:05:29,778 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 20:05:29,779 [trainer.py] => Average Accuracy (CNN): 97.82
2023-05-09 20:05:29,779 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 20:05:29,779 [trainer.py] => ZS seen top1 curve: [96.68]
2023-05-09 20:05:29,779 [trainer.py] => ZS unseen top1 curve: [65.32]
2023-05-09 20:05:29,779 [trainer.py] => ZS harmonic top1 curve: [77.96]
2023-05-09 20:05:29,779 [trainer.py] => ZS total top1 curve: [68.49]
2023-05-09 20:05:29,779 [trainer.py] => Average Accuracy (ZS seen): 96.68
2023-05-09 20:05:29,779 [trainer.py] => Average Accuracy (ZS unseen): 65.32
2023-05-09 20:05:29,779 [trainer.py] => Average Accuracy (ZS harmonic): 77.96
2023-05-09 20:05:29,779 [trainer.py] => Average Accuracy (ZS total): 68.49
2023-05-09 20:05:29,780 [trainer.py] => All params: 151197697
2023-05-09 20:05:29,781 [trainer.py] => Trainable params: 1576961
2023-05-09 20:05:29,796 [memo_transformer.py] => Learning on 10-20
2023-05-09 20:06:08,765 [memo_transformer.py] => Task 7, Epoch 7/5 => Loss 1.629, Train_acc 94.20, Test_acc 85.07
2023-05-09 20:06:08,767 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:06:08,771 [base.py] => Reducing exemplars...(25 per classes)
2023-05-09 20:06:50,203 [base.py] => Constructing exemplars...(25 per classes)
2023-05-09 20:07:18,854 [memo_transformer.py] => Task 8, Epoch 1/5 => Loss 2.000, Train_acc 89.52, Test_acc 84.08
2023-05-09 20:07:18,872 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:07:18,873 [base.py] => Reducing exemplars...(22 per classes)
2023-05-09 20:08:21,100 [base.py] => Constructing exemplars...(22 per classes)
2023-05-09 20:11:34,234 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 20:11:34,265 [trainer.py] => CNN: {'total': 85.07, '00-09': 87.72, '10-19': 87.34, '20-29': 82.78, '30-39': 85.87, '40-49': 88.27, '50-59': 82.49, '60-69': 79.14, '70-79': 86.91, 'old': 84.81, 'new': 86.91, 'harmonic': 85.85}
2023-05-09 20:11:34,265 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-09 20:11:34,265 [trainer.py] => CNN top1 curve: [97.97, 94.97, 92.48, 90.52, 89.04, 87.57, 85.54, 85.07]
2023-05-09 20:11:34,265 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.23, 98.88, 98.5, 98.11, 97.62, 97.31]
2023-05-09 20:11:34,265 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-09 20:11:34,265 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-09 20:11:34,266 [trainer.py] => Average Accuracy (CNN): 90.39499999999998
2023-05-09 20:11:34,266 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-09 20:11:34,266 [trainer.py] => ZS seen top1 curve: [97.43, 93.44, 89.31, 88.5, 87.57, 86.38, 85.31, 85.18]
2023-05-09 20:11:34,266 [trainer.py] => ZS unseen top1 curve: [58.53, 70.38, 75.26, 76.0, 75.33, 76.34, 78.6, 76.84]
2023-05-09 20:11:34,266 [trainer.py] => ZS harmonic top1 curve: [73.13, 80.29, 81.69, 81.78, 80.99, 81.05, 81.82, 80.8]
2023-05-09 20:11:34,266 [trainer.py] => ZS total top1 curve: [62.46, 74.98, 79.47, 81.03, 81.47, 82.39, 83.31, 83.52]
2023-05-09 20:11:34,266 [trainer.py] => Average Accuracy (ZS seen): 89.14000000000001
2023-05-09 20:11:34,266 [trainer.py] => Average Accuracy (ZS unseen): 73.41000000000001
2023-05-09 20:11:34,266 [trainer.py] => Average Accuracy (ZS harmonic): 80.19375
2023-05-09 20:11:34,266 [trainer.py] => Average Accuracy (ZS total): 78.57874999999999
2023-05-09 20:11:34,268 [trainer.py] => All params: 154885633
2023-05-09 20:11:34,269 [trainer.py] => Trainable params: 3415553
2023-05-09 20:11:34,287 [memo_transformer.py] => Learning on 80-90
2023-05-09 20:13:44,652 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 20:13:44,654 [trainer.py] => CNN: {'total': 84.08, '00-09': 84.41, '10-19': 84.66, '20-29': 83.57, '30-39': 82.72, '40-49': 85.96, '50-59': 82.44, '60-69': 77.07, '70-79': 87.51, '80-89': 88.4, 'old': 83.54, 'new': 88.4, 'harmonic': 85.9}
2023-05-09 20:13:44,654 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-09 20:13:44,654 [trainer.py] => CNN top1 curve: [97.97, 94.37, 92.25, 90.43, 88.55, 87.03, 84.45, 84.27, 84.08]
2023-05-09 20:13:44,654 [trainer.py] => CNN top5 curve: [99.9, 99.52, 99.25, 98.92, 98.43, 97.99, 97.41, 96.99, 96.81]
2023-05-09 20:13:44,654 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-09 20:13:44,654 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-09 20:13:44,655 [trainer.py] => Average Accuracy (CNN): 89.26666666666668
2023-05-09 20:13:44,655 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-09 20:13:44,655 [trainer.py] => ZS seen top1 curve: [96.73, 91.76, 87.8, 86.91, 86.11, 85.91, 84.6, 84.67, 84.52]
2023-05-09 20:13:44,655 [trainer.py] => ZS unseen top1 curve: [61.84, 74.05, 76.26, 76.95, 77.36, 76.69, 79.09, 77.34, 74.14]
2023-05-09 20:13:44,655 [trainer.py] => ZS harmonic top1 curve: [75.45, 81.96, 81.62, 81.63, 81.5, 81.04, 81.75, 80.84, 78.99]
2023-05-09 20:13:44,655 [trainer.py] => ZS total top1 curve: [65.36, 77.58, 79.72, 80.96, 81.75, 82.25, 82.95, 83.22, 83.49]
2023-05-09 20:13:44,655 [trainer.py] => Average Accuracy (ZS seen): 87.66777777777777
2023-05-09 20:13:44,655 [trainer.py] => Average Accuracy (ZS unseen): 74.85777777777778
2023-05-09 20:13:44,655 [trainer.py] => Average Accuracy (ZS harmonic): 80.53111111111112
2023-05-09 20:13:44,656 [trainer.py] => Average Accuracy (ZS total): 79.69777777777779
2023-05-09 20:13:44,657 [trainer.py] => All params: 155412481
2023-05-09 20:13:44,658 [trainer.py] => Trainable params: 3678209
2023-05-09 20:13:44,674 [memo_transformer.py] => Learning on 90-100
2023-05-09 20:14:06,040 [memo_transformer.py] => Task 1, Epoch 7/5 => Loss 2.192, Train_acc 94.64, Test_acc 94.44
2023-05-09 20:14:06,041 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:14:06,042 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 20:14:26,641 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 20:16:54,431 [memo_transformer.py] => Task 9, Epoch 1/5 => Loss 2.190, Train_acc 87.34, Test_acc 82.31
2023-05-09 20:16:54,463 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:16:54,463 [base.py] => Reducing exemplars...(20 per classes)
2023-05-09 20:17:34,154 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 20:17:34,161 [trainer.py] => CNN: {'total': 94.44, '00-09': 96.04, '10-19': 92.81, 'old': 96.04, 'new': 92.81, 'harmonic': 94.4}
2023-05-09 20:17:34,161 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 20:17:34,161 [trainer.py] => CNN top1 curve: [97.82, 94.44]
2023-05-09 20:17:34,161 [trainer.py] => CNN top5 curve: [99.95, 99.47]
2023-05-09 20:17:34,161 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 20:17:34,161 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 20:17:34,161 [trainer.py] => Average Accuracy (CNN): 96.13
2023-05-09 20:17:34,161 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 20:17:34,162 [trainer.py] => ZS seen top1 curve: [96.68, 92.07]
2023-05-09 20:17:34,162 [trainer.py] => ZS unseen top1 curve: [65.32, 74.04]
2023-05-09 20:17:34,162 [trainer.py] => ZS harmonic top1 curve: [77.96, 82.08]
2023-05-09 20:17:34,162 [trainer.py] => ZS total top1 curve: [68.49, 77.64]
2023-05-09 20:17:34,162 [trainer.py] => Average Accuracy (ZS seen): 94.375
2023-05-09 20:17:34,162 [trainer.py] => Average Accuracy (ZS unseen): 69.68
2023-05-09 20:17:34,162 [trainer.py] => Average Accuracy (ZS harmonic): 80.02
2023-05-09 20:17:34,162 [trainer.py] => Average Accuracy (ZS total): 73.065
2023-05-09 20:17:34,163 [trainer.py] => All params: 151724545
2023-05-09 20:17:34,164 [trainer.py] => Trainable params: 1839617
2023-05-09 20:17:34,177 [memo_transformer.py] => Learning on 20-30
2023-05-09 20:17:59,328 [base.py] => Constructing exemplars...(20 per classes)
2023-05-09 20:21:08,853 [memo_transformer.py] => Task 9, Epoch 7/5 => Loss 1.436, Train_acc 96.81, Test_acc 83.24
2023-05-09 20:21:08,882 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:21:08,886 [base.py] => Reducing exemplars...(20 per classes)
2023-05-09 20:22:07,022 [base.py] => Constructing exemplars...(20 per classes)
2023-05-09 20:23:20,978 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 20:23:20,980 [trainer.py] => CNN: {'total': 82.31, '00-09': 84.7, '10-19': 84.1, '20-29': 80.13, '30-39': 81.17, '40-49': 85.2, '50-59': 81.64, '60-69': 75.35, '70-79': 84.51, '80-89': 87.45, '90-99': 78.78, 'old': 82.69, 'new': 78.78, 'harmonic': 80.69}
2023-05-09 20:23:20,980 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-09 20:23:20,980 [trainer.py] => CNN top1 curve: [97.97, 94.37, 92.25, 90.43, 88.55, 87.03, 84.45, 84.27, 84.08, 82.31]
2023-05-09 20:23:20,980 [trainer.py] => CNN top5 curve: [99.9, 99.52, 99.25, 98.92, 98.43, 97.99, 97.41, 96.99, 96.81, 96.38]
2023-05-09 20:23:20,980 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-09 20:23:20,980 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-09 20:23:20,981 [trainer.py] => Average Accuracy (CNN): 88.571
2023-05-09 20:23:20,981 [trainer.py] => Average Accuracy (NME): 87.828
2023-05-09 20:23:20,981 [trainer.py] => ZS seen top1 curve: [96.73, 91.76, 87.8, 86.91, 86.11, 85.91, 84.6, 84.67, 84.52, 83.61]
2023-05-09 20:23:20,981 [trainer.py] => ZS unseen top1 curve: [61.84, 74.05, 76.26, 76.95, 77.36, 76.69, 79.09, 77.34, 74.14, 0]
2023-05-09 20:23:20,981 [trainer.py] => ZS harmonic top1 curve: [75.45, 81.96, 81.62, 81.63, 81.5, 81.04, 81.75, 80.84, 78.99, 0.0]
2023-05-09 20:23:20,981 [trainer.py] => ZS total top1 curve: [65.36, 77.58, 79.72, 80.96, 81.75, 82.25, 82.95, 83.22, 83.49, 83.61]
2023-05-09 20:23:20,981 [trainer.py] => Average Accuracy (ZS seen): 87.262
2023-05-09 20:23:20,981 [trainer.py] => Average Accuracy (ZS unseen): 67.372
2023-05-09 20:23:20,981 [trainer.py] => Average Accuracy (ZS harmonic): 72.47800000000001
2023-05-09 20:23:20,981 [trainer.py] => Average Accuracy (ZS total): 80.08900000000001
2023-05-09 20:23:59,365 [trainer.py] => config: ././exp5_pure_mlp//food101/food101_memo_transformer_clip_7_0.002_64_0.005.json
2023-05-09 20:23:59,376 [trainer.py] => prefix: reproduce
2023-05-09 20:23:59,376 [trainer.py] => dataset: food101
2023-05-09 20:23:59,376 [trainer.py] => memory_size: 2000
2023-05-09 20:23:59,376 [trainer.py] => memory_per_class: 20
2023-05-09 20:23:59,376 [trainer.py] => fixed_memory: False
2023-05-09 20:23:59,376 [trainer.py] => shuffle: True
2023-05-09 20:23:59,376 [trainer.py] => init_cls: 10
2023-05-09 20:23:59,376 [trainer.py] => increment: 10
2023-05-09 20:23:59,376 [trainer.py] => model_name: memo_transformer
2023-05-09 20:23:59,376 [trainer.py] => convnet_type: clip
2023-05-09 20:23:59,376 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 20:23:59,377 [trainer.py] => seed: 1993
2023-05-09 20:23:59,377 [trainer.py] => projection_type: pure_mlp
2023-05-09 20:23:59,377 [trainer.py] => fusion_choice: transformer
2023-05-09 20:23:59,377 [trainer.py] => split_train: False
2023-05-09 20:23:59,377 [trainer.py] => tsne_option: False
2023-05-09 20:23:59,377 [trainer.py] => laion_check: False
2023-05-09 20:23:59,377 [trainer.py] => train_tasks: 999
2023-05-09 20:23:59,377 [trainer.py] => frozen_layers: visual
2023-05-09 20:23:59,377 [trainer.py] => tuned_epoch: 5
2023-05-09 20:23:59,377 [trainer.py] => first_epoch: 7
2023-05-09 20:23:59,377 [trainer.py] => init_lr: 0.002
2023-05-09 20:23:59,377 [trainer.py] => batch_size: 64
2023-05-09 20:23:59,377 [trainer.py] => weight_decay: 0.005
2023-05-09 20:23:59,377 [trainer.py] => min_lr: 0
2023-05-09 20:23:59,377 [trainer.py] => optimizer: sgd
2023-05-09 20:23:59,858 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 20:24:49,116 [instantiator.py] => Created a temporary directory at /tmp/tmpdkq6orol
2023-05-09 20:24:49,117 [instantiator.py] => Writing /tmp/tmpdkq6orol/_remote_module_non_sriptable.py
2023-05-09 20:24:50,540 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 20:24:54,554 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 20:24:55,015 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 20:24:58,158 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 20:24:58,822 [trainer.py] => All params: 150670849
2023-05-09 20:24:58,823 [trainer.py] => Trainable params: 150670849
2023-05-09 20:25:05,054 [memo_transformer.py] => Learning on 0-10
2023-05-09 20:27:15,087 [memo_transformer.py] => Task 2, Epoch 7/5 => Loss 2.161, Train_acc 93.48, Test_acc 92.43
2023-05-09 20:27:15,102 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:27:15,102 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 20:27:33,065 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 20:27:33,075 [trainer.py] => CNN: {'total': 83.24, '00-09': 85.1, '10-19': 85.22, '20-29': 79.58, '30-39': 81.55, '40-49': 85.15, '50-59': 80.4, '60-69': 74.39, '70-79': 85.61, '80-89': 86.95, '90-99': 88.46, 'old': 82.66, 'new': 88.46, 'harmonic': 85.46}
2023-05-09 20:27:33,075 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-09 20:27:33,075 [trainer.py] => CNN top1 curve: [97.92, 94.87, 92.68, 91.16, 89.59, 88.03, 85.81, 85.36, 84.86, 83.24]
2023-05-09 20:27:33,076 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.18, 98.87, 98.39, 98.09, 97.68, 97.08, 96.89, 96.44]
2023-05-09 20:27:33,076 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-09 20:27:33,076 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-09 20:27:33,076 [trainer.py] => Average Accuracy (CNN): 89.352
2023-05-09 20:27:33,076 [trainer.py] => Average Accuracy (NME): 87.828
2023-05-09 20:27:33,076 [trainer.py] => ZS seen top1 curve: [97.82, 94.72, 92.18, 90.85, 89.24, 87.87, 85.59, 84.92, 84.47, 82.87]
2023-05-09 20:27:33,076 [trainer.py] => ZS unseen top1 curve: [1.38, 4.48, 7.04, 12.29, 17.65, 23.5, 26.95, 31.39, 31.55, 0]
2023-05-09 20:27:33,076 [trainer.py] => ZS harmonic top1 curve: [2.72, 8.56, 13.08, 21.65, 29.47, 37.08, 40.99, 45.84, 45.94, 0.0]
2023-05-09 20:27:33,076 [trainer.py] => ZS total top1 curve: [11.12, 22.5, 32.56, 43.92, 53.58, 62.28, 68.08, 74.28, 79.22, 82.87]
2023-05-09 20:27:33,076 [trainer.py] => Average Accuracy (ZS seen): 89.05300000000001
2023-05-09 20:27:33,076 [trainer.py] => Average Accuracy (ZS unseen): 15.623000000000001
2023-05-09 20:27:33,076 [trainer.py] => Average Accuracy (ZS harmonic): 24.532999999999998
2023-05-09 20:27:33,076 [trainer.py] => Average Accuracy (ZS total): 53.04100000000001
2023-05-09 20:27:45,219 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 20:28:14,377 [trainer.py] => config: ././exp5_mlp//food101/food101_memo_transformer_clip_7_0.002_48_0.05.json
2023-05-09 20:28:14,382 [trainer.py] => prefix: reproduce
2023-05-09 20:28:14,382 [trainer.py] => dataset: food101
2023-05-09 20:28:14,382 [trainer.py] => memory_size: 2000
2023-05-09 20:28:14,382 [trainer.py] => memory_per_class: 20
2023-05-09 20:28:14,382 [trainer.py] => fixed_memory: False
2023-05-09 20:28:14,382 [trainer.py] => shuffle: True
2023-05-09 20:28:14,382 [trainer.py] => init_cls: 10
2023-05-09 20:28:14,382 [trainer.py] => increment: 10
2023-05-09 20:28:14,382 [trainer.py] => model_name: memo_transformer
2023-05-09 20:28:14,382 [trainer.py] => convnet_type: clip
2023-05-09 20:28:14,386 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 20:28:14,386 [trainer.py] => seed: 1993
2023-05-09 20:28:14,386 [trainer.py] => projection_type: mlp
2023-05-09 20:28:14,386 [trainer.py] => fusion_choice: transformer
2023-05-09 20:28:14,386 [trainer.py] => split_train: False
2023-05-09 20:28:14,386 [trainer.py] => tsne_option: False
2023-05-09 20:28:14,386 [trainer.py] => laion_check: False
2023-05-09 20:28:14,386 [trainer.py] => train_tasks: 999
2023-05-09 20:28:14,386 [trainer.py] => frozen_layers: visual
2023-05-09 20:28:14,386 [trainer.py] => tuned_epoch: 5
2023-05-09 20:28:14,386 [trainer.py] => first_epoch: 7
2023-05-09 20:28:14,386 [trainer.py] => init_lr: 0.002
2023-05-09 20:28:14,386 [trainer.py] => batch_size: 48
2023-05-09 20:28:14,386 [trainer.py] => weight_decay: 0.05
2023-05-09 20:28:14,386 [trainer.py] => min_lr: 0
2023-05-09 20:28:14,386 [trainer.py] => optimizer: sgd
2023-05-09 20:28:14,873 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 20:28:20,770 [memo_transformer.py] => Task 8, Epoch 7/5 => Loss 1.645, Train_acc 93.85, Test_acc 84.82
2023-05-09 20:28:20,872 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:28:20,879 [base.py] => Reducing exemplars...(22 per classes)
2023-05-09 20:29:07,518 [instantiator.py] => Created a temporary directory at /tmp/tmpaeo_9sje
2023-05-09 20:29:07,519 [instantiator.py] => Writing /tmp/tmpaeo_9sje/_remote_module_non_sriptable.py
2023-05-09 20:29:09,196 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 20:29:12,712 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 20:29:13,167 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 20:29:15,756 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 20:29:16,255 [trainer.py] => All params: 150670849
2023-05-09 20:29:16,256 [trainer.py] => Trainable params: 150670849
2023-05-09 20:29:22,326 [base.py] => Constructing exemplars...(22 per classes)
2023-05-09 20:29:23,003 [memo_transformer.py] => Learning on 0-10
2023-05-09 20:31:18,907 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 20:31:18,912 [trainer.py] => CNN: {'total': 92.43, '00-09': 94.11, '10-19': 92.3, '20-29': 90.86, 'old': 93.22, 'new': 90.86, 'harmonic': 92.02}
2023-05-09 20:31:18,913 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 20:31:18,913 [trainer.py] => CNN top1 curve: [97.82, 94.44, 92.43]
2023-05-09 20:31:18,913 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27]
2023-05-09 20:31:18,913 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 20:31:18,913 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 20:31:18,914 [trainer.py] => Average Accuracy (CNN): 94.89666666666666
2023-05-09 20:31:18,914 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 20:31:18,914 [trainer.py] => ZS seen top1 curve: [96.68, 92.07, 88.08]
2023-05-09 20:31:18,914 [trainer.py] => ZS unseen top1 curve: [65.32, 74.04, 77.41]
2023-05-09 20:31:18,914 [trainer.py] => ZS harmonic top1 curve: [77.96, 82.08, 82.4]
2023-05-09 20:31:18,914 [trainer.py] => ZS total top1 curve: [68.49, 77.64, 80.61]
2023-05-09 20:31:18,914 [trainer.py] => Average Accuracy (ZS seen): 92.27666666666666
2023-05-09 20:31:18,914 [trainer.py] => Average Accuracy (ZS unseen): 72.25666666666667
2023-05-09 20:31:18,914 [trainer.py] => Average Accuracy (ZS harmonic): 80.81333333333333
2023-05-09 20:31:18,914 [trainer.py] => Average Accuracy (ZS total): 75.58
2023-05-09 20:31:18,916 [trainer.py] => All params: 152251393
2023-05-09 20:31:18,917 [trainer.py] => Trainable params: 2102273
2023-05-09 20:31:18,931 [memo_transformer.py] => Learning on 30-40
2023-05-09 20:31:31,415 [memo_transformer.py] => Task 0, Epoch 7/5 => Loss 2.178, Train_acc 98.37, Test_acc 97.82
2023-05-09 20:31:31,415 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:31:31,416 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 20:31:31,417 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 20:34:16,989 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 20:34:17,018 [trainer.py] => CNN: {'total': 84.82, '00-09': 87.57, '10-19': 86.03, '20-29': 83.42, '30-39': 85.0, '40-49': 86.41, '50-59': 83.08, '60-69': 77.47, '70-79': 85.86, '80-89': 88.45, 'old': 84.37, 'new': 88.45, 'harmonic': 86.36}
2023-05-09 20:34:17,019 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-09 20:34:17,019 [trainer.py] => CNN top1 curve: [97.97, 94.97, 92.48, 90.52, 89.04, 87.57, 85.54, 85.07, 84.82]
2023-05-09 20:34:17,019 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.23, 98.88, 98.5, 98.11, 97.62, 97.31, 97.12]
2023-05-09 20:34:17,019 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-09 20:34:17,019 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-09 20:34:17,019 [trainer.py] => Average Accuracy (CNN): 89.77555555555553
2023-05-09 20:34:17,019 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-09 20:34:17,019 [trainer.py] => ZS seen top1 curve: [97.43, 93.44, 89.31, 88.5, 87.57, 86.38, 85.31, 85.18, 85.08]
2023-05-09 20:34:17,019 [trainer.py] => ZS unseen top1 curve: [58.53, 70.38, 75.26, 76.0, 75.33, 76.34, 78.6, 76.84, 74.55]
2023-05-09 20:34:17,019 [trainer.py] => ZS harmonic top1 curve: [73.13, 80.29, 81.69, 81.78, 80.99, 81.05, 81.82, 80.8, 79.47]
2023-05-09 20:34:17,019 [trainer.py] => ZS total top1 curve: [62.46, 74.98, 79.47, 81.03, 81.47, 82.39, 83.31, 83.52, 84.04]
2023-05-09 20:34:17,019 [trainer.py] => Average Accuracy (ZS seen): 88.68888888888891
2023-05-09 20:34:17,019 [trainer.py] => Average Accuracy (ZS unseen): 73.53666666666668
2023-05-09 20:34:17,019 [trainer.py] => Average Accuracy (ZS harmonic): 80.11333333333333
2023-05-09 20:34:17,019 [trainer.py] => Average Accuracy (ZS total): 79.18555555555554
2023-05-09 20:34:17,020 [trainer.py] => All params: 155412481
2023-05-09 20:34:17,021 [trainer.py] => Trainable params: 3678209
2023-05-09 20:34:17,034 [memo_transformer.py] => Learning on 90-100
2023-05-09 20:34:24,624 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 20:34:24,647 [trainer.py] => CNN: {'total': 97.82, '00-09': 97.82, 'old': 0, 'new': 97.82, 'harmonic': 0.0}
2023-05-09 20:34:24,647 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 20:34:24,647 [trainer.py] => CNN top1 curve: [97.82]
2023-05-09 20:34:24,647 [trainer.py] => CNN top5 curve: [99.9]
2023-05-09 20:34:24,647 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 20:34:24,647 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 20:34:24,647 [trainer.py] => Average Accuracy (CNN): 97.82
2023-05-09 20:34:24,648 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 20:34:24,648 [trainer.py] => ZS seen top1 curve: [97.87]
2023-05-09 20:34:24,648 [trainer.py] => ZS unseen top1 curve: [0.56]
2023-05-09 20:34:24,648 [trainer.py] => ZS harmonic top1 curve: [1.11]
2023-05-09 20:34:24,648 [trainer.py] => ZS total top1 curve: [10.38]
2023-05-09 20:34:24,648 [trainer.py] => Average Accuracy (ZS seen): 97.87
2023-05-09 20:34:24,648 [trainer.py] => Average Accuracy (ZS unseen): 0.56
2023-05-09 20:34:24,648 [trainer.py] => Average Accuracy (ZS harmonic): 1.11
2023-05-09 20:34:24,648 [trainer.py] => Average Accuracy (ZS total): 10.38
2023-05-09 20:34:24,649 [trainer.py] => All params: 151197697
2023-05-09 20:34:24,650 [trainer.py] => Trainable params: 1576961
2023-05-09 20:34:24,664 [memo_transformer.py] => Learning on 10-20
2023-05-09 20:35:45,272 [memo_transformer.py] => Task 0, Epoch 7/5 => Loss 1.954, Train_acc 98.75, Test_acc 97.97
2023-05-09 20:35:45,272 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:35:45,274 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 20:35:45,275 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 20:38:32,705 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 20:38:32,707 [trainer.py] => CNN: {'total': 97.97, '00-09': 97.97, 'old': 0, 'new': 97.97, 'harmonic': 0.0}
2023-05-09 20:38:32,707 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 20:38:32,707 [trainer.py] => CNN top1 curve: [97.97]
2023-05-09 20:38:32,707 [trainer.py] => CNN top5 curve: [99.95]
2023-05-09 20:38:32,707 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 20:38:32,707 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 20:38:32,707 [trainer.py] => Average Accuracy (CNN): 97.97
2023-05-09 20:38:32,707 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 20:38:32,707 [trainer.py] => ZS seen top1 curve: [96.29]
2023-05-09 20:38:32,707 [trainer.py] => ZS unseen top1 curve: [72.83]
2023-05-09 20:38:32,707 [trainer.py] => ZS harmonic top1 curve: [82.93]
2023-05-09 20:38:32,707 [trainer.py] => ZS total top1 curve: [75.2]
2023-05-09 20:38:32,707 [trainer.py] => Average Accuracy (ZS seen): 96.29
2023-05-09 20:38:32,707 [trainer.py] => Average Accuracy (ZS unseen): 72.83
2023-05-09 20:38:32,708 [trainer.py] => Average Accuracy (ZS harmonic): 82.93
2023-05-09 20:38:32,708 [trainer.py] => Average Accuracy (ZS total): 75.2
2023-05-09 20:38:32,709 [trainer.py] => All params: 151197697
2023-05-09 20:38:32,710 [trainer.py] => Trainable params: 1576961
2023-05-09 20:38:32,725 [memo_transformer.py] => Learning on 10-20
2023-05-09 20:42:01,609 [memo_transformer.py] => Task 3, Epoch 7/5 => Loss 2.186, Train_acc 93.81, Test_acc 90.88
2023-05-09 20:42:01,610 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:42:01,611 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 20:42:36,084 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 20:43:03,487 [memo_transformer.py] => Task 1, Epoch 7/5 => Loss 2.021, Train_acc 96.57, Test_acc 94.64
2023-05-09 20:43:03,491 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:43:03,491 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 20:43:23,369 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 20:46:24,964 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 20:46:24,979 [trainer.py] => CNN: {'total': 94.64, '00-09': 95.74, '10-19': 93.52, 'old': 95.74, 'new': 93.52, 'harmonic': 94.62}
2023-05-09 20:46:24,980 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 20:46:24,980 [trainer.py] => CNN top1 curve: [97.82, 94.64]
2023-05-09 20:46:24,980 [trainer.py] => CNN top5 curve: [99.9, 99.5]
2023-05-09 20:46:24,980 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 20:46:24,980 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 20:46:24,980 [trainer.py] => Average Accuracy (CNN): 96.22999999999999
2023-05-09 20:46:24,980 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 20:46:24,980 [trainer.py] => ZS seen top1 curve: [97.87, 94.67]
2023-05-09 20:46:24,980 [trainer.py] => ZS unseen top1 curve: [0.56, 2.92]
2023-05-09 20:46:24,980 [trainer.py] => ZS harmonic top1 curve: [1.11, 5.67]
2023-05-09 20:46:24,980 [trainer.py] => ZS total top1 curve: [10.38, 21.24]
2023-05-09 20:46:24,980 [trainer.py] => Average Accuracy (ZS seen): 96.27000000000001
2023-05-09 20:46:24,980 [trainer.py] => Average Accuracy (ZS unseen): 1.74
2023-05-09 20:46:24,980 [trainer.py] => Average Accuracy (ZS harmonic): 3.39
2023-05-09 20:46:24,980 [trainer.py] => Average Accuracy (ZS total): 15.809999999999999
2023-05-09 20:46:24,981 [trainer.py] => All params: 151724545
2023-05-09 20:46:24,982 [trainer.py] => Trainable params: 1839617
2023-05-09 20:46:24,998 [memo_transformer.py] => Learning on 20-30
2023-05-09 20:46:36,545 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 20:46:36,546 [trainer.py] => CNN: {'total': 90.88, '00-09': 91.98, '10-19': 91.34, '20-29': 89.97, '30-39': 90.24, 'old': 91.1, 'new': 90.24, 'harmonic': 90.67}
2023-05-09 20:46:36,546 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 20:46:36,546 [trainer.py] => CNN top1 curve: [97.82, 94.44, 92.43, 90.88]
2023-05-09 20:46:36,546 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27, 98.97]
2023-05-09 20:46:36,546 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 20:46:36,546 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 20:46:36,546 [trainer.py] => Average Accuracy (CNN): 93.8925
2023-05-09 20:46:36,546 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 20:46:36,546 [trainer.py] => ZS seen top1 curve: [96.68, 92.07, 88.08, 87.18]
2023-05-09 20:46:36,546 [trainer.py] => ZS unseen top1 curve: [65.32, 74.04, 77.41, 77.52]
2023-05-09 20:46:36,546 [trainer.py] => ZS harmonic top1 curve: [77.96, 82.08, 82.4, 82.07]
2023-05-09 20:46:36,546 [trainer.py] => ZS total top1 curve: [68.49, 77.64, 80.61, 81.41]
2023-05-09 20:46:36,547 [trainer.py] => Average Accuracy (ZS seen): 91.0025
2023-05-09 20:46:36,547 [trainer.py] => Average Accuracy (ZS unseen): 73.5725
2023-05-09 20:46:36,547 [trainer.py] => Average Accuracy (ZS harmonic): 81.1275
2023-05-09 20:46:36,547 [trainer.py] => Average Accuracy (ZS total): 77.0375
2023-05-09 20:46:36,548 [trainer.py] => All params: 152778241
2023-05-09 20:46:36,549 [trainer.py] => Trainable params: 2364929
2023-05-09 20:46:36,560 [memo_transformer.py] => Learning on 40-50
2023-05-09 20:47:12,691 [memo_transformer.py] => Task 1, Epoch 7/5 => Loss 1.902, Train_acc 96.00, Test_acc 94.87
2023-05-09 20:47:12,702 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:47:12,706 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 20:47:30,125 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 20:50:29,924 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 20:50:29,928 [trainer.py] => CNN: {'total': 94.87, '00-09': 95.79, '10-19': 93.92, 'old': 95.79, 'new': 93.92, 'harmonic': 94.85}
2023-05-09 20:50:29,928 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 20:50:29,928 [trainer.py] => CNN top1 curve: [97.97, 94.87]
2023-05-09 20:50:29,928 [trainer.py] => CNN top5 curve: [99.95, 99.52]
2023-05-09 20:50:29,928 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 20:50:29,928 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 20:50:29,928 [trainer.py] => Average Accuracy (CNN): 96.42
2023-05-09 20:50:29,928 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 20:50:29,928 [trainer.py] => ZS seen top1 curve: [96.29, 91.41]
2023-05-09 20:50:29,928 [trainer.py] => ZS unseen top1 curve: [72.83, 77.94]
2023-05-09 20:50:29,928 [trainer.py] => ZS harmonic top1 curve: [82.93, 84.14]
2023-05-09 20:50:29,928 [trainer.py] => ZS total top1 curve: [75.2, 80.63]
2023-05-09 20:50:29,928 [trainer.py] => Average Accuracy (ZS seen): 93.85
2023-05-09 20:50:29,928 [trainer.py] => Average Accuracy (ZS unseen): 75.38499999999999
2023-05-09 20:50:29,928 [trainer.py] => Average Accuracy (ZS harmonic): 83.535
2023-05-09 20:50:29,928 [trainer.py] => Average Accuracy (ZS total): 77.91499999999999
2023-05-09 20:50:29,929 [trainer.py] => All params: 151724545
2023-05-09 20:50:29,930 [trainer.py] => Trainable params: 1839617
2023-05-09 20:50:29,943 [memo_transformer.py] => Learning on 20-30
2023-05-09 20:52:14,245 [memo_transformer.py] => Task 9, Epoch 7/5 => Loss 1.774, Train_acc 92.18, Test_acc 83.53
2023-05-09 20:52:14,264 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:52:14,269 [base.py] => Reducing exemplars...(20 per classes)
2023-05-09 20:53:12,506 [base.py] => Constructing exemplars...(20 per classes)
2023-05-09 20:56:09,997 [memo_transformer.py] => Task 2, Epoch 7/5 => Loss 1.964, Train_acc 95.84, Test_acc 92.43
2023-05-09 20:56:10,012 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:56:10,013 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 20:56:38,611 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 20:58:23,048 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 20:58:23,064 [trainer.py] => CNN: {'total': 83.53, '00-09': 88.12, '10-19': 85.92, '20-29': 81.43, '30-39': 83.93, '40-49': 86.26, '50-59': 82.79, '60-69': 76.06, '70-79': 84.91, '80-89': 86.4, '90-99': 79.44, 'old': 83.99, 'new': 79.44, 'harmonic': 81.65}
2023-05-09 20:58:23,064 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-09 20:58:23,064 [trainer.py] => CNN top1 curve: [97.97, 94.97, 92.48, 90.52, 89.04, 87.57, 85.54, 85.07, 84.82, 83.53]
2023-05-09 20:58:23,064 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.23, 98.88, 98.5, 98.11, 97.62, 97.31, 97.12, 96.77]
2023-05-09 20:58:23,064 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-09 20:58:23,064 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-09 20:58:23,065 [trainer.py] => Average Accuracy (CNN): 89.15099999999998
2023-05-09 20:58:23,065 [trainer.py] => Average Accuracy (NME): 87.828
2023-05-09 20:58:23,065 [trainer.py] => ZS seen top1 curve: [97.43, 93.44, 89.31, 88.5, 87.57, 86.38, 85.31, 85.18, 85.08, 84.4]
2023-05-09 20:58:23,065 [trainer.py] => ZS unseen top1 curve: [58.53, 70.38, 75.26, 76.0, 75.33, 76.34, 78.6, 76.84, 74.55, 0]
2023-05-09 20:58:23,065 [trainer.py] => ZS harmonic top1 curve: [73.13, 80.29, 81.69, 81.78, 80.99, 81.05, 81.82, 80.8, 79.47, 0.0]
2023-05-09 20:58:23,065 [trainer.py] => ZS total top1 curve: [62.46, 74.98, 79.47, 81.03, 81.47, 82.39, 83.31, 83.52, 84.04, 84.4]
2023-05-09 20:58:23,065 [trainer.py] => Average Accuracy (ZS seen): 88.26000000000002
2023-05-09 20:58:23,065 [trainer.py] => Average Accuracy (ZS unseen): 66.183
2023-05-09 20:58:23,065 [trainer.py] => Average Accuracy (ZS harmonic): 72.102
2023-05-09 20:58:23,065 [trainer.py] => Average Accuracy (ZS total): 79.70699999999998
2023-05-09 20:58:30,962 [memo_transformer.py] => Task 4, Epoch 7/5 => Loss 2.091, Train_acc 94.46, Test_acc 89.78
2023-05-09 20:58:30,983 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 20:58:30,983 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 20:59:00,333 [trainer.py] => config: ././exp5_pure_mlp//food101/food101_memo_transformer_clip_5_0.002_32_0.005.json
2023-05-09 20:59:00,334 [trainer.py] => prefix: reproduce
2023-05-09 20:59:00,334 [trainer.py] => dataset: food101
2023-05-09 20:59:00,334 [trainer.py] => memory_size: 2000
2023-05-09 20:59:00,334 [trainer.py] => memory_per_class: 20
2023-05-09 20:59:00,334 [trainer.py] => fixed_memory: False
2023-05-09 20:59:00,334 [trainer.py] => shuffle: True
2023-05-09 20:59:00,334 [trainer.py] => init_cls: 10
2023-05-09 20:59:00,334 [trainer.py] => increment: 10
2023-05-09 20:59:00,334 [trainer.py] => model_name: memo_transformer
2023-05-09 20:59:00,334 [trainer.py] => convnet_type: clip
2023-05-09 20:59:00,334 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 20:59:00,334 [trainer.py] => seed: 1993
2023-05-09 20:59:00,334 [trainer.py] => projection_type: pure_mlp
2023-05-09 20:59:00,335 [trainer.py] => fusion_choice: transformer
2023-05-09 20:59:00,335 [trainer.py] => split_train: False
2023-05-09 20:59:00,335 [trainer.py] => tsne_option: False
2023-05-09 20:59:00,335 [trainer.py] => laion_check: False
2023-05-09 20:59:00,335 [trainer.py] => train_tasks: 999
2023-05-09 20:59:00,335 [trainer.py] => frozen_layers: visual
2023-05-09 20:59:00,335 [trainer.py] => tuned_epoch: 5
2023-05-09 20:59:00,335 [trainer.py] => first_epoch: 5
2023-05-09 20:59:00,335 [trainer.py] => init_lr: 0.002
2023-05-09 20:59:00,335 [trainer.py] => batch_size: 32
2023-05-09 20:59:00,335 [trainer.py] => weight_decay: 0.005
2023-05-09 20:59:00,335 [trainer.py] => min_lr: 0
2023-05-09 20:59:00,335 [trainer.py] => optimizer: sgd
2023-05-09 20:59:00,966 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 20:59:14,796 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 20:59:46,181 [instantiator.py] => Created a temporary directory at /tmp/tmpr3bg1iqu
2023-05-09 20:59:46,181 [instantiator.py] => Writing /tmp/tmpr3bg1iqu/_remote_module_non_sriptable.py
2023-05-09 20:59:47,573 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 20:59:51,429 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 20:59:53,499 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 20:59:53,700 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 20:59:53,705 [trainer.py] => CNN: {'total': 92.43, '00-09': 93.76, '10-19': 90.68, '20-29': 92.81, 'old': 92.24, 'new': 92.81, 'harmonic': 92.52}
2023-05-09 20:59:53,705 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 20:59:53,705 [trainer.py] => CNN top1 curve: [97.82, 94.64, 92.43]
2023-05-09 20:59:53,705 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.22]
2023-05-09 20:59:53,705 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 20:59:53,705 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 20:59:53,705 [trainer.py] => Average Accuracy (CNN): 94.96333333333332
2023-05-09 20:59:53,705 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 20:59:53,705 [trainer.py] => ZS seen top1 curve: [97.87, 94.67, 91.83]
2023-05-09 20:59:53,705 [trainer.py] => ZS unseen top1 curve: [0.56, 2.92, 5.59]
2023-05-09 20:59:53,705 [trainer.py] => ZS harmonic top1 curve: [1.11, 5.67, 10.54]
2023-05-09 20:59:53,705 [trainer.py] => ZS total top1 curve: [10.38, 21.24, 31.44]
2023-05-09 20:59:53,705 [trainer.py] => Average Accuracy (ZS seen): 94.79
2023-05-09 20:59:53,705 [trainer.py] => Average Accuracy (ZS unseen): 3.0233333333333334
2023-05-09 20:59:53,705 [trainer.py] => Average Accuracy (ZS harmonic): 5.773333333333333
2023-05-09 20:59:53,705 [trainer.py] => Average Accuracy (ZS total): 21.02
2023-05-09 20:59:53,707 [trainer.py] => All params: 152251393
2023-05-09 20:59:53,708 [trainer.py] => Trainable params: 2102273
2023-05-09 20:59:53,726 [memo_transformer.py] => Learning on 30-40
2023-05-09 20:59:56,157 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 20:59:56,535 [trainer.py] => All params: 150670849
2023-05-09 20:59:56,535 [trainer.py] => Trainable params: 150670849
2023-05-09 21:00:01,907 [memo_transformer.py] => Learning on 0-10
2023-05-09 21:00:18,954 [memo_transformer.py] => Task 2, Epoch 7/5 => Loss 1.967, Train_acc 94.73, Test_acc 92.55
2023-05-09 21:00:18,957 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 21:00:18,957 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 21:00:45,239 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 21:03:25,604 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 21:03:25,615 [trainer.py] => CNN: {'total': 89.78, '00-09': 90.2, '10-19': 91.04, '20-29': 88.07, '30-39': 90.05, '40-49': 89.53, 'old': 89.84, 'new': 89.53, 'harmonic': 89.68}
2023-05-09 21:03:25,616 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 21:03:25,616 [trainer.py] => CNN top1 curve: [97.82, 94.44, 92.43, 90.88, 89.78]
2023-05-09 21:03:25,616 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27, 98.97, 98.74]
2023-05-09 21:03:25,616 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 21:03:25,616 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 21:03:25,616 [trainer.py] => Average Accuracy (CNN): 93.07000000000001
2023-05-09 21:03:25,616 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 21:03:25,616 [trainer.py] => ZS seen top1 curve: [96.68, 92.07, 88.08, 87.18, 86.51]
2023-05-09 21:03:25,616 [trainer.py] => ZS unseen top1 curve: [65.32, 74.04, 77.41, 77.52, 77.29]
2023-05-09 21:03:25,616 [trainer.py] => ZS harmonic top1 curve: [77.96, 82.08, 82.4, 82.07, 81.64]
2023-05-09 21:03:25,616 [trainer.py] => ZS total top1 curve: [68.49, 77.64, 80.61, 81.41, 81.92]
2023-05-09 21:03:25,616 [trainer.py] => Average Accuracy (ZS seen): 90.104
2023-05-09 21:03:25,616 [trainer.py] => Average Accuracy (ZS unseen): 74.316
2023-05-09 21:03:25,616 [trainer.py] => Average Accuracy (ZS harmonic): 81.22999999999999
2023-05-09 21:03:25,616 [trainer.py] => Average Accuracy (ZS total): 78.014
2023-05-09 21:03:25,617 [trainer.py] => All params: 153305089
2023-05-09 21:03:25,618 [trainer.py] => Trainable params: 2627585
2023-05-09 21:03:25,633 [memo_transformer.py] => Learning on 50-60
2023-05-09 21:04:12,277 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 21:04:12,278 [trainer.py] => CNN: {'total': 92.55, '00-09': 92.43, '10-19': 90.84, '20-29': 94.36, 'old': 91.64, 'new': 94.36, 'harmonic': 92.98}
2023-05-09 21:04:12,278 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 21:04:12,278 [trainer.py] => CNN top1 curve: [97.97, 94.87, 92.55]
2023-05-09 21:04:12,278 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.23]
2023-05-09 21:04:12,278 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 21:04:12,278 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 21:04:12,278 [trainer.py] => Average Accuracy (CNN): 95.13
2023-05-09 21:04:12,278 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 21:04:12,278 [trainer.py] => ZS seen top1 curve: [96.29, 91.41, 88.78]
2023-05-09 21:04:12,278 [trainer.py] => ZS unseen top1 curve: [72.83, 77.94, 77.99]
2023-05-09 21:04:12,278 [trainer.py] => ZS harmonic top1 curve: [82.93, 84.14, 83.04]
2023-05-09 21:04:12,278 [trainer.py] => ZS total top1 curve: [75.2, 80.63, 81.23]
2023-05-09 21:04:12,278 [trainer.py] => Average Accuracy (ZS seen): 92.16000000000001
2023-05-09 21:04:12,279 [trainer.py] => Average Accuracy (ZS unseen): 76.25333333333333
2023-05-09 21:04:12,279 [trainer.py] => Average Accuracy (ZS harmonic): 83.37
2023-05-09 21:04:12,279 [trainer.py] => Average Accuracy (ZS total): 79.02
2023-05-09 21:04:12,281 [trainer.py] => All params: 152251393
2023-05-09 21:04:12,282 [trainer.py] => Trainable params: 2102273
2023-05-09 21:04:12,296 [memo_transformer.py] => Learning on 30-40
2023-05-09 21:04:32,635 [memo_transformer.py] => Task 0, Epoch 5/5 => Loss 1.495, Train_acc 98.66, Test_acc 97.92
2023-05-09 21:04:32,636 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0] 
2023-05-09 21:04:32,637 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 21:04:32,637 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 21:07:10,612 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 21:07:10,613 [trainer.py] => CNN: {'total': 97.92, '00-09': 97.92, 'old': 0, 'new': 97.92, 'harmonic': 0.0}
2023-05-09 21:07:10,613 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 21:07:10,613 [trainer.py] => CNN top1 curve: [97.92]
2023-05-09 21:07:10,613 [trainer.py] => CNN top5 curve: [99.95]
2023-05-09 21:07:10,613 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 21:07:10,613 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 21:07:10,614 [trainer.py] => Average Accuracy (CNN): 97.92
2023-05-09 21:07:10,614 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 21:07:10,614 [trainer.py] => ZS seen top1 curve: [97.87]
2023-05-09 21:07:10,614 [trainer.py] => ZS unseen top1 curve: [1.37]
2023-05-09 21:07:10,614 [trainer.py] => ZS harmonic top1 curve: [2.7]
2023-05-09 21:07:10,614 [trainer.py] => ZS total top1 curve: [11.11]
2023-05-09 21:07:10,614 [trainer.py] => Average Accuracy (ZS seen): 97.87
2023-05-09 21:07:10,614 [trainer.py] => Average Accuracy (ZS unseen): 1.37
2023-05-09 21:07:10,614 [trainer.py] => Average Accuracy (ZS harmonic): 2.7
2023-05-09 21:07:10,614 [trainer.py] => Average Accuracy (ZS total): 11.11
2023-05-09 21:07:10,615 [trainer.py] => All params: 151197697
2023-05-09 21:07:10,617 [trainer.py] => Trainable params: 1576961
2023-05-09 21:07:10,635 [memo_transformer.py] => Learning on 10-20
2023-05-09 21:10:41,731 [memo_transformer.py] => Task 3, Epoch 7/5 => Loss 1.942, Train_acc 96.35, Test_acc 91.11
2023-05-09 21:10:41,748 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 21:10:41,748 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 21:11:16,952 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 21:13:20,198 [memo_transformer.py] => Task 1, Epoch 5/5 => Loss 1.371, Train_acc 97.22, Test_acc 94.49
2023-05-09 21:13:20,212 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 21:13:20,216 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 21:13:38,484 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 21:14:44,843 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 21:14:44,850 [trainer.py] => CNN: {'total': 91.11, '00-09': 91.04, '10-19': 90.94, '20-29': 89.27, '30-39': 93.16, 'old': 90.41, 'new': 93.16, 'harmonic': 91.76}
2023-05-09 21:14:44,850 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 21:14:44,850 [trainer.py] => CNN top1 curve: [97.82, 94.64, 92.43, 91.11]
2023-05-09 21:14:44,850 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.22, 98.82]
2023-05-09 21:14:44,850 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 21:14:44,850 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 21:14:44,850 [trainer.py] => Average Accuracy (CNN): 94.0
2023-05-09 21:14:44,850 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 21:14:44,850 [trainer.py] => ZS seen top1 curve: [97.87, 94.67, 91.83, 90.74]
2023-05-09 21:14:44,850 [trainer.py] => ZS unseen top1 curve: [0.56, 2.92, 5.59, 11.21]
2023-05-09 21:14:44,850 [trainer.py] => ZS harmonic top1 curve: [1.11, 5.67, 10.54, 19.95]
2023-05-09 21:14:44,850 [trainer.py] => ZS total top1 curve: [10.38, 21.24, 31.44, 43.23]
2023-05-09 21:14:44,851 [trainer.py] => Average Accuracy (ZS seen): 93.7775
2023-05-09 21:14:44,851 [trainer.py] => Average Accuracy (ZS unseen): 5.07
2023-05-09 21:14:44,851 [trainer.py] => Average Accuracy (ZS harmonic): 9.317499999999999
2023-05-09 21:14:44,851 [trainer.py] => Average Accuracy (ZS total): 26.572499999999998
2023-05-09 21:14:44,852 [trainer.py] => All params: 152778241
2023-05-09 21:14:44,853 [trainer.py] => Trainable params: 2364929
2023-05-09 21:14:44,870 [memo_transformer.py] => Learning on 40-50
2023-05-09 21:15:09,081 [memo_transformer.py] => Task 3, Epoch 7/5 => Loss 2.032, Train_acc 93.94, Test_acc 90.64
2023-05-09 21:15:09,082 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 21:15:09,088 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 21:15:40,064 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 21:16:26,218 [memo_transformer.py] => Task 5, Epoch 7/5 => Loss 2.212, Train_acc 93.54, Test_acc 88.44
2023-05-09 21:16:26,219 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 21:16:26,219 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 21:16:39,888 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 21:16:39,911 [trainer.py] => CNN: {'total': 94.49, '00-09': 95.0, '10-19': 93.97, 'old': 95.0, 'new': 93.97, 'harmonic': 94.48}
2023-05-09 21:16:39,911 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 21:16:39,911 [trainer.py] => CNN top1 curve: [97.92, 94.49]
2023-05-09 21:16:39,911 [trainer.py] => CNN top5 curve: [99.95, 99.55]
2023-05-09 21:16:39,911 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 21:16:39,911 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 21:16:39,911 [trainer.py] => Average Accuracy (CNN): 96.205
2023-05-09 21:16:39,911 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 21:16:39,912 [trainer.py] => ZS seen top1 curve: [97.87, 94.44]
2023-05-09 21:16:39,912 [trainer.py] => ZS unseen top1 curve: [1.37, 4.42]
2023-05-09 21:16:39,912 [trainer.py] => ZS harmonic top1 curve: [2.7, 8.44]
2023-05-09 21:16:39,912 [trainer.py] => ZS total top1 curve: [11.11, 22.39]
2023-05-09 21:16:39,912 [trainer.py] => Average Accuracy (ZS seen): 96.155
2023-05-09 21:16:39,912 [trainer.py] => Average Accuracy (ZS unseen): 2.895
2023-05-09 21:16:39,912 [trainer.py] => Average Accuracy (ZS harmonic): 5.57
2023-05-09 21:16:39,912 [trainer.py] => Average Accuracy (ZS total): 16.75
2023-05-09 21:16:39,913 [trainer.py] => All params: 151724545
2023-05-09 21:16:39,914 [trainer.py] => Trainable params: 1839617
2023-05-09 21:16:39,927 [memo_transformer.py] => Learning on 20-30
2023-05-09 21:17:11,355 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 21:19:26,281 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 21:19:26,282 [trainer.py] => CNN: {'total': 90.64, '00-09': 90.45, '10-19': 88.66, '20-29': 88.97, '30-39': 94.37, 'old': 89.36, 'new': 94.37, 'harmonic': 91.8}
2023-05-09 21:19:26,282 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 21:19:26,282 [trainer.py] => CNN top1 curve: [97.97, 94.87, 92.55, 90.64]
2023-05-09 21:19:26,282 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.23, 99.02]
2023-05-09 21:19:26,282 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 21:19:26,282 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 21:19:26,282 [trainer.py] => Average Accuracy (CNN): 94.0075
2023-05-09 21:19:26,282 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 21:19:26,282 [trainer.py] => ZS seen top1 curve: [96.29, 91.41, 88.78, 86.62]
2023-05-09 21:19:26,283 [trainer.py] => ZS unseen top1 curve: [72.83, 77.94, 77.99, 76.8]
2023-05-09 21:19:26,283 [trainer.py] => ZS harmonic top1 curve: [82.93, 84.14, 83.04, 81.41]
2023-05-09 21:19:26,283 [trainer.py] => ZS total top1 curve: [75.2, 80.63, 81.23, 80.76]
2023-05-09 21:19:26,283 [trainer.py] => Average Accuracy (ZS seen): 90.775
2023-05-09 21:19:26,283 [trainer.py] => Average Accuracy (ZS unseen): 76.39
2023-05-09 21:19:26,283 [trainer.py] => Average Accuracy (ZS harmonic): 82.88
2023-05-09 21:19:26,283 [trainer.py] => Average Accuracy (ZS total): 79.455
2023-05-09 21:19:26,285 [trainer.py] => All params: 152778241
2023-05-09 21:19:26,286 [trainer.py] => Trainable params: 2364929
2023-05-09 21:19:26,304 [memo_transformer.py] => Learning on 40-50
2023-05-09 21:21:43,450 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 21:21:43,556 [trainer.py] => CNN: {'total': 88.44, '00-09': 88.71, '10-19': 90.48, '20-29': 87.12, '30-39': 88.54, '40-49': 90.14, '50-59': 85.67, 'old': 88.99, 'new': 85.67, 'harmonic': 87.3}
2023-05-09 21:21:43,556 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 21:21:43,556 [trainer.py] => CNN top1 curve: [97.82, 94.44, 92.43, 90.88, 89.78, 88.44]
2023-05-09 21:21:43,556 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27, 98.97, 98.74, 98.27]
2023-05-09 21:21:43,556 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-09 21:21:43,556 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-09 21:21:43,557 [trainer.py] => Average Accuracy (CNN): 92.29833333333333
2023-05-09 21:21:43,557 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-09 21:21:43,557 [trainer.py] => ZS seen top1 curve: [96.68, 92.07, 88.08, 87.18, 86.51, 85.86]
2023-05-09 21:21:43,557 [trainer.py] => ZS unseen top1 curve: [65.32, 74.04, 77.41, 77.52, 77.29, 77.48]
2023-05-09 21:21:43,557 [trainer.py] => ZS harmonic top1 curve: [77.96, 82.08, 82.4, 82.07, 81.64, 81.46]
2023-05-09 21:21:43,557 [trainer.py] => ZS total top1 curve: [68.49, 77.64, 80.61, 81.41, 81.92, 82.53]
2023-05-09 21:21:43,557 [trainer.py] => Average Accuracy (ZS seen): 89.39666666666666
2023-05-09 21:21:43,557 [trainer.py] => Average Accuracy (ZS unseen): 74.84333333333335
2023-05-09 21:21:43,557 [trainer.py] => Average Accuracy (ZS harmonic): 81.26833333333333
2023-05-09 21:21:43,557 [trainer.py] => Average Accuracy (ZS total): 78.76666666666667
2023-05-09 21:21:43,559 [trainer.py] => All params: 153831937
2023-05-09 21:21:43,560 [trainer.py] => Trainable params: 2890241
2023-05-09 21:21:43,598 [memo_transformer.py] => Learning on 60-70
2023-05-09 21:23:41,019 [memo_transformer.py] => Task 2, Epoch 5/5 => Loss 1.353, Train_acc 96.90, Test_acc 92.61
2023-05-09 21:23:41,025 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 21:23:41,029 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 21:24:08,680 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 21:26:41,677 [memo_transformer.py] => Task 4, Epoch 7/5 => Loss 1.851, Train_acc 97.13, Test_acc 89.68
2023-05-09 21:26:41,678 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 21:26:41,679 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 21:27:20,471 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 21:27:28,887 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 21:27:28,903 [trainer.py] => CNN: {'total': 92.61, '00-09': 92.52, '10-19': 91.7, '20-29': 93.61, 'old': 92.12, 'new': 93.61, 'harmonic': 92.86}
2023-05-09 21:27:28,903 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 21:27:28,903 [trainer.py] => CNN top1 curve: [97.92, 94.49, 92.61]
2023-05-09 21:27:28,903 [trainer.py] => CNN top5 curve: [99.95, 99.55, 99.3]
2023-05-09 21:27:28,903 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 21:27:28,903 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 21:27:28,903 [trainer.py] => Average Accuracy (CNN): 95.00666666666666
2023-05-09 21:27:28,904 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 21:27:28,904 [trainer.py] => ZS seen top1 curve: [97.87, 94.44, 92.08]
2023-05-09 21:27:28,904 [trainer.py] => ZS unseen top1 curve: [1.37, 4.42, 8.77]
2023-05-09 21:27:28,904 [trainer.py] => ZS harmonic top1 curve: [2.7, 8.44, 16.01]
2023-05-09 21:27:28,904 [trainer.py] => ZS total top1 curve: [11.11, 22.39, 33.74]
2023-05-09 21:27:28,904 [trainer.py] => Average Accuracy (ZS seen): 94.79666666666667
2023-05-09 21:27:28,904 [trainer.py] => Average Accuracy (ZS unseen): 4.853333333333333
2023-05-09 21:27:28,904 [trainer.py] => Average Accuracy (ZS harmonic): 9.05
2023-05-09 21:27:28,904 [trainer.py] => Average Accuracy (ZS total): 22.413333333333338
2023-05-09 21:27:28,905 [trainer.py] => All params: 152251393
2023-05-09 21:27:28,906 [trainer.py] => Trainable params: 2102273
2023-05-09 21:27:28,922 [memo_transformer.py] => Learning on 30-40
2023-05-09 21:31:02,310 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 21:31:02,333 [trainer.py] => CNN: {'total': 89.68, '00-09': 89.06, '10-19': 90.89, '20-29': 87.92, '30-39': 88.35, '40-49': 92.25, 'old': 89.04, 'new': 92.25, 'harmonic': 90.62}
2023-05-09 21:31:02,333 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 21:31:02,334 [trainer.py] => CNN top1 curve: [97.82, 94.64, 92.43, 91.11, 89.68]
2023-05-09 21:31:02,334 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.22, 98.82, 98.46]
2023-05-09 21:31:02,334 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 21:31:02,334 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 21:31:02,334 [trainer.py] => Average Accuracy (CNN): 93.136
2023-05-09 21:31:02,334 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 21:31:02,334 [trainer.py] => ZS seen top1 curve: [97.87, 94.67, 91.83, 90.74, 89.23]
2023-05-09 21:31:02,334 [trainer.py] => ZS unseen top1 curve: [0.56, 2.92, 5.59, 11.21, 16.46]
2023-05-09 21:31:02,334 [trainer.py] => ZS harmonic top1 curve: [1.11, 5.67, 10.54, 19.95, 27.79]
2023-05-09 21:31:02,334 [trainer.py] => ZS total top1 curve: [10.38, 21.24, 31.44, 43.23, 52.99]
2023-05-09 21:31:02,334 [trainer.py] => Average Accuracy (ZS seen): 92.86800000000001
2023-05-09 21:31:02,334 [trainer.py] => Average Accuracy (ZS unseen): 7.348000000000001
2023-05-09 21:31:02,334 [trainer.py] => Average Accuracy (ZS harmonic): 13.012
2023-05-09 21:31:02,334 [trainer.py] => Average Accuracy (ZS total): 31.856
2023-05-09 21:31:02,335 [trainer.py] => All params: 153305089
2023-05-09 21:31:02,336 [trainer.py] => Trainable params: 2627585
2023-05-09 21:31:02,346 [memo_transformer.py] => Learning on 50-60
2023-05-09 21:31:36,070 [memo_transformer.py] => Task 4, Epoch 7/5 => Loss 1.981, Train_acc 93.99, Test_acc 89.55
2023-05-09 21:31:36,071 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 21:31:36,075 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 21:32:10,626 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 21:35:20,382 [memo_transformer.py] => Task 3, Epoch 5/5 => Loss 1.315, Train_acc 97.38, Test_acc 91.02
2023-05-09 21:35:20,442 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 21:35:20,443 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 21:35:43,211 [memo_transformer.py] => Task 6, Epoch 7/5 => Loss 2.520, Train_acc 89.91, Test_acc 86.46
2023-05-09 21:35:43,213 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 21:35:43,214 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 21:35:56,792 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 21:36:20,301 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 21:36:20,309 [trainer.py] => CNN: {'total': 89.55, '00-09': 89.55, '10-19': 89.22, '20-29': 88.12, '30-39': 87.77, '40-49': 93.16, 'old': 88.66, 'new': 93.16, 'harmonic': 90.85}
2023-05-09 21:36:20,309 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 21:36:20,309 [trainer.py] => CNN top1 curve: [97.97, 94.87, 92.55, 90.64, 89.55]
2023-05-09 21:36:20,309 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.23, 99.02, 98.6]
2023-05-09 21:36:20,309 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 21:36:20,309 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 21:36:20,309 [trainer.py] => Average Accuracy (CNN): 93.116
2023-05-09 21:36:20,310 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 21:36:20,310 [trainer.py] => ZS seen top1 curve: [96.29, 91.41, 88.78, 86.62, 85.5]
2023-05-09 21:36:20,310 [trainer.py] => ZS unseen top1 curve: [72.83, 77.94, 77.99, 76.8, 77.32]
2023-05-09 21:36:20,310 [trainer.py] => ZS harmonic top1 curve: [82.93, 84.14, 83.04, 81.41, 81.2]
2023-05-09 21:36:20,310 [trainer.py] => ZS total top1 curve: [75.2, 80.63, 81.23, 80.76, 81.42]
2023-05-09 21:36:20,310 [trainer.py] => Average Accuracy (ZS seen): 89.72
2023-05-09 21:36:20,310 [trainer.py] => Average Accuracy (ZS unseen): 76.576
2023-05-09 21:36:20,310 [trainer.py] => Average Accuracy (ZS harmonic): 82.544
2023-05-09 21:36:20,310 [trainer.py] => Average Accuracy (ZS total): 79.848
2023-05-09 21:36:20,311 [trainer.py] => All params: 153305089
2023-05-09 21:36:20,312 [trainer.py] => Trainable params: 2627585
2023-05-09 21:36:20,330 [memo_transformer.py] => Learning on 50-60
2023-05-09 21:36:27,679 [base.py] => Constructing exemplars...(28 per classes)
2023-05-09 21:39:34,711 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 21:39:34,735 [trainer.py] => CNN: {'total': 91.02, '00-09': 90.64, '10-19': 91.09, '20-29': 88.77, '30-39': 93.5, 'old': 90.16, 'new': 93.5, 'harmonic': 91.8}
2023-05-09 21:39:34,735 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 21:39:34,735 [trainer.py] => CNN top1 curve: [97.92, 94.49, 92.61, 91.02]
2023-05-09 21:39:34,735 [trainer.py] => CNN top5 curve: [99.95, 99.55, 99.3, 98.8]
2023-05-09 21:39:34,735 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 21:39:34,735 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 21:39:34,735 [trainer.py] => Average Accuracy (CNN): 94.00999999999999
2023-05-09 21:39:34,735 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 21:39:34,735 [trainer.py] => ZS seen top1 curve: [97.87, 94.44, 92.08, 90.36]
2023-05-09 21:39:34,735 [trainer.py] => ZS unseen top1 curve: [1.37, 4.42, 8.77, 14.12]
2023-05-09 21:39:34,735 [trainer.py] => ZS harmonic top1 curve: [2.7, 8.44, 16.01, 24.42]
2023-05-09 21:39:34,735 [trainer.py] => ZS total top1 curve: [11.11, 22.39, 33.74, 44.82]
2023-05-09 21:39:34,735 [trainer.py] => Average Accuracy (ZS seen): 93.6875
2023-05-09 21:39:34,735 [trainer.py] => Average Accuracy (ZS unseen): 7.17
2023-05-09 21:39:34,735 [trainer.py] => Average Accuracy (ZS harmonic): 12.892500000000002
2023-05-09 21:39:34,735 [trainer.py] => Average Accuracy (ZS total): 28.015
2023-05-09 21:39:34,736 [trainer.py] => All params: 152778241
2023-05-09 21:39:34,737 [trainer.py] => Trainable params: 2364929
2023-05-09 21:39:34,750 [memo_transformer.py] => Learning on 40-50
2023-05-09 21:41:14,446 [memo_transformer.py] => Exemplar size: 1960
2023-05-09 21:41:14,449 [trainer.py] => CNN: {'total': 86.46, '00-09': 88.17, '10-19': 89.72, '20-29': 84.87, '30-39': 88.06, '40-49': 88.93, '50-59': 85.67, '60-69': 79.75, 'old': 87.57, 'new': 79.75, 'harmonic': 83.48}
2023-05-09 21:41:14,449 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-09 21:41:14,449 [trainer.py] => CNN top1 curve: [97.82, 94.44, 92.43, 90.88, 89.78, 88.44, 86.46]
2023-05-09 21:41:14,449 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27, 98.97, 98.74, 98.27, 97.82]
2023-05-09 21:41:14,449 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-09 21:41:14,449 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-09 21:41:14,449 [trainer.py] => Average Accuracy (CNN): 91.46428571428571
2023-05-09 21:41:14,449 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-09 21:41:14,449 [trainer.py] => ZS seen top1 curve: [96.68, 92.07, 88.08, 87.18, 86.51, 85.86, 84.59]
2023-05-09 21:41:14,449 [trainer.py] => ZS unseen top1 curve: [65.32, 74.04, 77.41, 77.52, 77.29, 77.48, 79.45]
2023-05-09 21:41:14,449 [trainer.py] => ZS harmonic top1 curve: [77.96, 82.08, 82.4, 82.07, 81.64, 81.46, 81.94]
2023-05-09 21:41:14,449 [trainer.py] => ZS total top1 curve: [68.49, 77.64, 80.61, 81.41, 81.92, 82.53, 83.06]
2023-05-09 21:41:14,449 [trainer.py] => Average Accuracy (ZS seen): 88.71000000000001
2023-05-09 21:41:14,449 [trainer.py] => Average Accuracy (ZS unseen): 75.50142857142859
2023-05-09 21:41:14,449 [trainer.py] => Average Accuracy (ZS harmonic): 81.36428571428571
2023-05-09 21:41:14,449 [trainer.py] => Average Accuracy (ZS total): 79.38000000000001
2023-05-09 21:41:14,451 [trainer.py] => All params: 154358785
2023-05-09 21:41:14,451 [trainer.py] => Trainable params: 3152897
2023-05-09 21:41:14,463 [memo_transformer.py] => Learning on 70-80
2023-05-09 21:44:02,988 [memo_transformer.py] => Task 5, Epoch 7/5 => Loss 1.887, Train_acc 97.39, Test_acc 88.18
2023-05-09 21:44:03,004 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 21:44:03,004 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 21:44:45,438 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 21:48:22,352 [memo_transformer.py] => Task 4, Epoch 5/5 => Loss 1.248, Train_acc 98.34, Test_acc 89.41
2023-05-09 21:48:22,374 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 21:48:22,377 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 21:48:44,700 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 21:48:44,718 [trainer.py] => CNN: {'total': 88.18, '00-09': 88.71, '10-19': 88.15, '20-29': 86.82, '30-39': 86.5, '40-49': 88.88, '50-59': 90.05, 'old': 87.8, 'new': 90.05, 'harmonic': 88.91}
2023-05-09 21:48:44,718 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 21:48:44,718 [trainer.py] => CNN top1 curve: [97.82, 94.64, 92.43, 91.11, 89.68, 88.18]
2023-05-09 21:48:44,718 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.22, 98.82, 98.46, 98.13]
2023-05-09 21:48:44,718 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-09 21:48:44,719 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-09 21:48:44,719 [trainer.py] => Average Accuracy (CNN): 92.31
2023-05-09 21:48:44,719 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-09 21:48:44,719 [trainer.py] => ZS seen top1 curve: [97.87, 94.67, 91.83, 90.74, 89.23, 87.5]
2023-05-09 21:48:44,719 [trainer.py] => ZS unseen top1 curve: [0.56, 2.92, 5.59, 11.21, 16.46, 23.3]
2023-05-09 21:48:44,719 [trainer.py] => ZS harmonic top1 curve: [1.11, 5.67, 10.54, 19.95, 27.79, 36.8]
2023-05-09 21:48:44,719 [trainer.py] => ZS total top1 curve: [10.38, 21.24, 31.44, 43.23, 52.99, 61.97]
2023-05-09 21:48:44,719 [trainer.py] => Average Accuracy (ZS seen): 91.97333333333334
2023-05-09 21:48:44,719 [trainer.py] => Average Accuracy (ZS unseen): 10.006666666666668
2023-05-09 21:48:44,719 [trainer.py] => Average Accuracy (ZS harmonic): 16.976666666666667
2023-05-09 21:48:44,719 [trainer.py] => Average Accuracy (ZS total): 36.875
2023-05-09 21:48:44,720 [trainer.py] => All params: 153831937
2023-05-09 21:48:44,721 [trainer.py] => Trainable params: 2890241
2023-05-09 21:48:44,735 [memo_transformer.py] => Learning on 60-70
2023-05-09 21:48:56,822 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 21:49:38,146 [memo_transformer.py] => Task 5, Epoch 7/5 => Loss 2.114, Train_acc 93.22, Test_acc 88.07
2023-05-09 21:49:38,149 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 21:49:38,154 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 21:50:17,272 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 21:52:50,454 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 21:52:50,470 [trainer.py] => CNN: {'total': 89.41, '00-09': 88.71, '10-19': 90.33, '20-29': 86.52, '30-39': 88.06, '40-49': 93.51, 'old': 88.4, 'new': 93.51, 'harmonic': 90.88}
2023-05-09 21:52:50,470 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 21:52:50,470 [trainer.py] => CNN top1 curve: [97.92, 94.49, 92.61, 91.02, 89.41]
2023-05-09 21:52:50,470 [trainer.py] => CNN top5 curve: [99.95, 99.55, 99.3, 98.8, 98.39]
2023-05-09 21:52:50,470 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 21:52:50,470 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 21:52:50,470 [trainer.py] => Average Accuracy (CNN): 93.08999999999999
2023-05-09 21:52:50,471 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 21:52:50,471 [trainer.py] => ZS seen top1 curve: [97.87, 94.44, 92.08, 90.36, 88.94]
2023-05-09 21:52:50,471 [trainer.py] => ZS unseen top1 curve: [1.37, 4.42, 8.77, 14.12, 18.99]
2023-05-09 21:52:50,471 [trainer.py] => ZS harmonic top1 curve: [2.7, 8.44, 16.01, 24.42, 31.3]
2023-05-09 21:52:50,471 [trainer.py] => ZS total top1 curve: [11.11, 22.39, 33.74, 44.82, 54.1]
2023-05-09 21:52:50,471 [trainer.py] => Average Accuracy (ZS seen): 92.738
2023-05-09 21:52:50,471 [trainer.py] => Average Accuracy (ZS unseen): 9.534
2023-05-09 21:52:50,471 [trainer.py] => Average Accuracy (ZS harmonic): 16.574
2023-05-09 21:52:50,471 [trainer.py] => Average Accuracy (ZS total): 33.232
2023-05-09 21:52:50,472 [trainer.py] => All params: 153305089
2023-05-09 21:52:50,473 [trainer.py] => Trainable params: 2627585
2023-05-09 21:52:50,485 [memo_transformer.py] => Learning on 50-60
2023-05-09 21:54:31,648 [trainer.py] => config: ././exp5_mlp//food101/food101_memo_transformer_clip_5_0.002_32_0.005.json
2023-05-09 21:54:31,648 [trainer.py] => prefix: reproduce
2023-05-09 21:54:31,648 [trainer.py] => dataset: food101
2023-05-09 21:54:31,648 [trainer.py] => memory_size: 2000
2023-05-09 21:54:31,648 [trainer.py] => memory_per_class: 20
2023-05-09 21:54:31,648 [trainer.py] => fixed_memory: False
2023-05-09 21:54:31,648 [trainer.py] => shuffle: True
2023-05-09 21:54:31,649 [trainer.py] => init_cls: 10
2023-05-09 21:54:31,649 [trainer.py] => increment: 10
2023-05-09 21:54:31,649 [trainer.py] => model_name: memo_transformer
2023-05-09 21:54:31,649 [trainer.py] => convnet_type: clip
2023-05-09 21:54:31,649 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 21:54:31,649 [trainer.py] => seed: 1993
2023-05-09 21:54:31,649 [trainer.py] => projection_type: mlp
2023-05-09 21:54:31,649 [trainer.py] => fusion_choice: transformer
2023-05-09 21:54:31,649 [trainer.py] => split_train: False
2023-05-09 21:54:31,649 [trainer.py] => tsne_option: False
2023-05-09 21:54:31,649 [trainer.py] => laion_check: False
2023-05-09 21:54:31,649 [trainer.py] => train_tasks: 999
2023-05-09 21:54:31,649 [trainer.py] => frozen_layers: visual
2023-05-09 21:54:31,649 [trainer.py] => tuned_epoch: 5
2023-05-09 21:54:31,649 [trainer.py] => first_epoch: 5
2023-05-09 21:54:31,649 [trainer.py] => init_lr: 0.002
2023-05-09 21:54:31,649 [trainer.py] => batch_size: 32
2023-05-09 21:54:31,649 [trainer.py] => weight_decay: 0.005
2023-05-09 21:54:31,649 [trainer.py] => min_lr: 0
2023-05-09 21:54:31,649 [trainer.py] => optimizer: sgd
2023-05-09 21:54:32,116 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 21:54:43,872 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 21:54:43,873 [trainer.py] => CNN: {'total': 88.07, '00-09': 88.32, '10-19': 88.3, '20-29': 86.12, '30-39': 85.53, '40-49': 87.57, '50-59': 92.64, 'old': 87.16, 'new': 92.64, 'harmonic': 89.82}
2023-05-09 21:54:43,874 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 21:54:43,874 [trainer.py] => CNN top1 curve: [97.97, 94.87, 92.55, 90.64, 89.55, 88.07]
2023-05-09 21:54:43,874 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.23, 99.02, 98.6, 98.14]
2023-05-09 21:54:43,874 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-09 21:54:43,874 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-09 21:54:43,874 [trainer.py] => Average Accuracy (CNN): 92.27499999999999
2023-05-09 21:54:43,874 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-09 21:54:43,874 [trainer.py] => ZS seen top1 curve: [96.29, 91.41, 88.78, 86.62, 85.5, 84.83]
2023-05-09 21:54:43,874 [trainer.py] => ZS unseen top1 curve: [72.83, 77.94, 77.99, 76.8, 77.32, 77.64]
2023-05-09 21:54:43,874 [trainer.py] => ZS harmonic top1 curve: [82.93, 84.14, 83.04, 81.41, 81.2, 81.08]
2023-05-09 21:54:43,874 [trainer.py] => ZS total top1 curve: [75.2, 80.63, 81.23, 80.76, 81.42, 81.97]
2023-05-09 21:54:43,874 [trainer.py] => Average Accuracy (ZS seen): 88.90500000000002
2023-05-09 21:54:43,874 [trainer.py] => Average Accuracy (ZS unseen): 76.75333333333333
2023-05-09 21:54:43,874 [trainer.py] => Average Accuracy (ZS harmonic): 82.3
2023-05-09 21:54:43,874 [trainer.py] => Average Accuracy (ZS total): 80.20166666666667
2023-05-09 21:54:43,875 [trainer.py] => All params: 153831937
2023-05-09 21:54:43,876 [trainer.py] => Trainable params: 2890241
2023-05-09 21:54:43,888 [memo_transformer.py] => Learning on 60-70
2023-05-09 21:55:13,728 [instantiator.py] => Created a temporary directory at /tmp/tmpunattmgr
2023-05-09 21:55:13,729 [instantiator.py] => Writing /tmp/tmpunattmgr/_remote_module_non_sriptable.py
2023-05-09 21:55:13,920 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 21:55:16,771 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 21:55:17,437 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 21:55:20,153 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 21:55:21,385 [trainer.py] => All params: 150670849
2023-05-09 21:55:21,385 [trainer.py] => Trainable params: 150670849
2023-05-09 21:55:24,091 [memo_transformer.py] => Learning on 0-10
2023-05-09 21:56:20,103 [memo_transformer.py] => Task 7, Epoch 7/5 => Loss 2.216, Train_acc 93.74, Test_acc 85.93
2023-05-09 21:56:20,108 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 21:56:20,112 [base.py] => Reducing exemplars...(25 per classes)
2023-05-09 21:57:10,143 [base.py] => Constructing exemplars...(25 per classes)
2023-05-09 21:59:53,162 [memo_transformer.py] => Task 0, Epoch 5/5 => Loss 1.557, Train_acc 98.53, Test_acc 97.92
2023-05-09 21:59:53,210 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0] 
2023-05-09 21:59:53,210 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 21:59:53,211 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 22:02:15,684 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 22:02:15,687 [trainer.py] => CNN: {'total': 85.93, '00-09': 88.17, '10-19': 88.25, '20-29': 84.07, '30-39': 85.78, '40-49': 88.02, '50-59': 85.02, '60-69': 80.66, '70-79': 87.46, 'old': 85.71, 'new': 87.46, 'harmonic': 86.58}
2023-05-09 22:02:15,687 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-09 22:02:15,687 [trainer.py] => CNN top1 curve: [97.82, 94.44, 92.43, 90.88, 89.78, 88.44, 86.46, 85.93]
2023-05-09 22:02:15,687 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27, 98.97, 98.74, 98.27, 97.82, 97.49]
2023-05-09 22:02:15,687 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-09 22:02:15,687 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-09 22:02:15,687 [trainer.py] => Average Accuracy (CNN): 90.77250000000001
2023-05-09 22:02:15,687 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-09 22:02:15,687 [trainer.py] => ZS seen top1 curve: [96.68, 92.07, 88.08, 87.18, 86.51, 85.86, 84.59, 84.61]
2023-05-09 22:02:15,687 [trainer.py] => ZS unseen top1 curve: [65.32, 74.04, 77.41, 77.52, 77.29, 77.48, 79.45, 78.12]
2023-05-09 22:02:15,687 [trainer.py] => ZS harmonic top1 curve: [77.96, 82.08, 82.4, 82.07, 81.64, 81.46, 81.94, 81.24]
2023-05-09 22:02:15,687 [trainer.py] => ZS total top1 curve: [68.49, 77.64, 80.61, 81.41, 81.92, 82.53, 83.06, 83.32]
2023-05-09 22:02:15,687 [trainer.py] => Average Accuracy (ZS seen): 88.1975
2023-05-09 22:02:15,687 [trainer.py] => Average Accuracy (ZS unseen): 75.82875000000001
2023-05-09 22:02:15,687 [trainer.py] => Average Accuracy (ZS harmonic): 81.34875
2023-05-09 22:02:15,687 [trainer.py] => Average Accuracy (ZS total): 79.8725
2023-05-09 22:02:15,689 [trainer.py] => All params: 154885633
2023-05-09 22:02:15,689 [trainer.py] => Trainable params: 3415553
2023-05-09 22:02:15,702 [memo_transformer.py] => Learning on 80-90
2023-05-09 22:02:24,182 [memo_transformer.py] => Task 5, Epoch 5/5 => Loss 1.280, Train_acc 98.23, Test_acc 88.42
2023-05-09 22:02:24,187 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:02:24,191 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 22:02:39,048 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 22:02:39,086 [trainer.py] => CNN: {'total': 97.92, '00-09': 97.92, 'old': 0, 'new': 97.92, 'harmonic': 0.0}
2023-05-09 22:02:39,086 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 22:02:39,086 [trainer.py] => CNN top1 curve: [97.92]
2023-05-09 22:02:39,086 [trainer.py] => CNN top5 curve: [99.95]
2023-05-09 22:02:39,086 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 22:02:39,086 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 22:02:39,086 [trainer.py] => Average Accuracy (CNN): 97.92
2023-05-09 22:02:39,086 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 22:02:39,086 [trainer.py] => ZS seen top1 curve: [97.33]
2023-05-09 22:02:39,086 [trainer.py] => ZS unseen top1 curve: [60.71]
2023-05-09 22:02:39,086 [trainer.py] => ZS harmonic top1 curve: [74.78]
2023-05-09 22:02:39,086 [trainer.py] => ZS total top1 curve: [64.41]
2023-05-09 22:02:39,086 [trainer.py] => Average Accuracy (ZS seen): 97.33
2023-05-09 22:02:39,086 [trainer.py] => Average Accuracy (ZS unseen): 60.71
2023-05-09 22:02:39,086 [trainer.py] => Average Accuracy (ZS harmonic): 74.78
2023-05-09 22:02:39,086 [trainer.py] => Average Accuracy (ZS total): 64.41
2023-05-09 22:02:39,087 [trainer.py] => All params: 151197697
2023-05-09 22:02:39,088 [trainer.py] => Trainable params: 1576961
2023-05-09 22:02:39,107 [memo_transformer.py] => Learning on 10-20
2023-05-09 22:02:48,838 [memo_transformer.py] => Task 6, Epoch 7/5 => Loss 2.149, Train_acc 94.27, Test_acc 85.69
2023-05-09 22:02:48,839 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:02:48,839 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 22:03:07,064 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 22:03:34,834 [base.py] => Constructing exemplars...(28 per classes)
2023-05-09 22:07:25,509 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 22:07:25,523 [trainer.py] => CNN: {'total': 88.42, '00-09': 88.42, '10-19': 88.35, '20-29': 85.47, '30-39': 86.31, '40-49': 89.88, '50-59': 92.14, 'old': 87.68, 'new': 92.14, 'harmonic': 89.85}
2023-05-09 22:07:25,523 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 22:07:25,523 [trainer.py] => CNN top1 curve: [97.92, 94.49, 92.61, 91.02, 89.41, 88.42]
2023-05-09 22:07:25,523 [trainer.py] => CNN top5 curve: [99.95, 99.55, 99.3, 98.8, 98.39, 98.02]
2023-05-09 22:07:25,523 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-09 22:07:25,523 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-09 22:07:25,523 [trainer.py] => Average Accuracy (CNN): 92.31166666666665
2023-05-09 22:07:25,523 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-09 22:07:25,523 [trainer.py] => ZS seen top1 curve: [97.87, 94.44, 92.08, 90.36, 88.94, 87.86]
2023-05-09 22:07:25,523 [trainer.py] => ZS unseen top1 curve: [1.37, 4.42, 8.77, 14.12, 18.99, 21.94]
2023-05-09 22:07:25,523 [trainer.py] => ZS harmonic top1 curve: [2.7, 8.44, 16.01, 24.42, 31.3, 35.11]
2023-05-09 22:07:25,523 [trainer.py] => ZS total top1 curve: [11.11, 22.39, 33.74, 44.82, 54.1, 61.65]
2023-05-09 22:07:25,524 [trainer.py] => Average Accuracy (ZS seen): 91.925
2023-05-09 22:07:25,524 [trainer.py] => Average Accuracy (ZS unseen): 11.601666666666667
2023-05-09 22:07:25,524 [trainer.py] => Average Accuracy (ZS harmonic): 19.663333333333334
2023-05-09 22:07:25,524 [trainer.py] => Average Accuracy (ZS total): 37.968333333333334
2023-05-09 22:07:25,525 [trainer.py] => All params: 153831937
2023-05-09 22:07:25,526 [trainer.py] => Trainable params: 2890241
2023-05-09 22:07:25,539 [memo_transformer.py] => Learning on 60-70
2023-05-09 22:07:46,736 [memo_transformer.py] => Exemplar size: 1960
2023-05-09 22:07:46,737 [trainer.py] => CNN: {'total': 85.69, '00-09': 85.25, '10-19': 88.56, '20-29': 84.27, '30-39': 86.8, '40-49': 88.27, '50-59': 82.59, '60-69': 84.14, 'old': 85.95, 'new': 84.14, 'harmonic': 85.04}
2023-05-09 22:07:46,737 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-09 22:07:46,737 [trainer.py] => CNN top1 curve: [97.82, 94.64, 92.43, 91.11, 89.68, 88.18, 85.69]
2023-05-09 22:07:46,737 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.22, 98.82, 98.46, 98.13, 97.71]
2023-05-09 22:07:46,737 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-09 22:07:46,737 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-09 22:07:46,737 [trainer.py] => Average Accuracy (CNN): 91.36428571428571
2023-05-09 22:07:46,737 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-09 22:07:46,738 [trainer.py] => ZS seen top1 curve: [97.87, 94.67, 91.83, 90.74, 89.23, 87.5, 85.32]
2023-05-09 22:07:46,738 [trainer.py] => ZS unseen top1 curve: [0.56, 2.92, 5.59, 11.21, 16.46, 23.3, 26.12]
2023-05-09 22:07:46,738 [trainer.py] => ZS harmonic top1 curve: [1.11, 5.67, 10.54, 19.95, 27.79, 36.8, 40.0]
2023-05-09 22:07:46,738 [trainer.py] => ZS total top1 curve: [10.38, 21.24, 31.44, 43.23, 52.99, 61.97, 67.63]
2023-05-09 22:07:46,738 [trainer.py] => Average Accuracy (ZS seen): 91.02285714285715
2023-05-09 22:07:46,738 [trainer.py] => Average Accuracy (ZS unseen): 12.30857142857143
2023-05-09 22:07:46,738 [trainer.py] => Average Accuracy (ZS harmonic): 20.26571428571429
2023-05-09 22:07:46,738 [trainer.py] => Average Accuracy (ZS total): 41.26857142857143
2023-05-09 22:07:46,739 [trainer.py] => All params: 154358785
2023-05-09 22:07:46,740 [trainer.py] => Trainable params: 3152897
2023-05-09 22:07:46,752 [memo_transformer.py] => Learning on 70-80
2023-05-09 22:08:51,059 [memo_transformer.py] => Task 1, Epoch 5/5 => Loss 1.540, Train_acc 95.61, Test_acc 95.02
2023-05-09 22:08:51,105 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:08:51,106 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 22:09:10,965 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 22:09:12,715 [memo_transformer.py] => Task 6, Epoch 7/5 => Loss 2.430, Train_acc 89.09, Test_acc 85.77
2023-05-09 22:09:12,731 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:09:12,736 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 22:09:59,038 [base.py] => Constructing exemplars...(28 per classes)
2023-05-09 22:12:13,423 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 22:12:13,441 [trainer.py] => CNN: {'total': 95.02, '00-09': 96.24, '10-19': 93.77, 'old': 96.24, 'new': 93.77, 'harmonic': 94.99}
2023-05-09 22:12:13,441 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 22:12:13,441 [trainer.py] => CNN top1 curve: [97.92, 95.02]
2023-05-09 22:12:13,441 [trainer.py] => CNN top5 curve: [99.95, 99.47]
2023-05-09 22:12:13,441 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 22:12:13,441 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 22:12:13,441 [trainer.py] => Average Accuracy (CNN): 96.47
2023-05-09 22:12:13,441 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 22:12:13,441 [trainer.py] => ZS seen top1 curve: [97.33, 93.07]
2023-05-09 22:12:13,441 [trainer.py] => ZS unseen top1 curve: [60.71, 73.86]
2023-05-09 22:12:13,441 [trainer.py] => ZS harmonic top1 curve: [74.78, 82.36]
2023-05-09 22:12:13,441 [trainer.py] => ZS total top1 curve: [64.41, 77.69]
2023-05-09 22:12:13,441 [trainer.py] => Average Accuracy (ZS seen): 95.19999999999999
2023-05-09 22:12:13,441 [trainer.py] => Average Accuracy (ZS unseen): 67.285
2023-05-09 22:12:13,441 [trainer.py] => Average Accuracy (ZS harmonic): 78.57
2023-05-09 22:12:13,441 [trainer.py] => Average Accuracy (ZS total): 71.05
2023-05-09 22:12:13,442 [trainer.py] => All params: 151724545
2023-05-09 22:12:13,443 [trainer.py] => Trainable params: 1839617
2023-05-09 22:12:13,456 [memo_transformer.py] => Learning on 20-30
2023-05-09 22:14:14,918 [memo_transformer.py] => Exemplar size: 1960
2023-05-09 22:14:14,919 [trainer.py] => CNN: {'total': 85.77, '00-09': 88.66, '10-19': 86.53, '20-29': 84.37, '30-39': 83.59, '40-49': 86.01, '50-59': 83.88, '60-69': 87.42, 'old': 85.5, 'new': 87.42, 'harmonic': 86.45}
2023-05-09 22:14:14,919 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-09 22:14:14,919 [trainer.py] => CNN top1 curve: [97.97, 94.87, 92.55, 90.64, 89.55, 88.07, 85.77]
2023-05-09 22:14:14,919 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.23, 99.02, 98.6, 98.14, 97.63]
2023-05-09 22:14:14,919 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-09 22:14:14,919 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-09 22:14:14,919 [trainer.py] => Average Accuracy (CNN): 91.34571428571428
2023-05-09 22:14:14,919 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-09 22:14:14,919 [trainer.py] => ZS seen top1 curve: [96.29, 91.41, 88.78, 86.62, 85.5, 84.83, 83.1]
2023-05-09 22:14:14,919 [trainer.py] => ZS unseen top1 curve: [72.83, 77.94, 77.99, 76.8, 77.32, 77.64, 80.48]
2023-05-09 22:14:14,919 [trainer.py] => ZS harmonic top1 curve: [82.93, 84.14, 83.04, 81.41, 81.2, 81.08, 81.77]
2023-05-09 22:14:14,919 [trainer.py] => ZS total top1 curve: [75.2, 80.63, 81.23, 80.76, 81.42, 81.97, 82.32]
2023-05-09 22:14:14,919 [trainer.py] => Average Accuracy (ZS seen): 88.0757142857143
2023-05-09 22:14:14,919 [trainer.py] => Average Accuracy (ZS unseen): 77.28571428571429
2023-05-09 22:14:14,919 [trainer.py] => Average Accuracy (ZS harmonic): 82.2242857142857
2023-05-09 22:14:14,919 [trainer.py] => Average Accuracy (ZS total): 80.50428571428571
2023-05-09 22:14:14,920 [trainer.py] => All params: 154358785
2023-05-09 22:14:14,921 [trainer.py] => Trainable params: 3152897
2023-05-09 22:14:14,934 [memo_transformer.py] => Learning on 70-80
2023-05-09 22:17:51,110 [memo_transformer.py] => Task 6, Epoch 5/5 => Loss 1.507, Train_acc 95.48, Test_acc 85.94
2023-05-09 22:17:51,188 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:17:51,193 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 22:18:36,150 [base.py] => Constructing exemplars...(28 per classes)
2023-05-09 22:18:38,708 [memo_transformer.py] => Task 8, Epoch 7/5 => Loss 2.236, Train_acc 93.38, Test_acc 85.68
2023-05-09 22:18:38,711 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:18:38,711 [base.py] => Reducing exemplars...(22 per classes)
2023-05-09 22:19:11,760 [memo_transformer.py] => Task 2, Epoch 5/5 => Loss 1.546, Train_acc 94.92, Test_acc 92.88
2023-05-09 22:19:11,782 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:19:11,786 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 22:19:31,471 [base.py] => Constructing exemplars...(22 per classes)
2023-05-09 22:19:38,636 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 22:22:54,920 [memo_transformer.py] => Task 7, Epoch 7/5 => Loss 1.870, Train_acc 97.72, Test_acc 85.30
2023-05-09 22:22:54,941 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:22:54,942 [base.py] => Reducing exemplars...(25 per classes)
2023-05-09 22:23:00,378 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 22:23:00,407 [trainer.py] => CNN: {'total': 92.88, '00-09': 94.26, '10-19': 92.35, '20-29': 92.01, 'old': 93.32, 'new': 92.01, 'harmonic': 92.66}
2023-05-09 22:23:00,407 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 22:23:00,407 [trainer.py] => CNN top1 curve: [97.92, 95.02, 92.88]
2023-05-09 22:23:00,407 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.32]
2023-05-09 22:23:00,407 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 22:23:00,407 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 22:23:00,407 [trainer.py] => Average Accuracy (CNN): 95.27333333333333
2023-05-09 22:23:00,407 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 22:23:00,407 [trainer.py] => ZS seen top1 curve: [97.33, 93.07, 88.61]
2023-05-09 22:23:00,407 [trainer.py] => ZS unseen top1 curve: [60.71, 73.86, 76.82]
2023-05-09 22:23:00,407 [trainer.py] => ZS harmonic top1 curve: [74.78, 82.36, 82.29]
2023-05-09 22:23:00,407 [trainer.py] => ZS total top1 curve: [64.41, 77.69, 80.36]
2023-05-09 22:23:00,407 [trainer.py] => Average Accuracy (ZS seen): 93.00333333333333
2023-05-09 22:23:00,407 [trainer.py] => Average Accuracy (ZS unseen): 70.46333333333332
2023-05-09 22:23:00,407 [trainer.py] => Average Accuracy (ZS harmonic): 79.81
2023-05-09 22:23:00,407 [trainer.py] => Average Accuracy (ZS total): 74.15333333333332
2023-05-09 22:23:00,408 [trainer.py] => All params: 152251393
2023-05-09 22:23:00,409 [trainer.py] => Trainable params: 2102273
2023-05-09 22:23:00,439 [memo_transformer.py] => Learning on 30-40
2023-05-09 22:23:07,146 [memo_transformer.py] => Exemplar size: 1960
2023-05-09 22:23:07,190 [trainer.py] => CNN: {'total': 85.94, '00-09': 85.74, '10-19': 88.15, '20-29': 83.47, '30-39': 86.41, '40-49': 87.27, '50-59': 83.63, '60-69': 86.92, 'old': 85.77, 'new': 86.92, 'harmonic': 86.34}
2023-05-09 22:23:07,190 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-09 22:23:07,190 [trainer.py] => CNN top1 curve: [97.92, 94.49, 92.61, 91.02, 89.41, 88.42, 85.94]
2023-05-09 22:23:07,190 [trainer.py] => CNN top5 curve: [99.95, 99.55, 99.3, 98.8, 98.39, 98.02, 97.59]
2023-05-09 22:23:07,190 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-09 22:23:07,190 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-09 22:23:07,190 [trainer.py] => Average Accuracy (CNN): 91.40142857142857
2023-05-09 22:23:07,191 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-09 22:23:07,191 [trainer.py] => ZS seen top1 curve: [97.87, 94.44, 92.08, 90.36, 88.94, 87.86, 85.3]
2023-05-09 22:23:07,191 [trainer.py] => ZS unseen top1 curve: [1.37, 4.42, 8.77, 14.12, 18.99, 21.94, 30.02]
2023-05-09 22:23:07,191 [trainer.py] => ZS harmonic top1 curve: [2.7, 8.44, 16.01, 24.42, 31.3, 35.11, 44.41]
2023-05-09 22:23:07,191 [trainer.py] => ZS total top1 curve: [11.11, 22.39, 33.74, 44.82, 54.1, 61.65, 68.79]
2023-05-09 22:23:07,191 [trainer.py] => Average Accuracy (ZS seen): 90.97857142857141
2023-05-09 22:23:07,191 [trainer.py] => Average Accuracy (ZS unseen): 14.232857142857142
2023-05-09 22:23:07,191 [trainer.py] => Average Accuracy (ZS harmonic): 23.198571428571427
2023-05-09 22:23:07,191 [trainer.py] => Average Accuracy (ZS total): 42.371428571428574
2023-05-09 22:23:07,192 [trainer.py] => All params: 154358785
2023-05-09 22:23:07,193 [trainer.py] => Trainable params: 3152897
2023-05-09 22:23:07,206 [memo_transformer.py] => Learning on 70-80
2023-05-09 22:23:58,893 [base.py] => Constructing exemplars...(25 per classes)
2023-05-09 22:25:00,478 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 22:25:00,482 [trainer.py] => CNN: {'total': 85.68, '00-09': 88.12, '10-19': 88.1, '20-29': 84.67, '30-39': 84.71, '40-49': 86.61, '50-59': 84.83, '60-69': 78.03, '70-79': 88.16, '80-89': 87.9, 'old': 85.41, 'new': 87.9, 'harmonic': 86.64}
2023-05-09 22:25:00,482 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-09 22:25:00,482 [trainer.py] => CNN top1 curve: [97.82, 94.44, 92.43, 90.88, 89.78, 88.44, 86.46, 85.93, 85.68]
2023-05-09 22:25:00,483 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27, 98.97, 98.74, 98.27, 97.82, 97.49, 97.3]
2023-05-09 22:25:00,483 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-09 22:25:00,483 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-09 22:25:00,483 [trainer.py] => Average Accuracy (CNN): 90.20666666666668
2023-05-09 22:25:00,483 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-09 22:25:00,483 [trainer.py] => ZS seen top1 curve: [96.68, 92.07, 88.08, 87.18, 86.51, 85.86, 84.59, 84.61, 84.48]
2023-05-09 22:25:00,483 [trainer.py] => ZS unseen top1 curve: [65.32, 74.04, 77.41, 77.52, 77.29, 77.48, 79.45, 78.12, 75.15]
2023-05-09 22:25:00,483 [trainer.py] => ZS harmonic top1 curve: [77.96, 82.08, 82.4, 82.07, 81.64, 81.46, 81.94, 81.24, 79.54]
2023-05-09 22:25:00,483 [trainer.py] => ZS total top1 curve: [68.49, 77.64, 80.61, 81.41, 81.92, 82.53, 83.06, 83.32, 83.55]
2023-05-09 22:25:00,483 [trainer.py] => Average Accuracy (ZS seen): 87.78444444444445
2023-05-09 22:25:00,483 [trainer.py] => Average Accuracy (ZS unseen): 75.75333333333334
2023-05-09 22:25:00,483 [trainer.py] => Average Accuracy (ZS harmonic): 81.14777777777778
2023-05-09 22:25:00,483 [trainer.py] => Average Accuracy (ZS total): 80.2811111111111
2023-05-09 22:25:00,484 [trainer.py] => All params: 155412481
2023-05-09 22:25:00,485 [trainer.py] => Trainable params: 3678209
2023-05-09 22:25:00,525 [memo_transformer.py] => Learning on 90-100
2023-05-09 22:28:24,828 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 22:28:24,839 [trainer.py] => CNN: {'total': 85.3, '00-09': 87.18, '10-19': 87.54, '20-29': 82.53, '30-39': 84.03, '40-49': 88.73, '50-59': 83.23, '60-69': 78.03, '70-79': 91.1, 'old': 84.47, 'new': 91.1, 'harmonic': 87.66}
2023-05-09 22:28:24,839 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-09 22:28:24,839 [trainer.py] => CNN top1 curve: [97.82, 94.64, 92.43, 91.11, 89.68, 88.18, 85.69, 85.3]
2023-05-09 22:28:24,839 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.22, 98.82, 98.46, 98.13, 97.71, 97.23]
2023-05-09 22:28:24,839 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-09 22:28:24,839 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-09 22:28:24,839 [trainer.py] => Average Accuracy (CNN): 90.60624999999999
2023-05-09 22:28:24,839 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-09 22:28:24,839 [trainer.py] => ZS seen top1 curve: [97.87, 94.67, 91.83, 90.74, 89.23, 87.5, 85.32, 84.47]
2023-05-09 22:28:24,839 [trainer.py] => ZS unseen top1 curve: [0.56, 2.92, 5.59, 11.21, 16.46, 23.3, 26.12, 30.36]
2023-05-09 22:28:24,839 [trainer.py] => ZS harmonic top1 curve: [1.11, 5.67, 10.54, 19.95, 27.79, 36.8, 40.0, 44.67]
2023-05-09 22:28:24,839 [trainer.py] => ZS total top1 curve: [10.38, 21.24, 31.44, 43.23, 52.99, 61.97, 67.63, 73.72]
2023-05-09 22:28:24,840 [trainer.py] => Average Accuracy (ZS seen): 90.20375000000001
2023-05-09 22:28:24,840 [trainer.py] => Average Accuracy (ZS unseen): 14.565000000000001
2023-05-09 22:28:24,840 [trainer.py] => Average Accuracy (ZS harmonic): 23.316250000000004
2023-05-09 22:28:24,840 [trainer.py] => Average Accuracy (ZS total): 45.325
2023-05-09 22:28:24,841 [trainer.py] => All params: 154885633
2023-05-09 22:28:24,842 [trainer.py] => Trainable params: 3415553
2023-05-09 22:28:24,855 [memo_transformer.py] => Learning on 80-90
2023-05-09 22:29:54,226 [memo_transformer.py] => Task 7, Epoch 7/5 => Loss 2.157, Train_acc 92.18, Test_acc 85.15
2023-05-09 22:29:54,233 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:29:54,238 [base.py] => Reducing exemplars...(25 per classes)
2023-05-09 22:30:45,909 [memo_transformer.py] => Task 3, Epoch 5/5 => Loss 1.550, Train_acc 94.86, Test_acc 91.50
2023-05-09 22:30:45,953 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:30:45,958 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 22:30:47,863 [base.py] => Constructing exemplars...(25 per classes)
2023-05-09 22:31:23,027 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 22:34:18,156 [memo_transformer.py] => Task 7, Epoch 5/5 => Loss 1.271, Train_acc 98.70, Test_acc 85.26
2023-05-09 22:34:18,192 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:34:18,193 [base.py] => Reducing exemplars...(25 per classes)
2023-05-09 22:34:59,088 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 22:34:59,129 [trainer.py] => CNN: {'total': 91.5, '00-09': 92.03, '10-19': 91.54, '20-29': 90.56, '30-39': 91.84, 'old': 91.38, 'new': 91.84, 'harmonic': 91.61}
2023-05-09 22:34:59,129 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 22:34:59,129 [trainer.py] => CNN top1 curve: [97.92, 95.02, 92.88, 91.5]
2023-05-09 22:34:59,129 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.32, 99.12]
2023-05-09 22:34:59,129 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 22:34:59,130 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 22:34:59,130 [trainer.py] => Average Accuracy (CNN): 94.33
2023-05-09 22:34:59,130 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 22:34:59,130 [trainer.py] => ZS seen top1 curve: [97.33, 93.07, 88.61, 88.2]
2023-05-09 22:34:59,130 [trainer.py] => ZS unseen top1 curve: [60.71, 73.86, 76.82, 76.75]
2023-05-09 22:34:59,130 [trainer.py] => ZS harmonic top1 curve: [74.78, 82.36, 82.29, 82.08]
2023-05-09 22:34:59,130 [trainer.py] => ZS total top1 curve: [64.41, 77.69, 80.36, 81.36]
2023-05-09 22:34:59,130 [trainer.py] => Average Accuracy (ZS seen): 91.8025
2023-05-09 22:34:59,130 [trainer.py] => Average Accuracy (ZS unseen): 72.035
2023-05-09 22:34:59,130 [trainer.py] => Average Accuracy (ZS harmonic): 80.3775
2023-05-09 22:34:59,130 [trainer.py] => Average Accuracy (ZS total): 75.955
2023-05-09 22:34:59,131 [trainer.py] => All params: 152778241
2023-05-09 22:34:59,132 [trainer.py] => Trainable params: 2364929
2023-05-09 22:34:59,146 [memo_transformer.py] => Learning on 40-50
2023-05-09 22:35:10,524 [base.py] => Constructing exemplars...(25 per classes)
2023-05-09 22:35:16,957 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 22:35:16,958 [trainer.py] => CNN: {'total': 85.15, '00-09': 86.73, '10-19': 86.53, '20-29': 83.62, '30-39': 82.62, '40-49': 85.15, '50-59': 83.73, '60-69': 79.75, '70-79': 93.05, 'old': 84.02, 'new': 93.05, 'harmonic': 88.3}
2023-05-09 22:35:16,958 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-09 22:35:16,958 [trainer.py] => CNN top1 curve: [97.97, 94.87, 92.55, 90.64, 89.55, 88.07, 85.77, 85.15]
2023-05-09 22:35:16,958 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.23, 99.02, 98.6, 98.14, 97.63, 97.29]
2023-05-09 22:35:16,958 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-09 22:35:16,958 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-09 22:35:16,958 [trainer.py] => Average Accuracy (CNN): 90.57124999999999
2023-05-09 22:35:16,958 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-09 22:35:16,958 [trainer.py] => ZS seen top1 curve: [96.29, 91.41, 88.78, 86.62, 85.5, 84.83, 83.1, 82.15]
2023-05-09 22:35:16,958 [trainer.py] => ZS unseen top1 curve: [72.83, 77.94, 77.99, 76.8, 77.32, 77.64, 80.48, 78.82]
2023-05-09 22:35:16,958 [trainer.py] => ZS harmonic top1 curve: [82.93, 84.14, 83.04, 81.41, 81.2, 81.08, 81.77, 80.45]
2023-05-09 22:35:16,958 [trainer.py] => ZS total top1 curve: [75.2, 80.63, 81.23, 80.76, 81.42, 81.97, 82.32, 81.49]
2023-05-09 22:35:16,959 [trainer.py] => Average Accuracy (ZS seen): 87.33500000000001
2023-05-09 22:35:16,959 [trainer.py] => Average Accuracy (ZS unseen): 77.47749999999999
2023-05-09 22:35:16,959 [trainer.py] => Average Accuracy (ZS harmonic): 82.0025
2023-05-09 22:35:16,959 [trainer.py] => Average Accuracy (ZS total): 80.6275
2023-05-09 22:35:16,960 [trainer.py] => All params: 154885633
2023-05-09 22:35:16,961 [trainer.py] => Trainable params: 3415553
2023-05-09 22:35:16,975 [memo_transformer.py] => Learning on 80-90
2023-05-09 22:39:53,108 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 22:39:53,133 [trainer.py] => CNN: {'total': 85.26, '00-09': 86.49, '10-19': 86.18, '20-29': 81.73, '30-39': 82.62, '40-49': 87.97, '50-59': 85.02, '60-69': 79.55, '70-79': 92.55, 'old': 84.22, 'new': 92.55, 'harmonic': 88.19}
2023-05-09 22:39:53,134 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-09 22:39:53,134 [trainer.py] => CNN top1 curve: [97.92, 94.49, 92.61, 91.02, 89.41, 88.42, 85.94, 85.26]
2023-05-09 22:39:53,134 [trainer.py] => CNN top5 curve: [99.95, 99.55, 99.3, 98.8, 98.39, 98.02, 97.59, 97.06]
2023-05-09 22:39:53,134 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-09 22:39:53,134 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-09 22:39:53,134 [trainer.py] => Average Accuracy (CNN): 90.63374999999999
2023-05-09 22:39:53,134 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-09 22:39:53,134 [trainer.py] => ZS seen top1 curve: [97.87, 94.44, 92.08, 90.36, 88.94, 87.86, 85.3, 84.34]
2023-05-09 22:39:53,134 [trainer.py] => ZS unseen top1 curve: [1.37, 4.42, 8.77, 14.12, 18.99, 21.94, 30.02, 39.59]
2023-05-09 22:39:53,134 [trainer.py] => ZS harmonic top1 curve: [2.7, 8.44, 16.01, 24.42, 31.3, 35.11, 44.41, 53.89]
2023-05-09 22:39:53,134 [trainer.py] => ZS total top1 curve: [11.11, 22.39, 33.74, 44.82, 54.1, 61.65, 68.79, 75.45]
2023-05-09 22:39:53,134 [trainer.py] => Average Accuracy (ZS seen): 90.14874999999999
2023-05-09 22:39:53,134 [trainer.py] => Average Accuracy (ZS unseen): 17.4025
2023-05-09 22:39:53,134 [trainer.py] => Average Accuracy (ZS harmonic): 27.034999999999997
2023-05-09 22:39:53,134 [trainer.py] => Average Accuracy (ZS total): 46.50625
2023-05-09 22:39:53,135 [trainer.py] => All params: 154885633
2023-05-09 22:39:53,136 [trainer.py] => Trainable params: 3415553
2023-05-09 22:39:53,149 [memo_transformer.py] => Learning on 80-90
2023-05-09 22:42:33,544 [memo_transformer.py] => Task 9, Epoch 7/5 => Loss 2.393, Train_acc 91.60, Test_acc 84.23
2023-05-09 22:42:33,574 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:42:33,576 [base.py] => Reducing exemplars...(20 per classes)
2023-05-09 22:43:29,341 [base.py] => Constructing exemplars...(20 per classes)
2023-05-09 22:43:38,256 [memo_transformer.py] => Task 4, Epoch 5/5 => Loss 1.492, Train_acc 95.31, Test_acc 90.37
2023-05-09 22:43:38,288 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:43:38,289 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 22:44:18,980 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 22:44:42,875 [memo_transformer.py] => Task 8, Epoch 7/5 => Loss 1.884, Train_acc 97.63, Test_acc 84.90
2023-05-09 22:44:42,875 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:44:42,880 [base.py] => Reducing exemplars...(22 per classes)
2023-05-09 22:45:38,875 [base.py] => Constructing exemplars...(22 per classes)
2023-05-09 22:48:17,881 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 22:48:17,884 [trainer.py] => CNN: {'total': 90.37, '00-09': 90.4, '10-19': 90.99, '20-29': 88.77, '30-39': 91.26, '40-49': 90.44, 'old': 90.36, 'new': 90.44, 'harmonic': 90.4}
2023-05-09 22:48:17,884 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 22:48:17,884 [trainer.py] => CNN top1 curve: [97.92, 95.02, 92.88, 91.5, 90.37]
2023-05-09 22:48:17,884 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.32, 99.12, 98.77]
2023-05-09 22:48:17,884 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 22:48:17,884 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 22:48:17,884 [trainer.py] => Average Accuracy (CNN): 93.538
2023-05-09 22:48:17,884 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 22:48:17,884 [trainer.py] => ZS seen top1 curve: [97.33, 93.07, 88.61, 88.2, 87.47]
2023-05-09 22:48:17,885 [trainer.py] => ZS unseen top1 curve: [60.71, 73.86, 76.82, 76.75, 77.06]
2023-05-09 22:48:17,885 [trainer.py] => ZS harmonic top1 curve: [74.78, 82.36, 82.29, 82.08, 81.94]
2023-05-09 22:48:17,885 [trainer.py] => ZS total top1 curve: [64.41, 77.69, 80.36, 81.36, 82.29]
2023-05-09 22:48:17,885 [trainer.py] => Average Accuracy (ZS seen): 90.93599999999999
2023-05-09 22:48:17,885 [trainer.py] => Average Accuracy (ZS unseen): 73.03999999999999
2023-05-09 22:48:17,885 [trainer.py] => Average Accuracy (ZS harmonic): 80.69
2023-05-09 22:48:17,885 [trainer.py] => Average Accuracy (ZS total): 77.22200000000001
2023-05-09 22:48:17,886 [trainer.py] => All params: 153305089
2023-05-09 22:48:17,887 [trainer.py] => Trainable params: 2627585
2023-05-09 22:48:17,898 [memo_transformer.py] => Learning on 50-60
2023-05-09 22:49:09,811 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 22:49:09,813 [trainer.py] => CNN: {'total': 84.23, '00-09': 87.77, '10-19': 87.49, '20-29': 82.33, '30-39': 83.69, '40-49': 85.61, '50-59': 84.23, '60-69': 77.02, '70-79': 87.06, '80-89': 87.45, '90-99': 79.64, 'old': 84.74, 'new': 79.64, 'harmonic': 82.11}
2023-05-09 22:49:09,813 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-09 22:49:09,814 [trainer.py] => CNN top1 curve: [97.82, 94.44, 92.43, 90.88, 89.78, 88.44, 86.46, 85.93, 85.68, 84.23]
2023-05-09 22:49:09,814 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.27, 98.97, 98.74, 98.27, 97.82, 97.49, 97.3, 96.97]
2023-05-09 22:49:09,814 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-09 22:49:09,814 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-09 22:49:09,814 [trainer.py] => Average Accuracy (CNN): 89.60900000000001
2023-05-09 22:49:09,814 [trainer.py] => Average Accuracy (NME): 87.828
2023-05-09 22:49:09,814 [trainer.py] => ZS seen top1 curve: [96.68, 92.07, 88.08, 87.18, 86.51, 85.86, 84.59, 84.61, 84.48, 83.8]
2023-05-09 22:49:09,814 [trainer.py] => ZS unseen top1 curve: [65.32, 74.04, 77.41, 77.52, 77.29, 77.48, 79.45, 78.12, 75.15, 0]
2023-05-09 22:49:09,814 [trainer.py] => ZS harmonic top1 curve: [77.96, 82.08, 82.4, 82.07, 81.64, 81.46, 81.94, 81.24, 79.54, 0.0]
2023-05-09 22:49:09,814 [trainer.py] => ZS total top1 curve: [68.49, 77.64, 80.61, 81.41, 81.92, 82.53, 83.06, 83.32, 83.55, 83.8]
2023-05-09 22:49:09,814 [trainer.py] => Average Accuracy (ZS seen): 87.386
2023-05-09 22:49:09,814 [trainer.py] => Average Accuracy (ZS unseen): 68.17800000000001
2023-05-09 22:49:09,814 [trainer.py] => Average Accuracy (ZS harmonic): 73.03299999999999
2023-05-09 22:49:09,814 [trainer.py] => Average Accuracy (ZS total): 80.633
2023-05-09 22:50:21,926 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 22:50:21,930 [trainer.py] => CNN: {'total': 84.9, '00-09': 87.13, '10-19': 84.91, '20-29': 85.42, '30-39': 83.2, '40-49': 86.31, '50-59': 83.23, '60-69': 77.17, '70-79': 85.76, '80-89': 90.91, 'old': 84.15, 'new': 90.91, 'harmonic': 87.4}
2023-05-09 22:50:21,930 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-09 22:50:21,930 [trainer.py] => CNN top1 curve: [97.82, 94.64, 92.43, 91.11, 89.68, 88.18, 85.69, 85.3, 84.9]
2023-05-09 22:50:21,930 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.22, 98.82, 98.46, 98.13, 97.71, 97.23, 96.99]
2023-05-09 22:50:21,930 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-09 22:50:21,930 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-09 22:50:21,930 [trainer.py] => Average Accuracy (CNN): 89.97222222222221
2023-05-09 22:50:21,930 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-09 22:50:21,930 [trainer.py] => ZS seen top1 curve: [97.87, 94.67, 91.83, 90.74, 89.23, 87.5, 85.32, 84.47, 84.13]
2023-05-09 22:50:21,930 [trainer.py] => ZS unseen top1 curve: [0.56, 2.92, 5.59, 11.21, 16.46, 23.3, 26.12, 30.36, 31.55]
2023-05-09 22:50:21,930 [trainer.py] => ZS harmonic top1 curve: [1.11, 5.67, 10.54, 19.95, 27.79, 36.8, 40.0, 44.67, 45.89]
2023-05-09 22:50:21,930 [trainer.py] => ZS total top1 curve: [10.38, 21.24, 31.44, 43.23, 52.99, 61.97, 67.63, 73.72, 78.92]
2023-05-09 22:50:21,931 [trainer.py] => Average Accuracy (ZS seen): 89.5288888888889
2023-05-09 22:50:21,931 [trainer.py] => Average Accuracy (ZS unseen): 16.452222222222225
2023-05-09 22:50:21,931 [trainer.py] => Average Accuracy (ZS harmonic): 25.824444444444445
2023-05-09 22:50:21,931 [trainer.py] => Average Accuracy (ZS total): 49.05777777777778
2023-05-09 22:50:21,932 [trainer.py] => All params: 155412481
2023-05-09 22:50:21,933 [trainer.py] => Trainable params: 3678209
2023-05-09 22:50:21,944 [memo_transformer.py] => Learning on 90-100
2023-05-09 22:51:55,272 [memo_transformer.py] => Task 8, Epoch 5/5 => Loss 1.278, Train_acc 98.60, Test_acc 84.64
2023-05-09 22:51:55,300 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:51:55,300 [base.py] => Reducing exemplars...(22 per classes)
2023-05-09 22:52:00,629 [memo_transformer.py] => Task 8, Epoch 7/5 => Loss 2.188, Train_acc 91.85, Test_acc 84.29
2023-05-09 22:52:00,633 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:52:00,638 [base.py] => Reducing exemplars...(22 per classes)
2023-05-09 22:52:42,704 [base.py] => Constructing exemplars...(22 per classes)
2023-05-09 22:52:50,082 [base.py] => Constructing exemplars...(22 per classes)
2023-05-09 22:55:40,903 [trainer.py] => config: ././exp5_mlp//food101/food101_memo_transformer_clip_3_0.002_32_0.005.json
2023-05-09 22:55:40,920 [trainer.py] => prefix: reproduce
2023-05-09 22:55:40,920 [trainer.py] => dataset: food101
2023-05-09 22:55:40,920 [trainer.py] => memory_size: 2000
2023-05-09 22:55:40,920 [trainer.py] => memory_per_class: 20
2023-05-09 22:55:40,920 [trainer.py] => fixed_memory: False
2023-05-09 22:55:40,920 [trainer.py] => shuffle: True
2023-05-09 22:55:40,920 [trainer.py] => init_cls: 10
2023-05-09 22:55:40,920 [trainer.py] => increment: 10
2023-05-09 22:55:40,920 [trainer.py] => model_name: memo_transformer
2023-05-09 22:55:40,920 [trainer.py] => convnet_type: clip
2023-05-09 22:55:40,920 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 22:55:40,920 [trainer.py] => seed: 1993
2023-05-09 22:55:40,920 [trainer.py] => projection_type: mlp
2023-05-09 22:55:40,920 [trainer.py] => fusion_choice: transformer
2023-05-09 22:55:40,920 [trainer.py] => split_train: False
2023-05-09 22:55:40,920 [trainer.py] => tsne_option: False
2023-05-09 22:55:40,920 [trainer.py] => laion_check: False
2023-05-09 22:55:40,920 [trainer.py] => train_tasks: 999
2023-05-09 22:55:40,920 [trainer.py] => frozen_layers: visual
2023-05-09 22:55:40,920 [trainer.py] => tuned_epoch: 5
2023-05-09 22:55:40,920 [trainer.py] => first_epoch: 3
2023-05-09 22:55:40,920 [trainer.py] => init_lr: 0.002
2023-05-09 22:55:40,920 [trainer.py] => batch_size: 32
2023-05-09 22:55:40,920 [trainer.py] => weight_decay: 0.005
2023-05-09 22:55:40,920 [trainer.py] => min_lr: 0
2023-05-09 22:55:40,920 [trainer.py] => optimizer: sgd
2023-05-09 22:55:41,550 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 22:56:48,325 [instantiator.py] => Created a temporary directory at /tmp/tmp4ui4l2co
2023-05-09 22:56:48,327 [instantiator.py] => Writing /tmp/tmp4ui4l2co/_remote_module_non_sriptable.py
2023-05-09 22:56:50,547 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 22:56:54,650 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 22:56:55,070 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 22:56:57,953 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 22:56:58,399 [trainer.py] => All params: 150670849
2023-05-09 22:56:58,400 [trainer.py] => Trainable params: 150670849
2023-05-09 22:57:05,048 [memo_transformer.py] => Learning on 0-10
2023-05-09 22:57:44,429 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 22:57:44,430 [trainer.py] => CNN: {'total': 84.64, '00-09': 86.53, '10-19': 82.99, '20-29': 83.57, '30-39': 81.6, '40-49': 85.66, '50-59': 84.18, '60-69': 77.58, '70-79': 86.91, '80-89': 92.77, 'old': 83.63, 'new': 92.77, 'harmonic': 87.96}
2023-05-09 22:57:44,430 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-09 22:57:44,430 [trainer.py] => CNN top1 curve: [97.92, 94.49, 92.61, 91.02, 89.41, 88.42, 85.94, 85.26, 84.64]
2023-05-09 22:57:44,430 [trainer.py] => CNN top5 curve: [99.95, 99.55, 99.3, 98.8, 98.39, 98.02, 97.59, 97.06, 96.74]
2023-05-09 22:57:44,430 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-09 22:57:44,430 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-09 22:57:44,430 [trainer.py] => Average Accuracy (CNN): 89.96777777777777
2023-05-09 22:57:44,430 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-09 22:57:44,430 [trainer.py] => ZS seen top1 curve: [97.87, 94.44, 92.08, 90.36, 88.94, 87.86, 85.3, 84.34, 83.94]
2023-05-09 22:57:44,430 [trainer.py] => ZS unseen top1 curve: [1.37, 4.42, 8.77, 14.12, 18.99, 21.94, 30.02, 39.59, 33.01]
2023-05-09 22:57:44,431 [trainer.py] => ZS harmonic top1 curve: [2.7, 8.44, 16.01, 24.42, 31.3, 35.11, 44.41, 53.89, 47.39]
2023-05-09 22:57:44,431 [trainer.py] => ZS total top1 curve: [11.11, 22.39, 33.74, 44.82, 54.1, 61.65, 68.79, 75.45, 78.89]
2023-05-09 22:57:44,431 [trainer.py] => Average Accuracy (ZS seen): 89.45888888888888
2023-05-09 22:57:44,431 [trainer.py] => Average Accuracy (ZS unseen): 19.136666666666667
2023-05-09 22:57:44,431 [trainer.py] => Average Accuracy (ZS harmonic): 29.296666666666663
2023-05-09 22:57:44,431 [trainer.py] => Average Accuracy (ZS total): 50.10444444444445
2023-05-09 22:57:44,433 [trainer.py] => All params: 155412481
2023-05-09 22:57:44,435 [trainer.py] => Trainable params: 3678209
2023-05-09 22:57:44,453 [memo_transformer.py] => Learning on 90-100
2023-05-09 22:57:58,197 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 22:57:58,203 [trainer.py] => CNN: {'total': 84.29, '00-09': 87.03, '10-19': 85.16, '20-29': 83.52, '30-39': 82.04, '40-49': 82.49, '50-59': 83.88, '60-69': 73.89, '70-79': 87.61, '80-89': 92.97, 'old': 83.21, 'new': 92.97, 'harmonic': 87.82}
2023-05-09 22:57:58,203 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-09 22:57:58,203 [trainer.py] => CNN top1 curve: [97.97, 94.87, 92.55, 90.64, 89.55, 88.07, 85.77, 85.15, 84.29]
2023-05-09 22:57:58,203 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.23, 99.02, 98.6, 98.14, 97.63, 97.29, 96.99]
2023-05-09 22:57:58,203 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-09 22:57:58,203 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-09 22:57:58,203 [trainer.py] => Average Accuracy (CNN): 89.87333333333332
2023-05-09 22:57:58,203 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-09 22:57:58,203 [trainer.py] => ZS seen top1 curve: [96.29, 91.41, 88.78, 86.62, 85.5, 84.83, 83.1, 82.15, 82.41]
2023-05-09 22:57:58,203 [trainer.py] => ZS unseen top1 curve: [72.83, 77.94, 77.99, 76.8, 77.32, 77.64, 80.48, 78.82, 74.95]
2023-05-09 22:57:58,203 [trainer.py] => ZS harmonic top1 curve: [82.93, 84.14, 83.04, 81.41, 81.2, 81.08, 81.77, 80.45, 78.5]
2023-05-09 22:57:58,204 [trainer.py] => ZS total top1 curve: [75.2, 80.63, 81.23, 80.76, 81.42, 81.97, 82.32, 81.49, 81.67]
2023-05-09 22:57:58,204 [trainer.py] => Average Accuracy (ZS seen): 86.78777777777778
2023-05-09 22:57:58,204 [trainer.py] => Average Accuracy (ZS unseen): 77.19666666666666
2023-05-09 22:57:58,204 [trainer.py] => Average Accuracy (ZS harmonic): 81.61333333333333
2023-05-09 22:57:58,204 [trainer.py] => Average Accuracy (ZS total): 80.74333333333333
2023-05-09 22:57:58,205 [trainer.py] => All params: 155412481
2023-05-09 22:57:58,206 [trainer.py] => Trainable params: 3678209
2023-05-09 22:57:58,219 [memo_transformer.py] => Learning on 90-100
2023-05-09 22:58:07,438 [memo_transformer.py] => Task 5, Epoch 5/5 => Loss 1.599, Train_acc 94.79, Test_acc 89.22
2023-05-09 22:58:07,445 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 22:58:07,445 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 22:58:53,096 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 23:00:08,168 [memo_transformer.py] => Task 0, Epoch 3/5 => Loss 1.621, Train_acc 98.06, Test_acc 97.97
2023-05-09 23:00:08,172 [memo_transformer.py] => Laion scores: [0, 0, 0] 
2023-05-09 23:00:08,174 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 23:00:08,174 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 23:02:40,467 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 23:02:40,468 [trainer.py] => CNN: {'total': 89.22, '00-09': 89.75, '10-19': 90.53, '20-29': 87.62, '30-39': 89.17, '40-49': 90.64, '50-59': 87.66, 'old': 89.54, 'new': 87.66, 'harmonic': 88.59}
2023-05-09 23:02:40,468 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 23:02:40,468 [trainer.py] => CNN top1 curve: [97.92, 95.02, 92.88, 91.5, 90.37, 89.22]
2023-05-09 23:02:40,468 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.32, 99.12, 98.77, 98.38]
2023-05-09 23:02:40,468 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-09 23:02:40,468 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-09 23:02:40,468 [trainer.py] => Average Accuracy (CNN): 92.81833333333333
2023-05-09 23:02:40,468 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-09 23:02:40,468 [trainer.py] => ZS seen top1 curve: [97.33, 93.07, 88.61, 88.2, 87.47, 86.64]
2023-05-09 23:02:40,468 [trainer.py] => ZS unseen top1 curve: [60.71, 73.86, 76.82, 76.75, 77.06, 77.05]
2023-05-09 23:02:40,468 [trainer.py] => ZS harmonic top1 curve: [74.78, 82.36, 82.29, 82.08, 81.94, 81.56]
2023-05-09 23:02:40,468 [trainer.py] => ZS total top1 curve: [64.41, 77.69, 80.36, 81.36, 82.29, 82.83]
2023-05-09 23:02:40,468 [trainer.py] => Average Accuracy (ZS seen): 90.21999999999998
2023-05-09 23:02:40,468 [trainer.py] => Average Accuracy (ZS unseen): 73.70833333333333
2023-05-09 23:02:40,468 [trainer.py] => Average Accuracy (ZS harmonic): 80.835
2023-05-09 23:02:40,469 [trainer.py] => Average Accuracy (ZS total): 78.15666666666667
2023-05-09 23:02:40,470 [trainer.py] => All params: 153831937
2023-05-09 23:02:40,471 [trainer.py] => Trainable params: 2890241
2023-05-09 23:02:40,487 [memo_transformer.py] => Learning on 60-70
2023-05-09 23:03:22,659 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:03:22,674 [trainer.py] => CNN: {'total': 97.97, '00-09': 97.97, 'old': 0, 'new': 97.97, 'harmonic': 0.0}
2023-05-09 23:03:22,674 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 23:03:22,674 [trainer.py] => CNN top1 curve: [97.97]
2023-05-09 23:03:22,674 [trainer.py] => CNN top5 curve: [99.95]
2023-05-09 23:03:22,674 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 23:03:22,674 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 23:03:22,674 [trainer.py] => Average Accuracy (CNN): 97.97
2023-05-09 23:03:22,674 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 23:03:22,674 [trainer.py] => ZS seen top1 curve: [96.88]
2023-05-09 23:03:22,674 [trainer.py] => ZS unseen top1 curve: [60.73]
2023-05-09 23:03:22,674 [trainer.py] => ZS harmonic top1 curve: [74.66]
2023-05-09 23:03:22,674 [trainer.py] => ZS total top1 curve: [64.38]
2023-05-09 23:03:22,674 [trainer.py] => Average Accuracy (ZS seen): 96.88
2023-05-09 23:03:22,674 [trainer.py] => Average Accuracy (ZS unseen): 60.73
2023-05-09 23:03:22,674 [trainer.py] => Average Accuracy (ZS harmonic): 74.66
2023-05-09 23:03:22,674 [trainer.py] => Average Accuracy (ZS total): 64.38
2023-05-09 23:03:22,675 [trainer.py] => All params: 151197697
2023-05-09 23:03:22,676 [trainer.py] => Trainable params: 1576961
2023-05-09 23:03:22,689 [memo_transformer.py] => Learning on 10-20
2023-05-09 23:07:28,446 [memo_transformer.py] => Task 1, Epoch 3/5 => Loss 1.618, Train_acc 94.41, Test_acc 94.77
2023-05-09 23:07:28,458 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0] 
2023-05-09 23:07:28,458 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 23:07:47,750 [memo_transformer.py] => Task 9, Epoch 7/5 => Loss 1.975, Train_acc 96.80, Test_acc 83.23
2023-05-09 23:07:47,750 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:07:47,751 [base.py] => Reducing exemplars...(20 per classes)
2023-05-09 23:07:55,354 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 23:08:48,272 [base.py] => Constructing exemplars...(20 per classes)
2023-05-09 23:10:37,227 [memo_transformer.py] => Task 9, Epoch 5/5 => Loss 1.363, Train_acc 97.84, Test_acc 83.01
2023-05-09 23:10:37,267 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:10:37,271 [base.py] => Reducing exemplars...(20 per classes)
2023-05-09 23:11:24,397 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:11:24,404 [trainer.py] => CNN: {'total': 94.77, '00-09': 95.94, '10-19': 93.57, 'old': 95.94, 'new': 93.57, 'harmonic': 94.74}
2023-05-09 23:11:24,404 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 23:11:24,404 [trainer.py] => CNN top1 curve: [97.97, 94.77]
2023-05-09 23:11:24,404 [trainer.py] => CNN top5 curve: [99.95, 99.52]
2023-05-09 23:11:24,404 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 23:11:24,404 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 23:11:24,404 [trainer.py] => Average Accuracy (CNN): 96.37
2023-05-09 23:11:24,404 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 23:11:24,404 [trainer.py] => ZS seen top1 curve: [96.88, 92.79]
2023-05-09 23:11:24,404 [trainer.py] => ZS unseen top1 curve: [60.73, 73.39]
2023-05-09 23:11:24,404 [trainer.py] => ZS harmonic top1 curve: [74.66, 81.96]
2023-05-09 23:11:24,405 [trainer.py] => ZS total top1 curve: [64.38, 77.26]
2023-05-09 23:11:24,405 [trainer.py] => Average Accuracy (ZS seen): 94.83500000000001
2023-05-09 23:11:24,405 [trainer.py] => Average Accuracy (ZS unseen): 67.06
2023-05-09 23:11:24,405 [trainer.py] => Average Accuracy (ZS harmonic): 78.31
2023-05-09 23:11:24,405 [trainer.py] => Average Accuracy (ZS total): 70.82
2023-05-09 23:11:24,406 [trainer.py] => All params: 151724545
2023-05-09 23:11:24,407 [trainer.py] => Trainable params: 1839617
2023-05-09 23:11:24,420 [memo_transformer.py] => Learning on 20-30
2023-05-09 23:11:37,517 [base.py] => Constructing exemplars...(20 per classes)
2023-05-09 23:13:05,917 [memo_transformer.py] => Task 6, Epoch 5/5 => Loss 1.890, Train_acc 91.02, Test_acc 87.06
2023-05-09 23:13:05,931 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:13:05,931 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 23:13:49,608 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:13:49,610 [trainer.py] => CNN: {'total': 83.23, '00-09': 85.89, '10-19': 85.62, '20-29': 80.68, '30-39': 81.65, '40-49': 85.41, '50-59': 81.59, '60-69': 74.24, '70-79': 85.71, '80-89': 85.79, '90-99': 85.74, 'old': 82.95, 'new': 85.74, 'harmonic': 84.32}
2023-05-09 23:13:49,610 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-09 23:13:49,610 [trainer.py] => CNN top1 curve: [97.82, 94.64, 92.43, 91.11, 89.68, 88.18, 85.69, 85.3, 84.9, 83.23]
2023-05-09 23:13:49,610 [trainer.py] => CNN top5 curve: [99.9, 99.5, 99.22, 98.82, 98.46, 98.13, 97.71, 97.23, 96.99, 96.45]
2023-05-09 23:13:49,610 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-09 23:13:49,610 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-09 23:13:49,611 [trainer.py] => Average Accuracy (CNN): 89.29799999999999
2023-05-09 23:13:49,611 [trainer.py] => Average Accuracy (NME): 87.828
2023-05-09 23:13:49,611 [trainer.py] => ZS seen top1 curve: [97.87, 94.67, 91.83, 90.74, 89.23, 87.5, 85.32, 84.47, 84.13, 82.38]
2023-05-09 23:13:49,611 [trainer.py] => ZS unseen top1 curve: [0.56, 2.92, 5.59, 11.21, 16.46, 23.3, 26.12, 30.36, 31.55, 0]
2023-05-09 23:13:49,611 [trainer.py] => ZS harmonic top1 curve: [1.11, 5.67, 10.54, 19.95, 27.79, 36.8, 40.0, 44.67, 45.89, 0.0]
2023-05-09 23:13:49,611 [trainer.py] => ZS total top1 curve: [10.38, 21.24, 31.44, 43.23, 52.99, 61.97, 67.63, 73.72, 78.92, 82.38]
2023-05-09 23:13:49,611 [trainer.py] => Average Accuracy (ZS seen): 88.81400000000001
2023-05-09 23:13:49,611 [trainer.py] => Average Accuracy (ZS unseen): 14.807000000000002
2023-05-09 23:13:49,611 [trainer.py] => Average Accuracy (ZS harmonic): 23.242
2023-05-09 23:13:49,611 [trainer.py] => Average Accuracy (ZS total): 52.39000000000001
2023-05-09 23:13:50,601 [base.py] => Constructing exemplars...(28 per classes)
2023-05-09 23:15:52,534 [memo_transformer.py] => Task 9, Epoch 7/5 => Loss 2.363, Train_acc 89.53, Test_acc 82.60
2023-05-09 23:15:52,536 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:15:52,541 [base.py] => Reducing exemplars...(20 per classes)
2023-05-09 23:15:58,187 [memo_transformer.py] => Task 2, Epoch 3/5 => Loss 1.602, Train_acc 93.69, Test_acc 92.88
2023-05-09 23:15:58,190 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:15:58,190 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 23:16:21,205 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:16:21,207 [trainer.py] => CNN: {'total': 83.01, '00-09': 85.1, '10-19': 84.86, '20-29': 76.88, '30-39': 80.73, '40-49': 83.64, '50-59': 81.84, '60-69': 74.04, '70-79': 85.71, '80-89': 86.75, '90-99': 90.62, 'old': 82.17, 'new': 90.62, 'harmonic': 86.19}
2023-05-09 23:16:21,207 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-09 23:16:21,207 [trainer.py] => CNN top1 curve: [97.92, 94.49, 92.61, 91.02, 89.41, 88.42, 85.94, 85.26, 84.64, 83.01]
2023-05-09 23:16:21,207 [trainer.py] => CNN top5 curve: [99.95, 99.55, 99.3, 98.8, 98.39, 98.02, 97.59, 97.06, 96.74, 96.31]
2023-05-09 23:16:21,207 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-09 23:16:21,207 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-09 23:16:21,207 [trainer.py] => Average Accuracy (CNN): 89.27199999999999
2023-05-09 23:16:21,207 [trainer.py] => Average Accuracy (NME): 87.828
2023-05-09 23:16:21,207 [trainer.py] => ZS seen top1 curve: [97.87, 94.44, 92.08, 90.36, 88.94, 87.86, 85.3, 84.34, 83.94, 82.68]
2023-05-09 23:16:21,207 [trainer.py] => ZS unseen top1 curve: [1.37, 4.42, 8.77, 14.12, 18.99, 21.94, 30.02, 39.59, 33.01, 0]
2023-05-09 23:16:21,207 [trainer.py] => ZS harmonic top1 curve: [2.7, 8.44, 16.01, 24.42, 31.3, 35.11, 44.41, 53.89, 47.39, 0.0]
2023-05-09 23:16:21,207 [trainer.py] => ZS total top1 curve: [11.11, 22.39, 33.74, 44.82, 54.1, 61.65, 68.79, 75.45, 78.89, 82.68]
2023-05-09 23:16:21,207 [trainer.py] => Average Accuracy (ZS seen): 88.78099999999999
2023-05-09 23:16:21,207 [trainer.py] => Average Accuracy (ZS unseen): 17.223
2023-05-09 23:16:21,208 [trainer.py] => Average Accuracy (ZS harmonic): 26.366999999999997
2023-05-09 23:16:21,208 [trainer.py] => Average Accuracy (ZS total): 53.362
2023-05-09 23:16:30,861 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 23:16:50,917 [trainer.py] => config: ././exp5_pure_mlp//food101/food101_memo_transformer_clip_3_0.002_32_0.005.json
2023-05-09 23:16:50,917 [trainer.py] => prefix: reproduce
2023-05-09 23:16:50,917 [trainer.py] => dataset: food101
2023-05-09 23:16:50,917 [trainer.py] => memory_size: 2000
2023-05-09 23:16:50,917 [trainer.py] => memory_per_class: 20
2023-05-09 23:16:50,917 [trainer.py] => fixed_memory: False
2023-05-09 23:16:50,917 [trainer.py] => shuffle: True
2023-05-09 23:16:50,917 [trainer.py] => init_cls: 10
2023-05-09 23:16:50,917 [trainer.py] => increment: 10
2023-05-09 23:16:50,918 [trainer.py] => model_name: memo_transformer
2023-05-09 23:16:50,918 [trainer.py] => convnet_type: clip
2023-05-09 23:16:50,918 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 23:16:50,918 [trainer.py] => seed: 1993
2023-05-09 23:16:50,918 [trainer.py] => projection_type: pure_mlp
2023-05-09 23:16:50,918 [trainer.py] => fusion_choice: transformer
2023-05-09 23:16:50,918 [trainer.py] => split_train: False
2023-05-09 23:16:50,918 [trainer.py] => tsne_option: False
2023-05-09 23:16:50,918 [trainer.py] => laion_check: False
2023-05-09 23:16:50,918 [trainer.py] => train_tasks: 999
2023-05-09 23:16:50,918 [trainer.py] => frozen_layers: visual
2023-05-09 23:16:50,918 [trainer.py] => tuned_epoch: 5
2023-05-09 23:16:50,918 [trainer.py] => first_epoch: 3
2023-05-09 23:16:50,918 [trainer.py] => init_lr: 0.002
2023-05-09 23:16:50,918 [trainer.py] => batch_size: 32
2023-05-09 23:16:50,918 [trainer.py] => weight_decay: 0.005
2023-05-09 23:16:50,918 [trainer.py] => min_lr: 0
2023-05-09 23:16:50,918 [trainer.py] => optimizer: sgd
2023-05-09 23:16:51,360 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 23:16:55,783 [base.py] => Constructing exemplars...(20 per classes)
2023-05-09 23:17:44,835 [instantiator.py] => Created a temporary directory at /tmp/tmp5m2kncpj
2023-05-09 23:17:44,836 [instantiator.py] => Writing /tmp/tmp5m2kncpj/_remote_module_non_sriptable.py
2023-05-09 23:17:46,622 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 23:17:50,342 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 23:17:52,135 [memo_transformer.py] => Exemplar size: 1960
2023-05-09 23:17:52,137 [trainer.py] => CNN: {'total': 87.06, '00-09': 88.76, '10-19': 89.67, '20-29': 85.67, '30-39': 88.2, '40-49': 88.78, '50-59': 86.02, '60-69': 82.27, 'old': 87.85, 'new': 82.27, 'harmonic': 84.97}
2023-05-09 23:17:52,137 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-09 23:17:52,137 [trainer.py] => CNN top1 curve: [97.92, 95.02, 92.88, 91.5, 90.37, 89.22, 87.06]
2023-05-09 23:17:52,137 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.32, 99.12, 98.77, 98.38, 97.86]
2023-05-09 23:17:52,137 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-09 23:17:52,137 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-09 23:17:52,137 [trainer.py] => Average Accuracy (CNN): 91.99571428571429
2023-05-09 23:17:52,137 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-09 23:17:52,137 [trainer.py] => ZS seen top1 curve: [97.33, 93.07, 88.61, 88.2, 87.47, 86.64, 85.14]
2023-05-09 23:17:52,137 [trainer.py] => ZS unseen top1 curve: [60.71, 73.86, 76.82, 76.75, 77.06, 77.05, 79.61]
2023-05-09 23:17:52,137 [trainer.py] => ZS harmonic top1 curve: [74.78, 82.36, 82.29, 82.08, 81.94, 81.56, 82.28]
2023-05-09 23:17:52,137 [trainer.py] => ZS total top1 curve: [64.41, 77.69, 80.36, 81.36, 82.29, 82.83, 83.49]
2023-05-09 23:17:52,137 [trainer.py] => Average Accuracy (ZS seen): 89.49428571428571
2023-05-09 23:17:52,137 [trainer.py] => Average Accuracy (ZS unseen): 74.55142857142857
2023-05-09 23:17:52,137 [trainer.py] => Average Accuracy (ZS harmonic): 81.04142857142857
2023-05-09 23:17:52,137 [trainer.py] => Average Accuracy (ZS total): 78.91857142857143
2023-05-09 23:17:52,138 [trainer.py] => All params: 154358785
2023-05-09 23:17:52,139 [trainer.py] => Trainable params: 3152897
2023-05-09 23:17:52,151 [memo_transformer.py] => Learning on 70-80
2023-05-09 23:17:53,186 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 23:17:56,735 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 23:17:57,637 [trainer.py] => All params: 150670849
2023-05-09 23:17:57,638 [trainer.py] => Trainable params: 150670849
2023-05-09 23:18:00,673 [memo_transformer.py] => Learning on 0-10
2023-05-09 23:20:06,673 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 23:20:06,699 [trainer.py] => CNN: {'total': 92.88, '00-09': 93.56, '10-19': 92.61, '20-29': 92.46, 'old': 93.09, 'new': 92.46, 'harmonic': 92.77}
2023-05-09 23:20:06,699 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 23:20:06,700 [trainer.py] => CNN top1 curve: [97.97, 94.77, 92.88]
2023-05-09 23:20:06,700 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.27]
2023-05-09 23:20:06,700 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 23:20:06,700 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 23:20:06,700 [trainer.py] => Average Accuracy (CNN): 95.20666666666666
2023-05-09 23:20:06,700 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 23:20:06,700 [trainer.py] => ZS seen top1 curve: [96.88, 92.79, 89.16]
2023-05-09 23:20:06,700 [trainer.py] => ZS unseen top1 curve: [60.73, 73.39, 77.1]
2023-05-09 23:20:06,700 [trainer.py] => ZS harmonic top1 curve: [74.66, 81.96, 82.69]
2023-05-09 23:20:06,700 [trainer.py] => ZS total top1 curve: [64.38, 77.26, 80.72]
2023-05-09 23:20:06,700 [trainer.py] => Average Accuracy (ZS seen): 92.94333333333334
2023-05-09 23:20:06,700 [trainer.py] => Average Accuracy (ZS unseen): 70.40666666666667
2023-05-09 23:20:06,700 [trainer.py] => Average Accuracy (ZS harmonic): 79.77
2023-05-09 23:20:06,700 [trainer.py] => Average Accuracy (ZS total): 74.11999999999999
2023-05-09 23:20:06,701 [trainer.py] => All params: 152251393
2023-05-09 23:20:06,702 [trainer.py] => Trainable params: 2102273
2023-05-09 23:20:06,723 [memo_transformer.py] => Learning on 30-40
2023-05-09 23:20:54,259 [memo_transformer.py] => Task 0, Epoch 3/5 => Loss 1.557, Train_acc 98.18, Test_acc 97.87
2023-05-09 23:20:54,259 [memo_transformer.py] => Laion scores: [0, 0, 0] 
2023-05-09 23:20:54,260 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 23:20:54,261 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 23:22:30,716 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:22:30,727 [trainer.py] => CNN: {'total': 82.6, '00-09': 86.19, '10-19': 85.16, '20-29': 78.63, '30-39': 81.31, '40-49': 81.58, '50-59': 79.45, '60-69': 74.04, '70-79': 83.41, '80-89': 87.35, '90-99': 88.86, 'old': 81.91, 'new': 88.86, 'harmonic': 85.24}
2023-05-09 23:22:30,727 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-09 23:22:30,727 [trainer.py] => CNN top1 curve: [97.97, 94.87, 92.55, 90.64, 89.55, 88.07, 85.77, 85.15, 84.29, 82.6]
2023-05-09 23:22:30,727 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.23, 99.02, 98.6, 98.14, 97.63, 97.29, 96.99, 96.6]
2023-05-09 23:22:30,727 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-09 23:22:30,727 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-09 23:22:30,727 [trainer.py] => Average Accuracy (CNN): 89.14599999999999
2023-05-09 23:22:30,727 [trainer.py] => Average Accuracy (NME): 87.828
2023-05-09 23:22:30,727 [trainer.py] => ZS seen top1 curve: [96.29, 91.41, 88.78, 86.62, 85.5, 84.83, 83.1, 82.15, 82.41, 82.17]
2023-05-09 23:22:30,727 [trainer.py] => ZS unseen top1 curve: [72.83, 77.94, 77.99, 76.8, 77.32, 77.64, 80.48, 78.82, 74.95, 0]
2023-05-09 23:22:30,727 [trainer.py] => ZS harmonic top1 curve: [82.93, 84.14, 83.04, 81.41, 81.2, 81.08, 81.77, 80.45, 78.5, 0.0]
2023-05-09 23:22:30,727 [trainer.py] => ZS total top1 curve: [75.2, 80.63, 81.23, 80.76, 81.42, 81.97, 82.32, 81.49, 81.67, 82.17]
2023-05-09 23:22:30,727 [trainer.py] => Average Accuracy (ZS seen): 86.326
2023-05-09 23:22:30,727 [trainer.py] => Average Accuracy (ZS unseen): 69.477
2023-05-09 23:22:30,727 [trainer.py] => Average Accuracy (ZS harmonic): 73.452
2023-05-09 23:22:30,727 [trainer.py] => Average Accuracy (ZS total): 80.886
2023-05-09 23:23:10,783 [trainer.py] => config: ././exp5_pure_mlp//food101/food101_memo_transformer_clip_3_0.002_32_0.05.json
2023-05-09 23:23:10,789 [trainer.py] => prefix: reproduce
2023-05-09 23:23:10,789 [trainer.py] => dataset: food101
2023-05-09 23:23:10,789 [trainer.py] => memory_size: 2000
2023-05-09 23:23:10,789 [trainer.py] => memory_per_class: 20
2023-05-09 23:23:10,789 [trainer.py] => fixed_memory: False
2023-05-09 23:23:10,789 [trainer.py] => shuffle: True
2023-05-09 23:23:10,789 [trainer.py] => init_cls: 10
2023-05-09 23:23:10,789 [trainer.py] => increment: 10
2023-05-09 23:23:10,789 [trainer.py] => model_name: memo_transformer
2023-05-09 23:23:10,789 [trainer.py] => convnet_type: clip
2023-05-09 23:23:10,790 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 23:23:10,790 [trainer.py] => seed: 1993
2023-05-09 23:23:10,790 [trainer.py] => projection_type: pure_mlp
2023-05-09 23:23:10,790 [trainer.py] => fusion_choice: transformer
2023-05-09 23:23:10,790 [trainer.py] => split_train: False
2023-05-09 23:23:10,790 [trainer.py] => tsne_option: False
2023-05-09 23:23:10,790 [trainer.py] => laion_check: False
2023-05-09 23:23:10,790 [trainer.py] => train_tasks: 999
2023-05-09 23:23:10,790 [trainer.py] => frozen_layers: visual
2023-05-09 23:23:10,790 [trainer.py] => tuned_epoch: 5
2023-05-09 23:23:10,790 [trainer.py] => first_epoch: 3
2023-05-09 23:23:10,790 [trainer.py] => init_lr: 0.002
2023-05-09 23:23:10,790 [trainer.py] => batch_size: 32
2023-05-09 23:23:10,791 [trainer.py] => weight_decay: 0.05
2023-05-09 23:23:10,791 [trainer.py] => min_lr: 0
2023-05-09 23:23:10,791 [trainer.py] => optimizer: sgd
2023-05-09 23:23:11,392 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 23:23:49,458 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:23:49,458 [trainer.py] => CNN: {'total': 97.87, '00-09': 97.87, 'old': 0, 'new': 97.87, 'harmonic': 0.0}
2023-05-09 23:23:49,458 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 23:23:49,458 [trainer.py] => CNN top1 curve: [97.87]
2023-05-09 23:23:49,459 [trainer.py] => CNN top5 curve: [99.9]
2023-05-09 23:23:49,459 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 23:23:49,459 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 23:23:49,459 [trainer.py] => Average Accuracy (CNN): 97.87
2023-05-09 23:23:49,459 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 23:23:49,459 [trainer.py] => ZS seen top1 curve: [97.92]
2023-05-09 23:23:49,459 [trainer.py] => ZS unseen top1 curve: [1.43]
2023-05-09 23:23:49,459 [trainer.py] => ZS harmonic top1 curve: [2.82]
2023-05-09 23:23:49,459 [trainer.py] => ZS total top1 curve: [11.17]
2023-05-09 23:23:49,459 [trainer.py] => Average Accuracy (ZS seen): 97.92
2023-05-09 23:23:49,459 [trainer.py] => Average Accuracy (ZS unseen): 1.43
2023-05-09 23:23:49,459 [trainer.py] => Average Accuracy (ZS harmonic): 2.82
2023-05-09 23:23:49,459 [trainer.py] => Average Accuracy (ZS total): 11.17
2023-05-09 23:23:49,460 [trainer.py] => All params: 151197697
2023-05-09 23:23:49,461 [trainer.py] => Trainable params: 1576961
2023-05-09 23:23:49,476 [memo_transformer.py] => Learning on 10-20
2023-05-09 23:24:11,452 [instantiator.py] => Created a temporary directory at /tmp/tmpr8tz67u9
2023-05-09 23:24:11,453 [instantiator.py] => Writing /tmp/tmpr8tz67u9/_remote_module_non_sriptable.py
2023-05-09 23:24:13,348 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 23:24:17,127 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 23:24:17,728 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 23:24:20,426 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 23:24:20,789 [trainer.py] => All params: 150670849
2023-05-09 23:24:20,790 [trainer.py] => Trainable params: 150670849
2023-05-09 23:24:25,419 [memo_transformer.py] => Learning on 0-10
2023-05-09 23:25:11,393 [memo_transformer.py] => Task 3, Epoch 3/5 => Loss 1.610, Train_acc 93.87, Test_acc 91.70
2023-05-09 23:25:11,394 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:25:11,395 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 23:25:46,660 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 23:27:26,362 [memo_transformer.py] => Task 0, Epoch 3/5 => Loss 1.543, Train_acc 98.36, Test_acc 97.87
2023-05-09 23:27:26,363 [memo_transformer.py] => Laion scores: [0, 0, 0] 
2023-05-09 23:27:26,364 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 23:27:26,365 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 23:27:46,317 [memo_transformer.py] => Task 1, Epoch 3/5 => Loss 1.496, Train_acc 95.44, Test_acc 94.74
2023-05-09 23:27:46,321 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0] 
2023-05-09 23:27:46,322 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 23:28:04,400 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 23:29:07,940 [memo_transformer.py] => Task 7, Epoch 5/5 => Loss 1.614, Train_acc 94.32, Test_acc 86.22
2023-05-09 23:29:08,033 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:29:08,033 [base.py] => Reducing exemplars...(25 per classes)
2023-05-09 23:29:32,753 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:29:32,764 [trainer.py] => CNN: {'total': 91.7, '00-09': 92.38, '10-19': 91.9, '20-29': 90.76, '30-39': 91.75, 'old': 91.68, 'new': 91.75, 'harmonic': 91.71}
2023-05-09 23:29:32,764 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 23:29:32,764 [trainer.py] => CNN top1 curve: [97.97, 94.77, 92.88, 91.7]
2023-05-09 23:29:32,764 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.27, 98.99]
2023-05-09 23:29:32,764 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 23:29:32,764 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 23:29:32,764 [trainer.py] => Average Accuracy (CNN): 94.33
2023-05-09 23:29:32,764 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 23:29:32,764 [trainer.py] => ZS seen top1 curve: [96.88, 92.79, 89.16, 88.3]
2023-05-09 23:29:32,764 [trainer.py] => ZS unseen top1 curve: [60.73, 73.39, 77.1, 77.18]
2023-05-09 23:29:32,764 [trainer.py] => ZS harmonic top1 curve: [74.66, 81.96, 82.69, 82.37]
2023-05-09 23:29:32,764 [trainer.py] => ZS total top1 curve: [64.38, 77.26, 80.72, 81.66]
2023-05-09 23:29:32,764 [trainer.py] => Average Accuracy (ZS seen): 91.78250000000001
2023-05-09 23:29:32,764 [trainer.py] => Average Accuracy (ZS unseen): 72.1
2023-05-09 23:29:32,764 [trainer.py] => Average Accuracy (ZS harmonic): 80.42
2023-05-09 23:29:32,764 [trainer.py] => Average Accuracy (ZS total): 76.005
2023-05-09 23:29:32,765 [trainer.py] => All params: 152778241
2023-05-09 23:29:32,766 [trainer.py] => Trainable params: 2364929
2023-05-09 23:29:32,781 [memo_transformer.py] => Learning on 40-50
2023-05-09 23:30:01,147 [base.py] => Constructing exemplars...(25 per classes)
2023-05-09 23:30:13,039 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:30:13,067 [trainer.py] => CNN: {'total': 97.87, '00-09': 97.87, 'old': 0, 'new': 97.87, 'harmonic': 0.0}
2023-05-09 23:30:13,067 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 23:30:13,067 [trainer.py] => CNN top1 curve: [97.87]
2023-05-09 23:30:13,067 [trainer.py] => CNN top5 curve: [100.0]
2023-05-09 23:30:13,067 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 23:30:13,067 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 23:30:13,067 [trainer.py] => Average Accuracy (CNN): 97.87
2023-05-09 23:30:13,067 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 23:30:13,067 [trainer.py] => ZS seen top1 curve: [97.82]
2023-05-09 23:30:13,067 [trainer.py] => ZS unseen top1 curve: [1.45]
2023-05-09 23:30:13,067 [trainer.py] => ZS harmonic top1 curve: [2.86]
2023-05-09 23:30:13,067 [trainer.py] => ZS total top1 curve: [11.17]
2023-05-09 23:30:13,067 [trainer.py] => Average Accuracy (ZS seen): 97.82
2023-05-09 23:30:13,067 [trainer.py] => Average Accuracy (ZS unseen): 1.45
2023-05-09 23:30:13,067 [trainer.py] => Average Accuracy (ZS harmonic): 2.86
2023-05-09 23:30:13,067 [trainer.py] => Average Accuracy (ZS total): 11.17
2023-05-09 23:30:13,069 [trainer.py] => All params: 151197697
2023-05-09 23:30:13,069 [trainer.py] => Trainable params: 1576961
2023-05-09 23:30:13,084 [memo_transformer.py] => Learning on 10-20
2023-05-09 23:31:04,227 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:31:04,228 [trainer.py] => CNN: {'total': 94.74, '00-09': 95.5, '10-19': 93.97, 'old': 95.5, 'new': 93.97, 'harmonic': 94.73}
2023-05-09 23:31:04,228 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 23:31:04,228 [trainer.py] => CNN top1 curve: [97.87, 94.74]
2023-05-09 23:31:04,228 [trainer.py] => CNN top5 curve: [99.9, 99.57]
2023-05-09 23:31:04,228 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 23:31:04,228 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 23:31:04,229 [trainer.py] => Average Accuracy (CNN): 96.305
2023-05-09 23:31:04,229 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 23:31:04,229 [trainer.py] => ZS seen top1 curve: [97.92, 94.67]
2023-05-09 23:31:04,229 [trainer.py] => ZS unseen top1 curve: [1.43, 4.65]
2023-05-09 23:31:04,229 [trainer.py] => ZS harmonic top1 curve: [2.82, 8.86]
2023-05-09 23:31:04,229 [trainer.py] => ZS total top1 curve: [11.17, 22.62]
2023-05-09 23:31:04,229 [trainer.py] => Average Accuracy (ZS seen): 96.295
2023-05-09 23:31:04,229 [trainer.py] => Average Accuracy (ZS unseen): 3.04
2023-05-09 23:31:04,229 [trainer.py] => Average Accuracy (ZS harmonic): 5.84
2023-05-09 23:31:04,229 [trainer.py] => Average Accuracy (ZS total): 16.895
2023-05-09 23:31:04,230 [trainer.py] => All params: 151724545
2023-05-09 23:31:04,231 [trainer.py] => Trainable params: 1839617
2023-05-09 23:31:04,246 [memo_transformer.py] => Learning on 20-30
2023-05-09 23:34:14,342 [memo_transformer.py] => Task 1, Epoch 3/5 => Loss 1.484, Train_acc 95.59, Test_acc 94.17
2023-05-09 23:34:14,361 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0] 
2023-05-09 23:34:14,361 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 23:34:17,742 [trainer.py] => config: ././exp5_mlp//food101/food101_memo_transformer_clip_3_0.0009_32_0.0005.json
2023-05-09 23:34:17,747 [trainer.py] => prefix: reproduce
2023-05-09 23:34:17,747 [trainer.py] => dataset: food101
2023-05-09 23:34:17,747 [trainer.py] => memory_size: 2000
2023-05-09 23:34:17,747 [trainer.py] => memory_per_class: 20
2023-05-09 23:34:17,747 [trainer.py] => fixed_memory: False
2023-05-09 23:34:17,747 [trainer.py] => shuffle: True
2023-05-09 23:34:17,747 [trainer.py] => init_cls: 10
2023-05-09 23:34:17,747 [trainer.py] => increment: 10
2023-05-09 23:34:17,747 [trainer.py] => model_name: memo_transformer
2023-05-09 23:34:17,747 [trainer.py] => convnet_type: clip
2023-05-09 23:34:17,747 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 23:34:17,747 [trainer.py] => seed: 1993
2023-05-09 23:34:17,747 [trainer.py] => projection_type: mlp
2023-05-09 23:34:17,747 [trainer.py] => fusion_choice: transformer
2023-05-09 23:34:17,747 [trainer.py] => split_train: False
2023-05-09 23:34:17,748 [trainer.py] => tsne_option: False
2023-05-09 23:34:17,748 [trainer.py] => laion_check: False
2023-05-09 23:34:17,748 [trainer.py] => train_tasks: 999
2023-05-09 23:34:17,748 [trainer.py] => frozen_layers: visual
2023-05-09 23:34:17,748 [trainer.py] => tuned_epoch: 5
2023-05-09 23:34:17,748 [trainer.py] => first_epoch: 3
2023-05-09 23:34:17,748 [trainer.py] => init_lr: 0.0009
2023-05-09 23:34:17,748 [trainer.py] => batch_size: 32
2023-05-09 23:34:17,748 [trainer.py] => weight_decay: 0.0005
2023-05-09 23:34:17,748 [trainer.py] => min_lr: 0
2023-05-09 23:34:17,748 [trainer.py] => optimizer: sgd
2023-05-09 23:34:18,349 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 23:34:19,026 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:34:19,027 [trainer.py] => CNN: {'total': 86.22, '00-09': 88.56, '10-19': 88.05, '20-29': 84.07, '30-39': 84.71, '40-49': 87.57, '50-59': 84.83, '60-69': 82.27, '70-79': 89.71, 'old': 85.72, 'new': 89.71, 'harmonic': 87.67}
2023-05-09 23:34:19,027 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-09 23:34:19,027 [trainer.py] => CNN top1 curve: [97.92, 95.02, 92.88, 91.5, 90.37, 89.22, 87.06, 86.22]
2023-05-09 23:34:19,027 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.32, 99.12, 98.77, 98.38, 97.86, 97.44]
2023-05-09 23:34:19,027 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-09 23:34:19,027 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-09 23:34:19,028 [trainer.py] => Average Accuracy (CNN): 91.27375
2023-05-09 23:34:19,028 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-09 23:34:19,028 [trainer.py] => ZS seen top1 curve: [97.33, 93.07, 88.61, 88.2, 87.47, 86.64, 85.14, 84.9]
2023-05-09 23:34:19,028 [trainer.py] => ZS unseen top1 curve: [60.71, 73.86, 76.82, 76.75, 77.06, 77.05, 79.61, 78.4]
2023-05-09 23:34:19,028 [trainer.py] => ZS harmonic top1 curve: [74.78, 82.36, 82.29, 82.08, 81.94, 81.56, 82.28, 81.52]
2023-05-09 23:34:19,028 [trainer.py] => ZS total top1 curve: [64.41, 77.69, 80.36, 81.36, 82.29, 82.83, 83.49, 83.61]
2023-05-09 23:34:19,028 [trainer.py] => Average Accuracy (ZS seen): 88.91999999999999
2023-05-09 23:34:19,028 [trainer.py] => Average Accuracy (ZS unseen): 75.0325
2023-05-09 23:34:19,028 [trainer.py] => Average Accuracy (ZS harmonic): 81.10125
2023-05-09 23:34:19,028 [trainer.py] => Average Accuracy (ZS total): 79.505
2023-05-09 23:34:19,029 [trainer.py] => All params: 154885633
2023-05-09 23:34:19,030 [trainer.py] => Trainable params: 3415553
2023-05-09 23:34:19,041 [memo_transformer.py] => Learning on 80-90
2023-05-09 23:34:33,834 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 23:35:10,402 [memo_transformer.py] => Task 4, Epoch 3/5 => Loss 1.554, Train_acc 94.30, Test_acc 90.32
2023-05-09 23:35:10,404 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:35:10,405 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 23:35:13,800 [instantiator.py] => Created a temporary directory at /tmp/tmp6zj7tp4d
2023-05-09 23:35:13,805 [instantiator.py] => Writing /tmp/tmp6zj7tp4d/_remote_module_non_sriptable.py
2023-05-09 23:35:15,701 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 23:35:19,435 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 23:35:19,872 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 23:35:22,641 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 23:35:23,139 [trainer.py] => All params: 150670849
2023-05-09 23:35:23,140 [trainer.py] => Trainable params: 150670849
2023-05-09 23:35:27,285 [memo_transformer.py] => Learning on 0-10
2023-05-09 23:35:28,045 [memo_transformer.py] => Task 2, Epoch 3/5 => Loss 1.457, Train_acc 95.14, Test_acc 92.53
2023-05-09 23:35:28,049 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:35:28,049 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 23:35:50,902 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 23:35:52,610 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 23:37:38,489 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:37:38,497 [trainer.py] => CNN: {'total': 94.17, '00-09': 93.91, '10-19': 94.43, 'old': 93.91, 'new': 94.43, 'harmonic': 94.17}
2023-05-09 23:37:38,497 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 23:37:38,497 [trainer.py] => CNN top1 curve: [97.87, 94.17]
2023-05-09 23:37:38,497 [trainer.py] => CNN top5 curve: [100.0, 99.35]
2023-05-09 23:37:38,497 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 23:37:38,497 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 23:37:38,497 [trainer.py] => Average Accuracy (CNN): 96.02000000000001
2023-05-09 23:37:38,497 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 23:37:38,497 [trainer.py] => ZS seen top1 curve: [97.82, 93.69]
2023-05-09 23:37:38,497 [trainer.py] => ZS unseen top1 curve: [1.45, 8.33]
2023-05-09 23:37:38,497 [trainer.py] => ZS harmonic top1 curve: [2.86, 15.3]
2023-05-09 23:37:38,497 [trainer.py] => ZS total top1 curve: [11.17, 25.37]
2023-05-09 23:37:38,497 [trainer.py] => Average Accuracy (ZS seen): 95.755
2023-05-09 23:37:38,497 [trainer.py] => Average Accuracy (ZS unseen): 4.89
2023-05-09 23:37:38,497 [trainer.py] => Average Accuracy (ZS harmonic): 9.08
2023-05-09 23:37:38,497 [trainer.py] => Average Accuracy (ZS total): 18.27
2023-05-09 23:37:38,498 [trainer.py] => All params: 151724545
2023-05-09 23:37:38,499 [trainer.py] => Trainable params: 1839617
2023-05-09 23:37:38,514 [memo_transformer.py] => Learning on 20-30
2023-05-09 23:38:33,375 [memo_transformer.py] => Task 0, Epoch 3/5 => Loss 1.680, Train_acc 97.42, Test_acc 98.07
2023-05-09 23:38:33,375 [memo_transformer.py] => Laion scores: [0, 0, 0] 
2023-05-09 23:38:33,376 [base.py] => Reducing exemplars...(200 per classes)
2023-05-09 23:38:33,376 [base.py] => Constructing exemplars...(200 per classes)
2023-05-09 23:39:23,953 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 23:39:23,954 [trainer.py] => CNN: {'total': 92.53, '00-09': 92.13, '10-19': 91.7, '20-29': 93.76, 'old': 91.91, 'new': 93.76, 'harmonic': 92.83}
2023-05-09 23:39:23,954 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 23:39:23,954 [trainer.py] => CNN top1 curve: [97.87, 94.74, 92.53]
2023-05-09 23:39:23,955 [trainer.py] => CNN top5 curve: [99.9, 99.57, 99.27]
2023-05-09 23:39:23,955 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 23:39:23,955 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 23:39:23,955 [trainer.py] => Average Accuracy (CNN): 95.04666666666667
2023-05-09 23:39:23,955 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 23:39:23,955 [trainer.py] => ZS seen top1 curve: [97.92, 94.67, 91.71]
2023-05-09 23:39:23,955 [trainer.py] => ZS unseen top1 curve: [1.43, 4.65, 7.07]
2023-05-09 23:39:23,955 [trainer.py] => ZS harmonic top1 curve: [2.82, 8.86, 13.13]
2023-05-09 23:39:23,955 [trainer.py] => ZS total top1 curve: [11.17, 22.62, 32.44]
2023-05-09 23:39:23,955 [trainer.py] => Average Accuracy (ZS seen): 94.76666666666667
2023-05-09 23:39:23,955 [trainer.py] => Average Accuracy (ZS unseen): 4.383333333333334
2023-05-09 23:39:23,955 [trainer.py] => Average Accuracy (ZS harmonic): 8.270000000000001
2023-05-09 23:39:23,955 [trainer.py] => Average Accuracy (ZS total): 22.076666666666664
2023-05-09 23:39:23,956 [trainer.py] => All params: 152251393
2023-05-09 23:39:23,957 [trainer.py] => Trainable params: 2102273
2023-05-09 23:39:23,970 [memo_transformer.py] => Learning on 30-40
2023-05-09 23:40:05,894 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:40:05,898 [trainer.py] => CNN: {'total': 90.32, '00-09': 90.2, '10-19': 91.19, '20-29': 88.57, '30-39': 91.21, '40-49': 90.44, 'old': 90.3, 'new': 90.44, 'harmonic': 90.37}
2023-05-09 23:40:05,898 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 23:40:05,898 [trainer.py] => CNN top1 curve: [97.97, 94.77, 92.88, 91.7, 90.32]
2023-05-09 23:40:05,898 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.27, 98.99, 98.78]
2023-05-09 23:40:05,898 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 23:40:05,898 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 23:40:05,898 [trainer.py] => Average Accuracy (CNN): 93.52799999999999
2023-05-09 23:40:05,898 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 23:40:05,898 [trainer.py] => ZS seen top1 curve: [96.88, 92.79, 89.16, 88.3, 87.15]
2023-05-09 23:40:05,898 [trainer.py] => ZS unseen top1 curve: [60.73, 73.39, 77.1, 77.18, 77.45]
2023-05-09 23:40:05,898 [trainer.py] => ZS harmonic top1 curve: [74.66, 81.96, 82.69, 82.37, 82.01]
2023-05-09 23:40:05,898 [trainer.py] => ZS total top1 curve: [64.38, 77.26, 80.72, 81.66, 82.32]
2023-05-09 23:40:05,899 [trainer.py] => Average Accuracy (ZS seen): 90.85600000000002
2023-05-09 23:40:05,899 [trainer.py] => Average Accuracy (ZS unseen): 73.16999999999999
2023-05-09 23:40:05,899 [trainer.py] => Average Accuracy (ZS harmonic): 80.738
2023-05-09 23:40:05,899 [trainer.py] => Average Accuracy (ZS total): 77.268
2023-05-09 23:40:05,900 [trainer.py] => All params: 153305089
2023-05-09 23:40:05,900 [trainer.py] => Trainable params: 2627585
2023-05-09 23:40:05,912 [memo_transformer.py] => Learning on 50-60
2023-05-09 23:41:38,081 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:41:38,086 [trainer.py] => CNN: {'total': 98.07, '00-09': 98.07, 'old': 0, 'new': 98.07, 'harmonic': 0.0}
2023-05-09 23:41:38,086 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-09 23:41:38,086 [trainer.py] => CNN top1 curve: [98.07]
2023-05-09 23:41:38,086 [trainer.py] => CNN top5 curve: [99.9]
2023-05-09 23:41:38,086 [trainer.py] => NME top1 curve: [97.38]
2023-05-09 23:41:38,086 [trainer.py] => NME top5 curve: [99.8]

2023-05-09 23:41:38,086 [trainer.py] => Average Accuracy (CNN): 98.07
2023-05-09 23:41:38,086 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-09 23:41:38,086 [trainer.py] => ZS seen top1 curve: [95.64]
2023-05-09 23:41:38,086 [trainer.py] => ZS unseen top1 curve: [65.82]
2023-05-09 23:41:38,086 [trainer.py] => ZS harmonic top1 curve: [77.98]
2023-05-09 23:41:38,086 [trainer.py] => ZS total top1 curve: [68.83]
2023-05-09 23:41:38,087 [trainer.py] => Average Accuracy (ZS seen): 95.64
2023-05-09 23:41:38,087 [trainer.py] => Average Accuracy (ZS unseen): 65.82
2023-05-09 23:41:38,087 [trainer.py] => Average Accuracy (ZS harmonic): 77.98
2023-05-09 23:41:38,087 [trainer.py] => Average Accuracy (ZS total): 68.83
2023-05-09 23:41:38,088 [trainer.py] => All params: 151197697
2023-05-09 23:41:38,088 [trainer.py] => Trainable params: 1576961
2023-05-09 23:41:38,103 [memo_transformer.py] => Learning on 10-20
2023-05-09 23:42:09,852 [memo_transformer.py] => Task 2, Epoch 3/5 => Loss 1.491, Train_acc 95.22, Test_acc 90.91
2023-05-09 23:42:09,890 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:42:09,890 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 23:42:37,398 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 23:44:17,781 [memo_transformer.py] => Task 3, Epoch 3/5 => Loss 1.432, Train_acc 95.66, Test_acc 90.88
2023-05-09 23:44:17,794 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:44:17,795 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 23:44:54,015 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 23:45:48,954 [memo_transformer.py] => Task 1, Epoch 3/5 => Loss 1.726, Train_acc 93.24, Test_acc 94.52
2023-05-09 23:45:48,958 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0] 
2023-05-09 23:45:48,958 [base.py] => Reducing exemplars...(100 per classes)
2023-05-09 23:46:11,635 [base.py] => Constructing exemplars...(100 per classes)
2023-05-09 23:46:14,797 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 23:46:14,800 [trainer.py] => CNN: {'total': 90.91, '00-09': 88.76, '10-19': 88.91, '20-29': 95.06, 'old': 88.84, 'new': 95.06, 'harmonic': 91.84}
2023-05-09 23:46:14,800 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 23:46:14,800 [trainer.py] => CNN top1 curve: [97.87, 94.17, 90.91]
2023-05-09 23:46:14,800 [trainer.py] => CNN top5 curve: [100.0, 99.35, 99.15]
2023-05-09 23:46:14,801 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 23:46:14,801 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 23:46:14,801 [trainer.py] => Average Accuracy (CNN): 94.31666666666668
2023-05-09 23:46:14,801 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 23:46:14,801 [trainer.py] => ZS seen top1 curve: [97.82, 93.69, 91.11]
2023-05-09 23:46:14,801 [trainer.py] => ZS unseen top1 curve: [1.45, 8.33, 11.87]
2023-05-09 23:46:14,801 [trainer.py] => ZS harmonic top1 curve: [2.86, 15.3, 21.0]
2023-05-09 23:46:14,801 [trainer.py] => ZS total top1 curve: [11.17, 25.37, 35.62]
2023-05-09 23:46:14,801 [trainer.py] => Average Accuracy (ZS seen): 94.20666666666666
2023-05-09 23:46:14,801 [trainer.py] => Average Accuracy (ZS unseen): 7.216666666666666
2023-05-09 23:46:14,801 [trainer.py] => Average Accuracy (ZS harmonic): 13.053333333333333
2023-05-09 23:46:14,801 [trainer.py] => Average Accuracy (ZS total): 24.05333333333333
2023-05-09 23:46:14,803 [trainer.py] => All params: 152251393
2023-05-09 23:46:14,804 [trainer.py] => Trainable params: 2102273
2023-05-09 23:46:14,820 [memo_transformer.py] => Learning on 30-40
2023-05-09 23:46:15,278 [memo_transformer.py] => Task 5, Epoch 3/5 => Loss 1.655, Train_acc 93.63, Test_acc 89.04
2023-05-09 23:46:15,285 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:46:15,286 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 23:46:26,928 [memo_transformer.py] => Task 8, Epoch 5/5 => Loss 1.635, Train_acc 94.07, Test_acc 86.07
2023-05-09 23:46:26,978 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:46:26,979 [base.py] => Reducing exemplars...(22 per classes)
2023-05-09 23:47:04,270 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 23:47:20,874 [base.py] => Constructing exemplars...(22 per classes)
2023-05-09 23:48:31,426 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:48:31,434 [trainer.py] => CNN: {'total': 90.88, '00-09': 91.04, '10-19': 90.23, '20-29': 88.32, '30-39': 93.83, 'old': 89.86, 'new': 93.83, 'harmonic': 91.8}
2023-05-09 23:48:31,434 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 23:48:31,434 [trainer.py] => CNN top1 curve: [97.87, 94.74, 92.53, 90.88]
2023-05-09 23:48:31,435 [trainer.py] => CNN top5 curve: [99.9, 99.57, 99.27, 98.88]
2023-05-09 23:48:31,435 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 23:48:31,435 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 23:48:31,435 [trainer.py] => Average Accuracy (CNN): 94.005
2023-05-09 23:48:31,435 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 23:48:31,435 [trainer.py] => ZS seen top1 curve: [97.92, 94.67, 91.71, 90.2]
2023-05-09 23:48:31,435 [trainer.py] => ZS unseen top1 curve: [1.43, 4.65, 7.07, 12.77]
2023-05-09 23:48:31,435 [trainer.py] => ZS harmonic top1 curve: [2.82, 8.86, 13.13, 22.37]
2023-05-09 23:48:31,435 [trainer.py] => ZS total top1 curve: [11.17, 22.62, 32.44, 43.94]
2023-05-09 23:48:31,435 [trainer.py] => Average Accuracy (ZS seen): 93.625
2023-05-09 23:48:31,435 [trainer.py] => Average Accuracy (ZS unseen): 6.48
2023-05-09 23:48:31,435 [trainer.py] => Average Accuracy (ZS harmonic): 11.795000000000002
2023-05-09 23:48:31,435 [trainer.py] => Average Accuracy (ZS total): 27.542499999999997
2023-05-09 23:48:31,438 [trainer.py] => All params: 152778241
2023-05-09 23:48:31,439 [trainer.py] => Trainable params: 2364929
2023-05-09 23:48:31,455 [memo_transformer.py] => Learning on 40-50
2023-05-09 23:49:36,920 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:49:36,922 [trainer.py] => CNN: {'total': 94.52, '00-09': 95.74, '10-19': 93.27, 'old': 95.74, 'new': 93.27, 'harmonic': 94.49}
2023-05-09 23:49:36,922 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-09 23:49:36,923 [trainer.py] => CNN top1 curve: [98.07, 94.52]
2023-05-09 23:49:36,923 [trainer.py] => CNN top5 curve: [99.9, 99.47]
2023-05-09 23:49:36,923 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-09 23:49:36,923 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-09 23:49:36,923 [trainer.py] => Average Accuracy (CNN): 96.29499999999999
2023-05-09 23:49:36,923 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-09 23:49:36,923 [trainer.py] => ZS seen top1 curve: [95.64, 91.84]
2023-05-09 23:49:36,923 [trainer.py] => ZS unseen top1 curve: [65.82, 74.53]
2023-05-09 23:49:36,923 [trainer.py] => ZS harmonic top1 curve: [77.98, 82.28]
2023-05-09 23:49:36,923 [trainer.py] => ZS total top1 curve: [68.83, 77.98]
2023-05-09 23:49:36,923 [trainer.py] => Average Accuracy (ZS seen): 93.74000000000001
2023-05-09 23:49:36,923 [trainer.py] => Average Accuracy (ZS unseen): 70.175
2023-05-09 23:49:36,923 [trainer.py] => Average Accuracy (ZS harmonic): 80.13
2023-05-09 23:49:36,923 [trainer.py] => Average Accuracy (ZS total): 73.405
2023-05-09 23:49:36,924 [trainer.py] => All params: 151724545
2023-05-09 23:49:36,925 [trainer.py] => Trainable params: 1839617
2023-05-09 23:49:36,938 [memo_transformer.py] => Learning on 20-30
2023-05-09 23:51:15,532 [memo_transformer.py] => Task 3, Epoch 3/5 => Loss 1.504, Train_acc 94.92, Test_acc 89.45
2023-05-09 23:51:15,533 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:51:15,534 [base.py] => Reducing exemplars...(50 per classes)
2023-05-09 23:51:34,843 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 23:51:34,846 [trainer.py] => CNN: {'total': 89.04, '00-09': 89.85, '10-19': 89.77, '20-29': 87.72, '30-39': 88.74, '40-49': 90.54, '50-59': 87.66, 'old': 89.32, 'new': 87.66, 'harmonic': 88.48}
2023-05-09 23:51:34,847 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 23:51:34,847 [trainer.py] => CNN top1 curve: [97.97, 94.77, 92.88, 91.7, 90.32, 89.04]
2023-05-09 23:51:34,847 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.27, 98.99, 98.78, 98.31]
2023-05-09 23:51:34,847 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-09 23:51:34,847 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-09 23:51:34,847 [trainer.py] => Average Accuracy (CNN): 92.77999999999999
2023-05-09 23:51:34,847 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-09 23:51:34,847 [trainer.py] => ZS seen top1 curve: [96.88, 92.79, 89.16, 88.3, 87.15, 86.68]
2023-05-09 23:51:34,847 [trainer.py] => ZS unseen top1 curve: [60.73, 73.39, 77.1, 77.18, 77.45, 77.28]
2023-05-09 23:51:34,847 [trainer.py] => ZS harmonic top1 curve: [74.66, 81.96, 82.69, 82.37, 82.01, 81.71]
2023-05-09 23:51:34,847 [trainer.py] => ZS total top1 curve: [64.38, 77.26, 80.72, 81.66, 82.32, 82.94]
2023-05-09 23:51:34,847 [trainer.py] => Average Accuracy (ZS seen): 90.16000000000001
2023-05-09 23:51:34,847 [trainer.py] => Average Accuracy (ZS unseen): 73.855
2023-05-09 23:51:34,847 [trainer.py] => Average Accuracy (ZS harmonic): 80.89999999999999
2023-05-09 23:51:34,847 [trainer.py] => Average Accuracy (ZS total): 78.21333333333332
2023-05-09 23:51:34,848 [trainer.py] => All params: 153831937
2023-05-09 23:51:34,849 [trainer.py] => Trainable params: 2890241
2023-05-09 23:51:34,862 [memo_transformer.py] => Learning on 60-70
2023-05-09 23:51:45,253 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 23:51:45,317 [trainer.py] => CNN: {'total': 86.07, '00-09': 88.17, '10-19': 87.54, '20-29': 85.22, '30-39': 83.64, '40-49': 86.31, '50-59': 85.12, '60-69': 79.19, '70-79': 89.71, '80-89': 89.71, 'old': 85.61, 'new': 89.71, 'harmonic': 87.61}
2023-05-09 23:51:45,317 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-09 23:51:45,317 [trainer.py] => CNN top1 curve: [97.92, 95.02, 92.88, 91.5, 90.37, 89.22, 87.06, 86.22, 86.07]
2023-05-09 23:51:45,317 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.32, 99.12, 98.77, 98.38, 97.86, 97.44, 97.31]
2023-05-09 23:51:45,317 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-09 23:51:45,317 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-09 23:51:45,317 [trainer.py] => Average Accuracy (CNN): 90.69555555555556
2023-05-09 23:51:45,317 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-09 23:51:45,317 [trainer.py] => ZS seen top1 curve: [97.33, 93.07, 88.61, 88.2, 87.47, 86.64, 85.14, 84.9, 84.96]
2023-05-09 23:51:45,317 [trainer.py] => ZS unseen top1 curve: [60.71, 73.86, 76.82, 76.75, 77.06, 77.05, 79.61, 78.4, 73.89]
2023-05-09 23:51:45,317 [trainer.py] => ZS harmonic top1 curve: [74.78, 82.36, 82.29, 82.08, 81.94, 81.56, 82.28, 81.52, 79.04]
2023-05-09 23:51:45,317 [trainer.py] => ZS total top1 curve: [64.41, 77.69, 80.36, 81.36, 82.29, 82.83, 83.49, 83.61, 83.86]
2023-05-09 23:51:45,317 [trainer.py] => Average Accuracy (ZS seen): 88.47999999999999
2023-05-09 23:51:45,317 [trainer.py] => Average Accuracy (ZS unseen): 74.90555555555555
2023-05-09 23:51:45,317 [trainer.py] => Average Accuracy (ZS harmonic): 80.8722222222222
2023-05-09 23:51:45,317 [trainer.py] => Average Accuracy (ZS total): 79.98888888888888
2023-05-09 23:51:45,318 [trainer.py] => All params: 155412481
2023-05-09 23:51:45,319 [trainer.py] => Trainable params: 3678209
2023-05-09 23:51:45,342 [memo_transformer.py] => Learning on 90-100
2023-05-09 23:51:46,890 [base.py] => Constructing exemplars...(50 per classes)
2023-05-09 23:53:59,007 [memo_transformer.py] => Task 4, Epoch 3/5 => Loss 1.365, Train_acc 96.61, Test_acc 89.37
2023-05-09 23:53:59,008 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:53:59,008 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 23:54:19,507 [memo_transformer.py] => Task 2, Epoch 3/5 => Loss 1.728, Train_acc 92.02, Test_acc 92.60
2023-05-09 23:54:19,552 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:54:19,555 [base.py] => Reducing exemplars...(66 per classes)
2023-05-09 23:54:39,286 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 23:54:49,043 [base.py] => Constructing exemplars...(66 per classes)
2023-05-09 23:55:38,364 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:55:38,368 [trainer.py] => CNN: {'total': 89.45, '00-09': 88.96, '10-19': 86.78, '20-29': 86.92, '30-39': 94.95, 'old': 87.56, 'new': 94.95, 'harmonic': 91.11}
2023-05-09 23:55:38,368 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-09 23:55:38,368 [trainer.py] => CNN top1 curve: [97.87, 94.17, 90.91, 89.45]
2023-05-09 23:55:38,368 [trainer.py] => CNN top5 curve: [100.0, 99.35, 99.15, 98.55]
2023-05-09 23:55:38,368 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-09 23:55:38,368 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-09 23:55:38,369 [trainer.py] => Average Accuracy (CNN): 93.10000000000001
2023-05-09 23:55:38,369 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-09 23:55:38,369 [trainer.py] => ZS seen top1 curve: [97.82, 93.69, 91.11, 89.63]
2023-05-09 23:55:38,369 [trainer.py] => ZS unseen top1 curve: [1.45, 8.33, 11.87, 20.81]
2023-05-09 23:55:38,369 [trainer.py] => ZS harmonic top1 curve: [2.86, 15.3, 21.0, 33.78]
2023-05-09 23:55:38,369 [trainer.py] => ZS total top1 curve: [11.17, 25.37, 35.62, 48.52]
2023-05-09 23:55:38,369 [trainer.py] => Average Accuracy (ZS seen): 93.0625
2023-05-09 23:55:38,369 [trainer.py] => Average Accuracy (ZS unseen): 10.614999999999998
2023-05-09 23:55:38,369 [trainer.py] => Average Accuracy (ZS harmonic): 18.235
2023-05-09 23:55:38,369 [trainer.py] => Average Accuracy (ZS total): 30.17
2023-05-09 23:55:38,370 [trainer.py] => All params: 152778241
2023-05-09 23:55:38,371 [trainer.py] => Trainable params: 2364929
2023-05-09 23:55:38,387 [memo_transformer.py] => Learning on 40-50
2023-05-09 23:58:17,731 [memo_transformer.py] => Task 6, Epoch 3/5 => Loss 1.968, Train_acc 89.98, Test_acc 86.70
2023-05-09 23:58:17,764 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:58:17,765 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 23:58:22,408 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 23:58:22,458 [trainer.py] => CNN: {'total': 92.6, '00-09': 93.37, '10-19': 92.1, '20-29': 92.31, 'old': 92.74, 'new': 92.31, 'harmonic': 92.52}
2023-05-09 23:58:22,458 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-09 23:58:22,458 [trainer.py] => CNN top1 curve: [98.07, 94.52, 92.6]
2023-05-09 23:58:22,458 [trainer.py] => CNN top5 curve: [99.9, 99.47, 99.27]
2023-05-09 23:58:22,458 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-09 23:58:22,458 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-09 23:58:22,458 [trainer.py] => Average Accuracy (CNN): 95.06333333333332
2023-05-09 23:58:22,458 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-09 23:58:22,458 [trainer.py] => ZS seen top1 curve: [95.64, 91.84, 88.66]
2023-05-09 23:58:22,458 [trainer.py] => ZS unseen top1 curve: [65.82, 74.53, 77.31]
2023-05-09 23:58:22,458 [trainer.py] => ZS harmonic top1 curve: [77.98, 82.28, 82.6]
2023-05-09 23:58:22,458 [trainer.py] => ZS total top1 curve: [68.83, 77.98, 80.71]
2023-05-09 23:58:22,458 [trainer.py] => Average Accuracy (ZS seen): 92.04666666666667
2023-05-09 23:58:22,459 [trainer.py] => Average Accuracy (ZS unseen): 72.55333333333333
2023-05-09 23:58:22,459 [trainer.py] => Average Accuracy (ZS harmonic): 80.95333333333333
2023-05-09 23:58:22,459 [trainer.py] => Average Accuracy (ZS total): 75.83999999999999
2023-05-09 23:58:22,460 [trainer.py] => All params: 152251393
2023-05-09 23:58:22,460 [trainer.py] => Trainable params: 2102273
2023-05-09 23:58:22,474 [memo_transformer.py] => Learning on 30-40
2023-05-09 23:58:28,369 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:58:28,373 [trainer.py] => CNN: {'total': 89.37, '00-09': 89.16, '10-19': 89.01, '20-29': 87.42, '30-39': 88.01, '40-49': 93.31, 'old': 88.4, 'new': 93.31, 'harmonic': 90.79}
2023-05-09 23:58:28,373 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-09 23:58:28,373 [trainer.py] => CNN top1 curve: [97.87, 94.74, 92.53, 90.88, 89.37]
2023-05-09 23:58:28,373 [trainer.py] => CNN top5 curve: [99.9, 99.57, 99.27, 98.88, 98.48]
2023-05-09 23:58:28,373 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-09 23:58:28,373 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-09 23:58:28,373 [trainer.py] => Average Accuracy (CNN): 93.078
2023-05-09 23:58:28,373 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-09 23:58:28,373 [trainer.py] => ZS seen top1 curve: [97.92, 94.67, 91.71, 90.2, 88.8]
2023-05-09 23:58:28,373 [trainer.py] => ZS unseen top1 curve: [1.43, 4.65, 7.07, 12.77, 18.39]
2023-05-09 23:58:28,373 [trainer.py] => ZS harmonic top1 curve: [2.82, 8.86, 13.13, 22.37, 30.47]
2023-05-09 23:58:28,373 [trainer.py] => ZS total top1 curve: [11.17, 22.62, 32.44, 43.94, 53.73]
2023-05-09 23:58:28,373 [trainer.py] => Average Accuracy (ZS seen): 92.66
2023-05-09 23:58:28,373 [trainer.py] => Average Accuracy (ZS unseen): 8.862
2023-05-09 23:58:28,373 [trainer.py] => Average Accuracy (ZS harmonic): 15.530000000000001
2023-05-09 23:58:28,373 [trainer.py] => Average Accuracy (ZS total): 32.779999999999994
2023-05-09 23:58:28,374 [trainer.py] => All params: 153305089
2023-05-09 23:58:28,375 [trainer.py] => Trainable params: 2627585
2023-05-09 23:58:28,389 [memo_transformer.py] => Learning on 50-60
2023-05-09 23:59:04,018 [base.py] => Constructing exemplars...(28 per classes)
2023-05-10 00:01:12,130 [memo_transformer.py] => Task 4, Epoch 3/5 => Loss 1.450, Train_acc 95.03, Test_acc 86.48
2023-05-10 00:01:12,132 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:01:12,133 [base.py] => Reducing exemplars...(40 per classes)
2023-05-10 00:01:48,330 [base.py] => Constructing exemplars...(40 per classes)
2023-05-10 00:03:37,979 [memo_transformer.py] => Task 3, Epoch 3/5 => Loss 1.751, Train_acc 91.93, Test_acc 90.75
2023-05-10 00:03:38,036 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:03:38,040 [base.py] => Reducing exemplars...(50 per classes)
2023-05-10 00:03:50,173 [memo_transformer.py] => Exemplar size: 1960
2023-05-10 00:03:50,178 [trainer.py] => CNN: {'total': 86.7, '00-09': 88.51, '10-19': 89.27, '20-29': 84.82, '30-39': 87.86, '40-49': 88.53, '50-59': 86.02, '60-69': 81.82, 'old': 87.5, 'new': 81.82, 'harmonic': 84.56}
2023-05-10 00:03:50,178 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-10 00:03:50,178 [trainer.py] => CNN top1 curve: [97.97, 94.77, 92.88, 91.7, 90.32, 89.04, 86.7]
2023-05-10 00:03:50,178 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.27, 98.99, 98.78, 98.31, 97.79]
2023-05-10 00:03:50,178 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-10 00:03:50,178 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-10 00:03:50,178 [trainer.py] => Average Accuracy (CNN): 91.91142857142857
2023-05-10 00:03:50,178 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-10 00:03:50,178 [trainer.py] => ZS seen top1 curve: [96.88, 92.79, 89.16, 88.3, 87.15, 86.68, 85.03]
2023-05-10 00:03:50,178 [trainer.py] => ZS unseen top1 curve: [60.73, 73.39, 77.1, 77.18, 77.45, 77.28, 79.17]
2023-05-10 00:03:50,179 [trainer.py] => ZS harmonic top1 curve: [74.66, 81.96, 82.69, 82.37, 82.01, 81.71, 82.0]
2023-05-10 00:03:50,179 [trainer.py] => ZS total top1 curve: [64.38, 77.26, 80.72, 81.66, 82.32, 82.94, 83.28]
2023-05-10 00:03:50,179 [trainer.py] => Average Accuracy (ZS seen): 89.42714285714285
2023-05-10 00:03:50,179 [trainer.py] => Average Accuracy (ZS unseen): 74.61428571428571
2023-05-10 00:03:50,179 [trainer.py] => Average Accuracy (ZS harmonic): 81.05714285714285
2023-05-10 00:03:50,179 [trainer.py] => Average Accuracy (ZS total): 78.93714285714285
2023-05-10 00:03:50,181 [trainer.py] => All params: 154358785
2023-05-10 00:03:50,183 [trainer.py] => Trainable params: 3152897
2023-05-10 00:03:50,198 [memo_transformer.py] => Learning on 70-80
2023-05-10 00:04:13,725 [base.py] => Constructing exemplars...(50 per classes)
2023-05-10 00:04:25,460 [memo_transformer.py] => Task 5, Epoch 3/5 => Loss 1.420, Train_acc 96.10, Test_acc 88.20
2023-05-10 00:04:25,474 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:04:25,474 [base.py] => Reducing exemplars...(33 per classes)
2023-05-10 00:04:38,413 [memo_transformer.py] => Task 9, Epoch 5/5 => Loss 1.780, Train_acc 92.35, Test_acc 84.67
2023-05-10 00:04:38,448 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:04:38,452 [base.py] => Reducing exemplars...(20 per classes)
2023-05-10 00:05:09,439 [base.py] => Constructing exemplars...(33 per classes)
2023-05-10 00:05:30,186 [base.py] => Constructing exemplars...(20 per classes)
2023-05-10 00:05:55,101 [memo_transformer.py] => Exemplar size: 2000
2023-05-10 00:05:55,104 [trainer.py] => CNN: {'total': 86.48, '00-09': 85.54, '10-19': 85.87, '20-29': 80.93, '30-39': 85.97, '40-49': 94.16, 'old': 84.59, 'new': 94.16, 'harmonic': 89.12}
2023-05-10 00:05:55,104 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 88.22, 'new': 88.37, 'harmonic': 88.29}
2023-05-10 00:05:55,104 [trainer.py] => CNN top1 curve: [97.87, 94.17, 90.91, 89.45, 86.48]
2023-05-10 00:05:55,104 [trainer.py] => CNN top5 curve: [100.0, 99.35, 99.15, 98.55, 97.94]
2023-05-10 00:05:55,104 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25]
2023-05-10 00:05:55,104 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13]

2023-05-10 00:05:55,105 [trainer.py] => Average Accuracy (CNN): 91.77600000000001
2023-05-10 00:05:55,105 [trainer.py] => Average Accuracy (NME): 91.736
2023-05-10 00:05:55,105 [trainer.py] => ZS seen top1 curve: [97.82, 93.69, 91.11, 89.63, 86.99]
2023-05-10 00:05:55,105 [trainer.py] => ZS unseen top1 curve: [1.45, 8.33, 11.87, 20.81, 26.26]
2023-05-10 00:05:55,105 [trainer.py] => ZS harmonic top1 curve: [2.86, 15.3, 21.0, 33.78, 40.34]
2023-05-10 00:05:55,105 [trainer.py] => ZS total top1 curve: [11.17, 25.37, 35.62, 48.52, 56.74]
2023-05-10 00:05:55,105 [trainer.py] => Average Accuracy (ZS seen): 91.848
2023-05-10 00:05:55,105 [trainer.py] => Average Accuracy (ZS unseen): 13.744
2023-05-10 00:05:55,105 [trainer.py] => Average Accuracy (ZS harmonic): 22.656
2023-05-10 00:05:55,105 [trainer.py] => Average Accuracy (ZS total): 35.484
2023-05-10 00:05:55,106 [trainer.py] => All params: 153305089
2023-05-10 00:05:55,107 [trainer.py] => Trainable params: 2627585
2023-05-10 00:05:55,121 [memo_transformer.py] => Learning on 50-60
2023-05-10 00:08:06,301 [memo_transformer.py] => Exemplar size: 2000
2023-05-10 00:08:06,309 [trainer.py] => CNN: {'total': 90.75, '00-09': 91.19, '10-19': 90.99, '20-29': 89.82, '30-39': 91.02, 'old': 90.66, 'new': 91.02, 'harmonic': 90.84}
2023-05-10 00:08:06,309 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-10 00:08:06,309 [trainer.py] => CNN top1 curve: [98.07, 94.52, 92.6, 90.75]
2023-05-10 00:08:06,309 [trainer.py] => CNN top5 curve: [99.9, 99.47, 99.27, 98.88]
2023-05-10 00:08:06,309 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-10 00:08:06,309 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-10 00:08:06,309 [trainer.py] => Average Accuracy (CNN): 93.98499999999999
2023-05-10 00:08:06,309 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-10 00:08:06,309 [trainer.py] => ZS seen top1 curve: [95.64, 91.84, 88.66, 87.42]
2023-05-10 00:08:06,309 [trainer.py] => ZS unseen top1 curve: [65.82, 74.53, 77.31, 76.96]
2023-05-10 00:08:06,309 [trainer.py] => ZS harmonic top1 curve: [77.98, 82.28, 82.6, 81.86]
2023-05-10 00:08:06,309 [trainer.py] => ZS total top1 curve: [68.83, 77.98, 80.71, 81.17]
2023-05-10 00:08:06,309 [trainer.py] => Average Accuracy (ZS seen): 90.89
2023-05-10 00:08:06,310 [trainer.py] => Average Accuracy (ZS unseen): 73.655
2023-05-10 00:08:06,310 [trainer.py] => Average Accuracy (ZS harmonic): 81.17999999999999
2023-05-10 00:08:06,310 [trainer.py] => Average Accuracy (ZS total): 77.1725
2023-05-10 00:08:06,311 [trainer.py] => All params: 152778241
2023-05-10 00:08:06,311 [trainer.py] => Trainable params: 2364929
2023-05-10 00:08:06,325 [memo_transformer.py] => Learning on 40-50
2023-05-10 00:09:14,583 [memo_transformer.py] => Exemplar size: 1980
2023-05-10 00:09:14,608 [trainer.py] => CNN: {'total': 88.2, '00-09': 87.97, '10-19': 89.11, '20-29': 85.32, '30-39': 85.78, '40-49': 89.13, '50-59': 91.99, 'old': 87.45, 'new': 91.99, 'harmonic': 89.66}
2023-05-10 00:09:14,608 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-10 00:09:14,608 [trainer.py] => CNN top1 curve: [97.87, 94.74, 92.53, 90.88, 89.37, 88.2]
2023-05-10 00:09:14,608 [trainer.py] => CNN top5 curve: [99.9, 99.57, 99.27, 98.88, 98.48, 98.07]
2023-05-10 00:09:14,608 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-10 00:09:14,608 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-10 00:09:14,608 [trainer.py] => Average Accuracy (CNN): 92.265
2023-05-10 00:09:14,608 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-10 00:09:14,608 [trainer.py] => ZS seen top1 curve: [97.92, 94.67, 91.71, 90.2, 88.8, 87.8]
2023-05-10 00:09:14,608 [trainer.py] => ZS unseen top1 curve: [1.43, 4.65, 7.07, 12.77, 18.39, 20.95]
2023-05-10 00:09:14,608 [trainer.py] => ZS harmonic top1 curve: [2.82, 8.86, 13.13, 22.37, 30.47, 33.83]
2023-05-10 00:09:14,608 [trainer.py] => ZS total top1 curve: [11.17, 22.62, 32.44, 43.94, 53.73, 61.22]
2023-05-10 00:09:14,608 [trainer.py] => Average Accuracy (ZS seen): 91.85000000000001
2023-05-10 00:09:14,608 [trainer.py] => Average Accuracy (ZS unseen): 10.876666666666667
2023-05-10 00:09:14,608 [trainer.py] => Average Accuracy (ZS harmonic): 18.580000000000002
2023-05-10 00:09:14,608 [trainer.py] => Average Accuracy (ZS total): 37.519999999999996
2023-05-10 00:09:14,610 [trainer.py] => All params: 153831937
2023-05-10 00:09:14,610 [trainer.py] => Trainable params: 2890241
2023-05-10 00:09:14,623 [memo_transformer.py] => Learning on 60-70
2023-05-10 00:10:13,837 [memo_transformer.py] => Exemplar size: 2000
2023-05-10 00:10:13,921 [trainer.py] => CNN: {'total': 84.67, '00-09': 88.47, '10-19': 87.34, '20-29': 82.78, '30-39': 84.17, '40-49': 85.56, '50-59': 81.59, '60-69': 76.06, '70-79': 87.56, '80-89': 88.3, '90-99': 84.88, 'old': 84.65, 'new': 84.88, 'harmonic': 84.76}
2023-05-10 00:10:13,921 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-10 00:10:13,921 [trainer.py] => CNN top1 curve: [97.92, 95.02, 92.88, 91.5, 90.37, 89.22, 87.06, 86.22, 86.07, 84.67]
2023-05-10 00:10:13,921 [trainer.py] => CNN top5 curve: [99.95, 99.47, 99.32, 99.12, 98.77, 98.38, 97.86, 97.44, 97.31, 96.94]
2023-05-10 00:10:13,921 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-10 00:10:13,921 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-10 00:10:13,921 [trainer.py] => Average Accuracy (CNN): 90.09299999999999
2023-05-10 00:10:13,921 [trainer.py] => Average Accuracy (NME): 87.828
2023-05-10 00:10:13,921 [trainer.py] => ZS seen top1 curve: [97.33, 93.07, 88.61, 88.2, 87.47, 86.64, 85.14, 84.9, 84.96, 84.15]
2023-05-10 00:10:13,921 [trainer.py] => ZS unseen top1 curve: [60.71, 73.86, 76.82, 76.75, 77.06, 77.05, 79.61, 78.4, 73.89, 0]
2023-05-10 00:10:13,921 [trainer.py] => ZS harmonic top1 curve: [74.78, 82.36, 82.29, 82.08, 81.94, 81.56, 82.28, 81.52, 79.04, 0.0]
2023-05-10 00:10:13,922 [trainer.py] => ZS total top1 curve: [64.41, 77.69, 80.36, 81.36, 82.29, 82.83, 83.49, 83.61, 83.86, 84.15]
2023-05-10 00:10:13,922 [trainer.py] => Average Accuracy (ZS seen): 88.047
2023-05-10 00:10:13,922 [trainer.py] => Average Accuracy (ZS unseen): 67.41499999999999
2023-05-10 00:10:13,922 [trainer.py] => Average Accuracy (ZS harmonic): 72.785
2023-05-10 00:10:13,922 [trainer.py] => Average Accuracy (ZS total): 80.405
2023-05-10 00:10:41,744 [trainer.py] => config: ././exp5_mlp//food101/food101_memo_transformer_clip_3_0.002_32_0.05.json
2023-05-10 00:10:41,745 [trainer.py] => prefix: reproduce
2023-05-10 00:10:41,745 [trainer.py] => dataset: food101
2023-05-10 00:10:41,745 [trainer.py] => memory_size: 2000
2023-05-10 00:10:41,745 [trainer.py] => memory_per_class: 20
2023-05-10 00:10:41,745 [trainer.py] => fixed_memory: False
2023-05-10 00:10:41,745 [trainer.py] => shuffle: True
2023-05-10 00:10:41,745 [trainer.py] => init_cls: 10
2023-05-10 00:10:41,745 [trainer.py] => increment: 10
2023-05-10 00:10:41,745 [trainer.py] => model_name: memo_transformer
2023-05-10 00:10:41,745 [trainer.py] => convnet_type: clip
2023-05-10 00:10:41,746 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-10 00:10:41,746 [trainer.py] => seed: 1993
2023-05-10 00:10:41,746 [trainer.py] => projection_type: mlp
2023-05-10 00:10:41,746 [trainer.py] => fusion_choice: transformer
2023-05-10 00:10:41,746 [trainer.py] => split_train: False
2023-05-10 00:10:41,746 [trainer.py] => tsne_option: False
2023-05-10 00:10:41,746 [trainer.py] => laion_check: False
2023-05-10 00:10:41,746 [trainer.py] => train_tasks: 999
2023-05-10 00:10:41,746 [trainer.py] => frozen_layers: visual
2023-05-10 00:10:41,746 [trainer.py] => tuned_epoch: 5
2023-05-10 00:10:41,746 [trainer.py] => first_epoch: 3
2023-05-10 00:10:41,746 [trainer.py] => init_lr: 0.002
2023-05-10 00:10:41,746 [trainer.py] => batch_size: 32
2023-05-10 00:10:41,746 [trainer.py] => weight_decay: 0.05
2023-05-10 00:10:41,746 [trainer.py] => min_lr: 0
2023-05-10 00:10:41,746 [trainer.py] => optimizer: sgd
2023-05-10 00:10:42,235 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-10 00:11:03,514 [memo_transformer.py] => Task 7, Epoch 3/5 => Loss 1.669, Train_acc 93.55, Test_acc 86.19
2023-05-10 00:11:03,532 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:11:03,533 [base.py] => Reducing exemplars...(25 per classes)
2023-05-10 00:11:28,467 [instantiator.py] => Created a temporary directory at /tmp/tmp9ptqcopm
2023-05-10 00:11:28,468 [instantiator.py] => Writing /tmp/tmp9ptqcopm/_remote_module_non_sriptable.py
2023-05-10 00:11:28,658 [factory.py] => Loaded ViT-B-16 model config.
2023-05-10 00:11:32,195 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-10 00:11:32,541 [factory.py] => Loaded ViT-B-16 model config.
2023-05-10 00:11:35,063 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-10 00:11:35,408 [trainer.py] => All params: 150670849
2023-05-10 00:11:35,409 [trainer.py] => Trainable params: 150670849
2023-05-10 00:11:38,149 [memo_transformer.py] => Learning on 0-10
2023-05-10 00:12:01,240 [memo_transformer.py] => Task 5, Epoch 3/5 => Loss 1.527, Train_acc 93.96, Test_acc 83.17
2023-05-10 00:12:01,241 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:12:01,246 [base.py] => Reducing exemplars...(33 per classes)
2023-05-10 00:12:01,526 [base.py] => Constructing exemplars...(25 per classes)
2023-05-10 00:12:40,516 [base.py] => Constructing exemplars...(33 per classes)
2023-05-10 00:14:29,798 [memo_transformer.py] => Task 0, Epoch 3/5 => Loss 1.619, Train_acc 98.32, Test_acc 98.07
2023-05-10 00:14:29,844 [memo_transformer.py] => Laion scores: [0, 0, 0] 
2023-05-10 00:14:29,844 [base.py] => Reducing exemplars...(200 per classes)
2023-05-10 00:14:29,845 [base.py] => Constructing exemplars...(200 per classes)
2023-05-10 00:15:40,826 [memo_transformer.py] => Task 6, Epoch 3/5 => Loss 1.690, Train_acc 92.75, Test_acc 85.44
2023-05-10 00:15:40,829 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:15:40,834 [base.py] => Reducing exemplars...(28 per classes)
2023-05-10 00:16:45,558 [base.py] => Constructing exemplars...(28 per classes)
2023-05-10 00:17:02,563 [memo_transformer.py] => Exemplar size: 2000
2023-05-10 00:17:02,569 [trainer.py] => CNN: {'total': 86.19, '00-09': 88.37, '10-19': 88.0, '20-29': 83.23, '30-39': 85.24, '40-49': 87.02, '50-59': 85.37, '60-69': 82.78, '70-79': 89.51, 'old': 85.71, 'new': 89.51, 'harmonic': 87.57}
2023-05-10 00:17:02,569 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-10 00:17:02,569 [trainer.py] => CNN top1 curve: [97.97, 94.77, 92.88, 91.7, 90.32, 89.04, 86.7, 86.19]
2023-05-10 00:17:02,569 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.27, 98.99, 98.78, 98.31, 97.79, 97.55]
2023-05-10 00:17:02,569 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-10 00:17:02,569 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-10 00:17:02,569 [trainer.py] => Average Accuracy (CNN): 91.19624999999999
2023-05-10 00:17:02,569 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-10 00:17:02,569 [trainer.py] => ZS seen top1 curve: [96.88, 92.79, 89.16, 88.3, 87.15, 86.68, 85.03, 84.97]
2023-05-10 00:17:02,569 [trainer.py] => ZS unseen top1 curve: [60.73, 73.39, 77.1, 77.18, 77.45, 77.28, 79.17, 77.77]
2023-05-10 00:17:02,569 [trainer.py] => ZS harmonic top1 curve: [74.66, 81.96, 82.69, 82.37, 82.01, 81.71, 82.0, 81.21]
2023-05-10 00:17:02,569 [trainer.py] => ZS total top1 curve: [64.38, 77.26, 80.72, 81.66, 82.32, 82.94, 83.28, 83.54]
2023-05-10 00:17:02,569 [trainer.py] => Average Accuracy (ZS seen): 88.87
2023-05-10 00:17:02,569 [trainer.py] => Average Accuracy (ZS unseen): 75.00874999999999
2023-05-10 00:17:02,569 [trainer.py] => Average Accuracy (ZS harmonic): 81.07625
2023-05-10 00:17:02,570 [trainer.py] => Average Accuracy (ZS total): 79.51249999999999
2023-05-10 00:17:02,571 [trainer.py] => All params: 154885633
2023-05-10 00:17:02,572 [trainer.py] => Trainable params: 3415553
2023-05-10 00:17:02,582 [memo_transformer.py] => Learning on 80-90
2023-05-10 00:17:03,570 [memo_transformer.py] => Exemplar size: 1980
2023-05-10 00:17:03,572 [trainer.py] => CNN: {'total': 83.17, '00-09': 80.25, '10-19': 79.9, '20-29': 79.98, '30-39': 79.9, '40-49': 84.35, '50-59': 94.68, 'old': 80.87, 'new': 94.68, 'harmonic': 87.23}
2023-05-10 00:17:03,573 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-10 00:17:03,573 [trainer.py] => CNN top1 curve: [97.87, 94.17, 90.91, 89.45, 86.48, 83.17]
2023-05-10 00:17:03,573 [trainer.py] => CNN top5 curve: [100.0, 99.35, 99.15, 98.55, 97.94, 97.06]
2023-05-10 00:17:03,573 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8]
2023-05-10 00:17:03,573 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66]

2023-05-10 00:17:03,573 [trainer.py] => Average Accuracy (CNN): 90.34166666666668
2023-05-10 00:17:03,573 [trainer.py] => Average Accuracy (NME): 90.91333333333334
2023-05-10 00:17:03,573 [trainer.py] => ZS seen top1 curve: [97.82, 93.69, 91.11, 89.63, 86.99, 84.3]
2023-05-10 00:17:03,573 [trainer.py] => ZS unseen top1 curve: [1.45, 8.33, 11.87, 20.81, 26.26, 27.98]
2023-05-10 00:17:03,573 [trainer.py] => ZS harmonic top1 curve: [2.86, 15.3, 21.0, 33.78, 40.34, 42.01]
2023-05-10 00:17:03,573 [trainer.py] => ZS total top1 curve: [11.17, 25.37, 35.62, 48.52, 56.74, 61.9]
2023-05-10 00:17:03,573 [trainer.py] => Average Accuracy (ZS seen): 90.58999999999999
2023-05-10 00:17:03,573 [trainer.py] => Average Accuracy (ZS unseen): 16.116666666666667
2023-05-10 00:17:03,573 [trainer.py] => Average Accuracy (ZS harmonic): 25.881666666666664
2023-05-10 00:17:03,573 [trainer.py] => Average Accuracy (ZS total): 39.88666666666667
2023-05-10 00:17:03,574 [trainer.py] => All params: 153831937
2023-05-10 00:17:03,575 [trainer.py] => Trainable params: 2890241
2023-05-10 00:17:03,589 [memo_transformer.py] => Learning on 60-70
2023-05-10 00:17:17,444 [memo_transformer.py] => Exemplar size: 2000
2023-05-10 00:17:17,477 [trainer.py] => CNN: {'total': 98.07, '00-09': 98.07, 'old': 0, 'new': 98.07, 'harmonic': 0.0}
2023-05-10 00:17:17,477 [trainer.py] => NME: {'total': 97.38, '00-09': 97.38, 'old': 0, 'new': 97.38, 'harmonic': 0.0}
2023-05-10 00:17:17,477 [trainer.py] => CNN top1 curve: [98.07]
2023-05-10 00:17:17,477 [trainer.py] => CNN top5 curve: [99.95]
2023-05-10 00:17:17,477 [trainer.py] => NME top1 curve: [97.38]
2023-05-10 00:17:17,477 [trainer.py] => NME top5 curve: [99.8]

2023-05-10 00:17:17,477 [trainer.py] => Average Accuracy (CNN): 98.07
2023-05-10 00:17:17,478 [trainer.py] => Average Accuracy (NME): 97.38
2023-05-10 00:17:17,478 [trainer.py] => ZS seen top1 curve: [96.29]
2023-05-10 00:17:17,478 [trainer.py] => ZS unseen top1 curve: [71.68]
2023-05-10 00:17:17,478 [trainer.py] => ZS harmonic top1 curve: [82.18]
2023-05-10 00:17:17,478 [trainer.py] => ZS total top1 curve: [74.17]
2023-05-10 00:17:17,478 [trainer.py] => Average Accuracy (ZS seen): 96.29
2023-05-10 00:17:17,478 [trainer.py] => Average Accuracy (ZS unseen): 71.68
2023-05-10 00:17:17,478 [trainer.py] => Average Accuracy (ZS harmonic): 82.18
2023-05-10 00:17:17,478 [trainer.py] => Average Accuracy (ZS total): 74.17
2023-05-10 00:17:17,479 [trainer.py] => All params: 151197697
2023-05-10 00:17:17,479 [trainer.py] => Trainable params: 1576961
2023-05-10 00:17:17,495 [memo_transformer.py] => Learning on 10-20
2023-05-10 00:21:01,079 [memo_transformer.py] => Exemplar size: 1960
2023-05-10 00:21:01,084 [trainer.py] => CNN: {'total': 85.44, '00-09': 84.11, '10-19': 88.66, '20-29': 83.42, '30-39': 87.18, '40-49': 86.31, '50-59': 82.89, '60-69': 85.51, 'old': 85.43, 'new': 85.51, 'harmonic': 85.47}
2023-05-10 00:21:01,085 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-10 00:21:01,085 [trainer.py] => CNN top1 curve: [97.87, 94.74, 92.53, 90.88, 89.37, 88.2, 85.44]
2023-05-10 00:21:01,085 [trainer.py] => CNN top5 curve: [99.9, 99.57, 99.27, 98.88, 98.48, 98.07, 97.66]
2023-05-10 00:21:01,085 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-10 00:21:01,085 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-10 00:21:01,085 [trainer.py] => Average Accuracy (CNN): 91.28999999999999
2023-05-10 00:21:01,085 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-10 00:21:01,085 [trainer.py] => ZS seen top1 curve: [97.92, 94.67, 91.71, 90.2, 88.8, 87.8, 84.86]
2023-05-10 00:21:01,085 [trainer.py] => ZS unseen top1 curve: [1.43, 4.65, 7.07, 12.77, 18.39, 20.95, 30.7]
2023-05-10 00:21:01,085 [trainer.py] => ZS harmonic top1 curve: [2.82, 8.86, 13.13, 22.37, 30.47, 33.83, 45.09]
2023-05-10 00:21:01,085 [trainer.py] => ZS total top1 curve: [11.17, 22.62, 32.44, 43.94, 53.73, 61.22, 68.68]
2023-05-10 00:21:01,085 [trainer.py] => Average Accuracy (ZS seen): 90.85142857142857
2023-05-10 00:21:01,085 [trainer.py] => Average Accuracy (ZS unseen): 13.70857142857143
2023-05-10 00:21:01,086 [trainer.py] => Average Accuracy (ZS harmonic): 22.367142857142856
2023-05-10 00:21:01,086 [trainer.py] => Average Accuracy (ZS total): 41.97142857142857
2023-05-10 00:21:01,087 [trainer.py] => All params: 154358785
2023-05-10 00:21:01,089 [trainer.py] => Trainable params: 3152897
2023-05-10 00:21:01,107 [memo_transformer.py] => Learning on 70-80
2023-05-10 00:21:10,035 [memo_transformer.py] => Task 1, Epoch 3/5 => Loss 1.596, Train_acc 95.45, Test_acc 94.67
2023-05-10 00:21:10,069 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0] 
2023-05-10 00:21:10,070 [base.py] => Reducing exemplars...(100 per classes)
2023-05-10 00:21:33,707 [base.py] => Constructing exemplars...(100 per classes)
2023-05-10 00:23:40,059 [memo_transformer.py] => Task 6, Epoch 3/5 => Loss 1.842, Train_acc 89.62, Test_acc 79.08
2023-05-10 00:23:40,059 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:23:40,065 [base.py] => Reducing exemplars...(28 per classes)
2023-05-10 00:24:29,425 [base.py] => Constructing exemplars...(28 per classes)
2023-05-10 00:24:43,889 [memo_transformer.py] => Exemplar size: 2000
2023-05-10 00:24:43,914 [trainer.py] => CNN: {'total': 94.67, '00-09': 95.1, '10-19': 94.23, 'old': 95.1, 'new': 94.23, 'harmonic': 94.66}
2023-05-10 00:24:43,914 [trainer.py] => NME: {'total': 92.87, '00-09': 94.06, '10-19': 91.65, 'old': 94.06, 'new': 91.65, 'harmonic': 92.84}
2023-05-10 00:24:43,914 [trainer.py] => CNN top1 curve: [98.07, 94.67]
2023-05-10 00:24:43,914 [trainer.py] => CNN top5 curve: [99.95, 99.52]
2023-05-10 00:24:43,914 [trainer.py] => NME top1 curve: [97.38, 92.87]
2023-05-10 00:24:43,914 [trainer.py] => NME top5 curve: [99.8, 99.3]

2023-05-10 00:24:43,915 [trainer.py] => Average Accuracy (CNN): 96.37
2023-05-10 00:24:43,915 [trainer.py] => Average Accuracy (NME): 95.125
2023-05-10 00:24:43,915 [trainer.py] => ZS seen top1 curve: [96.29, 91.19]
2023-05-10 00:24:43,915 [trainer.py] => ZS unseen top1 curve: [71.68, 78.04]
2023-05-10 00:24:43,915 [trainer.py] => ZS harmonic top1 curve: [82.18, 84.1]
2023-05-10 00:24:43,915 [trainer.py] => ZS total top1 curve: [74.17, 80.66]
2023-05-10 00:24:43,915 [trainer.py] => Average Accuracy (ZS seen): 93.74000000000001
2023-05-10 00:24:43,915 [trainer.py] => Average Accuracy (ZS unseen): 74.86000000000001
2023-05-10 00:24:43,915 [trainer.py] => Average Accuracy (ZS harmonic): 83.14
2023-05-10 00:24:43,915 [trainer.py] => Average Accuracy (ZS total): 77.41499999999999
2023-05-10 00:24:43,916 [trainer.py] => All params: 151724545
2023-05-10 00:24:43,917 [trainer.py] => Trainable params: 1839617
2023-05-10 00:24:43,930 [memo_transformer.py] => Learning on 20-30
2023-05-10 00:24:46,070 [memo_transformer.py] => Task 8, Epoch 3/5 => Loss 1.683, Train_acc 93.31, Test_acc 86.07
2023-05-10 00:24:46,074 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:24:46,075 [base.py] => Reducing exemplars...(22 per classes)
2023-05-10 00:25:43,862 [base.py] => Constructing exemplars...(22 per classes)
2023-05-10 00:27:58,536 [memo_transformer.py] => Task 7, Epoch 3/5 => Loss 1.399, Train_acc 96.53, Test_acc 85.15
2023-05-10 00:27:58,536 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:27:58,537 [base.py] => Reducing exemplars...(25 per classes)
2023-05-10 00:29:03,179 [base.py] => Constructing exemplars...(25 per classes)
2023-05-10 00:29:05,219 [memo_transformer.py] => Task 2, Epoch 3/5 => Loss 1.689, Train_acc 94.15, Test_acc 92.28
2023-05-10 00:29:05,276 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:29:05,280 [base.py] => Reducing exemplars...(66 per classes)
2023-05-10 00:29:09,856 [memo_transformer.py] => Exemplar size: 1960
2023-05-10 00:29:09,891 [trainer.py] => CNN: {'total': 79.08, '00-09': 73.27, '10-19': 84.0, '20-29': 76.88, '30-39': 78.98, '40-49': 80.27, '50-59': 71.54, '60-69': 88.89, 'old': 77.47, 'new': 88.89, 'harmonic': 82.79}
2023-05-10 00:29:09,891 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-10 00:29:09,891 [trainer.py] => CNN top1 curve: [97.87, 94.17, 90.91, 89.45, 86.48, 83.17, 79.08]
2023-05-10 00:29:09,891 [trainer.py] => CNN top5 curve: [100.0, 99.35, 99.15, 98.55, 97.94, 97.06, 96.44]
2023-05-10 00:29:09,891 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27]
2023-05-10 00:29:09,891 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96]

2023-05-10 00:29:09,891 [trainer.py] => Average Accuracy (CNN): 88.73285714285716
2023-05-10 00:29:09,891 [trainer.py] => Average Accuracy (NME): 89.96428571428571
2023-05-10 00:29:09,891 [trainer.py] => ZS seen top1 curve: [97.82, 93.69, 91.11, 89.63, 86.99, 84.3, 81.4]
2023-05-10 00:29:09,891 [trainer.py] => ZS unseen top1 curve: [1.45, 8.33, 11.87, 20.81, 26.26, 27.98, 35.64]
2023-05-10 00:29:09,891 [trainer.py] => ZS harmonic top1 curve: [2.86, 15.3, 21.0, 33.78, 40.34, 42.01, 49.57]
2023-05-10 00:29:09,891 [trainer.py] => ZS total top1 curve: [11.17, 25.37, 35.62, 48.52, 56.74, 61.9, 67.73]
2023-05-10 00:29:09,891 [trainer.py] => Average Accuracy (ZS seen): 89.27714285714285
2023-05-10 00:29:09,891 [trainer.py] => Average Accuracy (ZS unseen): 18.905714285714286
2023-05-10 00:29:09,891 [trainer.py] => Average Accuracy (ZS harmonic): 29.265714285714285
2023-05-10 00:29:09,891 [trainer.py] => Average Accuracy (ZS total): 43.864285714285714
2023-05-10 00:29:09,893 [trainer.py] => All params: 154358785
2023-05-10 00:29:09,893 [trainer.py] => Trainable params: 3152897
2023-05-10 00:29:09,907 [memo_transformer.py] => Learning on 70-80
2023-05-10 00:29:37,164 [base.py] => Constructing exemplars...(66 per classes)
2023-05-10 00:31:02,633 [memo_transformer.py] => Exemplar size: 1980
2023-05-10 00:31:02,636 [trainer.py] => CNN: {'total': 86.07, '00-09': 88.61, '10-19': 87.95, '20-29': 84.72, '30-39': 84.32, '40-49': 85.86, '50-59': 85.12, '60-69': 79.14, '70-79': 89.86, '80-89': 89.06, 'old': 85.7, 'new': 89.06, 'harmonic': 87.35}
2023-05-10 00:31:02,636 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-10 00:31:02,636 [trainer.py] => CNN top1 curve: [97.97, 94.77, 92.88, 91.7, 90.32, 89.04, 86.7, 86.19, 86.07]
2023-05-10 00:31:02,636 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.27, 98.99, 98.78, 98.31, 97.79, 97.55, 97.36]
2023-05-10 00:31:02,636 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-10 00:31:02,636 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-10 00:31:02,636 [trainer.py] => Average Accuracy (CNN): 90.62666666666665
2023-05-10 00:31:02,636 [trainer.py] => Average Accuracy (NME): 88.5188888888889
2023-05-10 00:31:02,636 [trainer.py] => ZS seen top1 curve: [96.88, 92.79, 89.16, 88.3, 87.15, 86.68, 85.03, 84.97, 84.87]
2023-05-10 00:31:02,636 [trainer.py] => ZS unseen top1 curve: [60.73, 73.39, 77.1, 77.18, 77.45, 77.28, 79.17, 77.77, 74.55]
2023-05-10 00:31:02,636 [trainer.py] => ZS harmonic top1 curve: [74.66, 81.96, 82.69, 82.37, 82.01, 81.71, 82.0, 81.21, 79.38]
2023-05-10 00:31:02,636 [trainer.py] => ZS total top1 curve: [64.38, 77.26, 80.72, 81.66, 82.32, 82.94, 83.28, 83.54, 83.85]
2023-05-10 00:31:02,636 [trainer.py] => Average Accuracy (ZS seen): 88.42555555555556
2023-05-10 00:31:02,636 [trainer.py] => Average Accuracy (ZS unseen): 74.95777777777776
2023-05-10 00:31:02,636 [trainer.py] => Average Accuracy (ZS harmonic): 80.88777777777779
2023-05-10 00:31:02,636 [trainer.py] => Average Accuracy (ZS total): 79.99444444444444
2023-05-10 00:31:02,638 [trainer.py] => All params: 155412481
2023-05-10 00:31:02,639 [trainer.py] => Trainable params: 3678209
2023-05-10 00:31:02,651 [memo_transformer.py] => Learning on 90-100
2023-05-10 00:32:54,010 [memo_transformer.py] => Exemplar size: 1980
2023-05-10 00:32:54,053 [trainer.py] => CNN: {'total': 92.28, '00-09': 91.78, '10-19': 90.43, '20-29': 94.61, 'old': 91.11, 'new': 94.61, 'harmonic': 92.83}
2023-05-10 00:32:54,053 [trainer.py] => NME: {'total': 90.7, '00-09': 91.88, '10-19': 89.47, '20-29': 90.71, 'old': 90.69, 'new': 90.71, 'harmonic': 90.7}
2023-05-10 00:32:54,053 [trainer.py] => CNN top1 curve: [98.07, 94.67, 92.28]
2023-05-10 00:32:54,053 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.22]
2023-05-10 00:32:54,053 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7]
2023-05-10 00:32:54,053 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0]

2023-05-10 00:32:54,053 [trainer.py] => Average Accuracy (CNN): 95.00666666666666
2023-05-10 00:32:54,053 [trainer.py] => Average Accuracy (NME): 93.64999999999999
2023-05-10 00:32:54,053 [trainer.py] => ZS seen top1 curve: [96.29, 91.19, 89.28]
2023-05-10 00:32:54,053 [trainer.py] => ZS unseen top1 curve: [71.68, 78.04, 77.28]
2023-05-10 00:32:54,053 [trainer.py] => ZS harmonic top1 curve: [82.18, 84.1, 82.85]
2023-05-10 00:32:54,053 [trainer.py] => ZS total top1 curve: [74.17, 80.66, 80.88]
2023-05-10 00:32:54,053 [trainer.py] => Average Accuracy (ZS seen): 92.25333333333333
2023-05-10 00:32:54,053 [trainer.py] => Average Accuracy (ZS unseen): 75.66666666666667
2023-05-10 00:32:54,053 [trainer.py] => Average Accuracy (ZS harmonic): 83.04333333333334
2023-05-10 00:32:54,053 [trainer.py] => Average Accuracy (ZS total): 78.57
2023-05-10 00:32:54,054 [trainer.py] => All params: 152251393
2023-05-10 00:32:54,055 [trainer.py] => Trainable params: 2102273
2023-05-10 00:32:54,068 [memo_transformer.py] => Learning on 30-40
2023-05-10 00:33:23,189 [memo_transformer.py] => Exemplar size: 2000
2023-05-10 00:33:23,190 [trainer.py] => CNN: {'total': 85.15, '00-09': 86.09, '10-19': 85.77, '20-29': 82.13, '30-39': 82.62, '40-49': 88.32, '50-59': 84.13, '60-69': 78.99, '70-79': 93.2, 'old': 84.0, 'new': 93.2, 'harmonic': 88.36}
2023-05-10 00:33:23,190 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-10 00:33:23,190 [trainer.py] => CNN top1 curve: [97.87, 94.74, 92.53, 90.88, 89.37, 88.2, 85.44, 85.15]
2023-05-10 00:33:23,190 [trainer.py] => CNN top5 curve: [99.9, 99.57, 99.27, 98.88, 98.48, 98.07, 97.66, 97.11]
2023-05-10 00:33:23,190 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-10 00:33:23,190 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-10 00:33:23,190 [trainer.py] => Average Accuracy (CNN): 90.5225
2023-05-10 00:33:23,190 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-10 00:33:23,190 [trainer.py] => ZS seen top1 curve: [97.92, 94.67, 91.71, 90.2, 88.8, 87.8, 84.86, 84.42]
2023-05-10 00:33:23,190 [trainer.py] => ZS unseen top1 curve: [1.43, 4.65, 7.07, 12.77, 18.39, 20.95, 30.7, 34.05]
2023-05-10 00:33:23,191 [trainer.py] => ZS harmonic top1 curve: [2.82, 8.86, 13.13, 22.37, 30.47, 33.83, 45.09, 48.53]
2023-05-10 00:33:23,191 [trainer.py] => ZS total top1 curve: [11.17, 22.62, 32.44, 43.94, 53.73, 61.22, 68.68, 74.41]
2023-05-10 00:33:23,191 [trainer.py] => Average Accuracy (ZS seen): 90.0475
2023-05-10 00:33:23,191 [trainer.py] => Average Accuracy (ZS unseen): 16.25125
2023-05-10 00:33:23,191 [trainer.py] => Average Accuracy (ZS harmonic): 25.6375
2023-05-10 00:33:23,191 [trainer.py] => Average Accuracy (ZS total): 46.02624999999999
2023-05-10 00:33:23,192 [trainer.py] => All params: 154885633
2023-05-10 00:33:23,194 [trainer.py] => Trainable params: 3415553
2023-05-10 00:33:23,215 [memo_transformer.py] => Learning on 80-90
2023-05-10 00:36:17,888 [memo_transformer.py] => Task 7, Epoch 3/5 => Loss 1.554, Train_acc 93.33, Test_acc 80.76
2023-05-10 00:36:17,917 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:36:17,921 [base.py] => Reducing exemplars...(25 per classes)
2023-05-10 00:37:09,943 [base.py] => Constructing exemplars...(25 per classes)
2023-05-10 00:37:44,919 [memo_transformer.py] => Task 3, Epoch 3/5 => Loss 1.738, Train_acc 93.52, Test_acc 90.52
2023-05-10 00:37:44,953 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:37:44,954 [base.py] => Reducing exemplars...(50 per classes)
2023-05-10 00:38:25,254 [base.py] => Constructing exemplars...(50 per classes)
2023-05-10 00:39:17,342 [memo_transformer.py] => Task 9, Epoch 3/5 => Loss 1.848, Train_acc 91.67, Test_acc 84.73
2023-05-10 00:39:17,342 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:39:17,343 [base.py] => Reducing exemplars...(20 per classes)
2023-05-10 00:40:19,616 [base.py] => Constructing exemplars...(20 per classes)
2023-05-10 00:40:52,129 [memo_transformer.py] => Task 8, Epoch 3/5 => Loss 1.412, Train_acc 96.56, Test_acc 84.66
2023-05-10 00:40:52,166 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:40:52,170 [base.py] => Reducing exemplars...(22 per classes)
2023-05-10 00:41:57,700 [base.py] => Constructing exemplars...(22 per classes)
2023-05-10 00:41:59,519 [memo_transformer.py] => Exemplar size: 2000
2023-05-10 00:41:59,549 [trainer.py] => CNN: {'total': 90.52, '00-09': 90.25, '10-19': 88.71, '20-29': 88.42, '30-39': 94.56, 'old': 89.13, 'new': 94.56, 'harmonic': 91.76}
2023-05-10 00:41:59,549 [trainer.py] => NME: {'total': 89.48, '00-09': 90.1, '10-19': 88.81, '20-29': 89.57, '30-39': 89.42, 'old': 89.5, 'new': 89.42, 'harmonic': 89.46}
2023-05-10 00:41:59,549 [trainer.py] => CNN top1 curve: [98.07, 94.67, 92.28, 90.52]
2023-05-10 00:41:59,549 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.22, 99.02]
2023-05-10 00:41:59,549 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48]
2023-05-10 00:41:59,549 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49]

2023-05-10 00:41:59,549 [trainer.py] => Average Accuracy (CNN): 93.88499999999999
2023-05-10 00:41:59,549 [trainer.py] => Average Accuracy (NME): 92.6075
2023-05-10 00:41:59,549 [trainer.py] => ZS seen top1 curve: [96.29, 91.19, 89.28, 86.92]
2023-05-10 00:41:59,549 [trainer.py] => ZS unseen top1 curve: [71.68, 78.04, 77.28, 76.71]
2023-05-10 00:41:59,549 [trainer.py] => ZS harmonic top1 curve: [82.18, 84.1, 82.85, 81.5]
2023-05-10 00:41:59,549 [trainer.py] => ZS total top1 curve: [74.17, 80.66, 80.88, 80.82]
2023-05-10 00:41:59,549 [trainer.py] => Average Accuracy (ZS seen): 90.92
2023-05-10 00:41:59,549 [trainer.py] => Average Accuracy (ZS unseen): 75.92750000000001
2023-05-10 00:41:59,549 [trainer.py] => Average Accuracy (ZS harmonic): 82.6575
2023-05-10 00:41:59,549 [trainer.py] => Average Accuracy (ZS total): 79.1325
2023-05-10 00:41:59,550 [trainer.py] => All params: 152778241
2023-05-10 00:41:59,551 [trainer.py] => Trainable params: 2364929
2023-05-10 00:41:59,565 [memo_transformer.py] => Learning on 40-50
2023-05-10 00:42:07,296 [memo_transformer.py] => Exemplar size: 2000
2023-05-10 00:42:07,297 [trainer.py] => CNN: {'total': 80.76, '00-09': 81.24, '10-19': 77.92, '20-29': 77.88, '30-39': 73.59, '40-49': 83.39, '50-59': 80.95, '60-69': 76.16, '70-79': 95.05, 'old': 78.72, 'new': 95.05, 'harmonic': 86.12}
2023-05-10 00:42:07,297 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-10 00:42:07,297 [trainer.py] => CNN top1 curve: [97.87, 94.17, 90.91, 89.45, 86.48, 83.17, 79.08, 80.76]
2023-05-10 00:42:07,297 [trainer.py] => CNN top5 curve: [100.0, 99.35, 99.15, 98.55, 97.94, 97.06, 96.44, 95.97]
2023-05-10 00:42:07,297 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7]
2023-05-10 00:42:07,297 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61]

2023-05-10 00:42:07,297 [trainer.py] => Average Accuracy (CNN): 87.73625000000001
2023-05-10 00:42:07,297 [trainer.py] => Average Accuracy (NME): 89.18125
2023-05-10 00:42:07,297 [trainer.py] => ZS seen top1 curve: [97.82, 93.69, 91.11, 89.63, 86.99, 84.3, 81.4, 81.49]
2023-05-10 00:42:07,297 [trainer.py] => ZS unseen top1 curve: [1.45, 8.33, 11.87, 20.81, 26.26, 27.98, 35.64, 45.6]
2023-05-10 00:42:07,298 [trainer.py] => ZS harmonic top1 curve: [2.86, 15.3, 21.0, 33.78, 40.34, 42.01, 49.57, 58.48]
2023-05-10 00:42:07,298 [trainer.py] => ZS total top1 curve: [11.17, 25.37, 35.62, 48.52, 56.74, 61.9, 67.73, 74.36]
2023-05-10 00:42:07,298 [trainer.py] => Average Accuracy (ZS seen): 88.30375
2023-05-10 00:42:07,298 [trainer.py] => Average Accuracy (ZS unseen): 22.2425
2023-05-10 00:42:07,298 [trainer.py] => Average Accuracy (ZS harmonic): 32.9175
2023-05-10 00:42:07,298 [trainer.py] => Average Accuracy (ZS total): 47.67625
2023-05-10 00:42:07,299 [trainer.py] => All params: 154885633
2023-05-10 00:42:07,300 [trainer.py] => Trainable params: 3415553
2023-05-10 00:42:07,312 [memo_transformer.py] => Learning on 80-90
2023-05-10 00:45:51,320 [memo_transformer.py] => Exemplar size: 2000
2023-05-10 00:45:51,344 [trainer.py] => CNN: {'total': 84.73, '00-09': 88.56, '10-19': 86.78, '20-29': 82.23, '30-39': 83.35, '40-49': 85.35, '50-59': 83.33, '60-69': 76.77, '70-79': 88.16, '80-89': 88.65, '90-99': 84.12, 'old': 84.8, 'new': 84.12, 'harmonic': 84.46}
2023-05-10 00:45:51,344 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-10 00:45:51,344 [trainer.py] => CNN top1 curve: [97.97, 94.77, 92.88, 91.7, 90.32, 89.04, 86.7, 86.19, 86.07, 84.73]
2023-05-10 00:45:51,344 [trainer.py] => CNN top5 curve: [99.95, 99.52, 99.27, 98.99, 98.78, 98.31, 97.79, 97.55, 97.36, 96.97]
2023-05-10 00:45:51,344 [trainer.py] => NME top1 curve: [97.38, 92.87, 90.7, 89.48, 88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-10 00:45:51,344 [trainer.py] => NME top5 curve: [99.8, 99.3, 99.0, 98.49, 98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-10 00:45:51,345 [trainer.py] => Average Accuracy (CNN): 90.03699999999999
2023-05-10 00:45:51,345 [trainer.py] => Average Accuracy (NME): 87.828





