2023-05-09 22:19:40,153 [trainer.py] => config: ././exp4//food101/food101_memo_transformer_clip.json
2023-05-09 22:19:40,153 [trainer.py] => prefix: reproduce
2023-05-09 22:19:40,153 [trainer.py] => dataset: food101
2023-05-09 22:19:40,153 [trainer.py] => memory_size: 2000
2023-05-09 22:19:40,153 [trainer.py] => memory_per_class: 20
2023-05-09 22:19:40,153 [trainer.py] => fixed_memory: False
2023-05-09 22:19:40,153 [trainer.py] => shuffle: True
2023-05-09 22:19:40,153 [trainer.py] => init_cls: 50
2023-05-09 22:19:40,153 [trainer.py] => increment: 10
2023-05-09 22:19:40,153 [trainer.py] => model_name: memo_transformer
2023-05-09 22:19:40,154 [trainer.py] => convnet_type: clip
2023-05-09 22:19:40,154 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-09 22:19:40,154 [trainer.py] => seed: 1993
2023-05-09 22:19:40,154 [trainer.py] => projection_type: pure_mlp
2023-05-09 22:19:40,154 [trainer.py] => fusion_choice: transformer
2023-05-09 22:19:40,154 [trainer.py] => split_train: False
2023-05-09 22:19:40,154 [trainer.py] => tsne_option: False
2023-05-09 22:19:40,154 [trainer.py] => laion_check: False
2023-05-09 22:19:40,154 [trainer.py] => train_tasks: 999
2023-05-09 22:19:40,154 [trainer.py] => frozen_layers: visual
2023-05-09 22:19:40,154 [trainer.py] => tuned_epoch: 5
2023-05-09 22:19:40,154 [trainer.py] => first_epoch: 5
2023-05-09 22:19:40,154 [trainer.py] => init_lr: 0.001
2023-05-09 22:19:40,154 [trainer.py] => batch_size: 64
2023-05-09 22:19:40,154 [trainer.py] => weight_decay: 0.05
2023-05-09 22:19:40,154 [trainer.py] => min_lr: 0
2023-05-09 22:19:40,154 [trainer.py] => optimizer: sgd
2023-05-09 22:19:40,566 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-09 22:20:44,571 [instantiator.py] => Created a temporary directory at /tmp/tmpld_shh3v
2023-05-09 22:20:44,571 [instantiator.py] => Writing /tmp/tmpld_shh3v/_remote_module_non_sriptable.py
2023-05-09 22:20:46,565 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 22:20:50,070 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 22:20:50,494 [factory.py] => Loaded ViT-B-16 model config.
2023-05-09 22:20:53,036 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-09 22:20:53,643 [trainer.py] => All params: 150670849
2023-05-09 22:20:53,644 [trainer.py] => Trainable params: 150670849
2023-05-09 22:21:01,683 [memo_transformer.py] => Learning on 0-50
2023-05-09 22:44:32,090 [memo_transformer.py] => Task 0, Epoch 5/5 => Loss 1.406, Train_acc 94.18, Test_acc 91.59
2023-05-09 22:44:32,100 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0] 
2023-05-09 22:44:32,101 [base.py] => Reducing exemplars...(40 per classes)
2023-05-09 22:44:32,101 [base.py] => Constructing exemplars...(40 per classes)
2023-05-09 22:54:33,866 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 22:54:33,975 [trainer.py] => CNN: {'total': 91.59, '00-09': 92.62, '10-19': 91.85, '20-29': 89.52, '30-39': 91.84, '40-49': 92.1, 'old': 0, 'new': 91.59, 'harmonic': 0.0}
2023-05-09 22:54:33,975 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 0, 'new': 88.25, 'harmonic': 0.0}
2023-05-09 22:54:33,975 [trainer.py] => CNN top1 curve: [91.59]
2023-05-09 22:54:33,975 [trainer.py] => CNN top5 curve: [98.75]
2023-05-09 22:54:33,975 [trainer.py] => NME top1 curve: [88.25]
2023-05-09 22:54:33,975 [trainer.py] => NME top5 curve: [98.13]

2023-05-09 22:54:33,976 [trainer.py] => Average Accuracy (CNN): 91.59
2023-05-09 22:54:33,976 [trainer.py] => Average Accuracy (NME): 88.25
2023-05-09 22:54:33,976 [trainer.py] => ZS seen top1 curve: [91.18]
2023-05-09 22:54:33,976 [trainer.py] => ZS unseen top1 curve: [15.89]
2023-05-09 22:54:33,976 [trainer.py] => ZS harmonic top1 curve: [27.06]
2023-05-09 22:54:33,976 [trainer.py] => ZS total top1 curve: [53.68]
2023-05-09 22:54:33,976 [trainer.py] => Average Accuracy (ZS seen): 91.18
2023-05-09 22:54:33,976 [trainer.py] => Average Accuracy (ZS unseen): 15.89
2023-05-09 22:54:33,976 [trainer.py] => Average Accuracy (ZS harmonic): 27.06
2023-05-09 22:54:33,976 [trainer.py] => Average Accuracy (ZS total): 53.68
2023-05-09 22:54:33,977 [trainer.py] => All params: 151197697
2023-05-09 22:54:33,978 [trainer.py] => Trainable params: 1576961
2023-05-09 22:54:33,993 [memo_transformer.py] => Learning on 50-60
2023-05-09 23:03:29,135 [memo_transformer.py] => Task 1, Epoch 5/5 => Loss 1.886, Train_acc 97.34, Test_acc 87.86
2023-05-09 23:03:29,179 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:03:29,182 [base.py] => Reducing exemplars...(33 per classes)
2023-05-09 23:04:09,663 [base.py] => Constructing exemplars...(33 per classes)
2023-05-09 23:08:19,270 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 23:08:19,282 [trainer.py] => CNN: {'total': 87.86, '00-09': 87.82, '10-19': 87.59, '20-29': 85.22, '30-39': 85.49, '40-49': 88.32, '50-59': 92.74, 'old': 86.88, 'new': 92.74, 'harmonic': 89.71}
2023-05-09 23:08:19,282 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-09 23:08:19,282 [trainer.py] => CNN top1 curve: [91.59, 87.86]
2023-05-09 23:08:19,282 [trainer.py] => CNN top5 curve: [98.75, 98.01]
2023-05-09 23:08:19,282 [trainer.py] => NME top1 curve: [88.25, 86.8]
2023-05-09 23:08:19,282 [trainer.py] => NME top5 curve: [98.13, 97.66]

2023-05-09 23:08:19,282 [trainer.py] => Average Accuracy (CNN): 89.725
2023-05-09 23:08:19,282 [trainer.py] => Average Accuracy (NME): 87.525
2023-05-09 23:08:19,282 [trainer.py] => ZS seen top1 curve: [91.18, 87.6]
2023-05-09 23:08:19,282 [trainer.py] => ZS unseen top1 curve: [15.89, 15.17]
2023-05-09 23:08:19,282 [trainer.py] => ZS harmonic top1 curve: [27.06, 25.86]
2023-05-09 23:08:19,282 [trainer.py] => ZS total top1 curve: [53.68, 58.8]
2023-05-09 23:08:19,282 [trainer.py] => Average Accuracy (ZS seen): 89.39
2023-05-09 23:08:19,282 [trainer.py] => Average Accuracy (ZS unseen): 15.530000000000001
2023-05-09 23:08:19,282 [trainer.py] => Average Accuracy (ZS harmonic): 26.46
2023-05-09 23:08:19,282 [trainer.py] => Average Accuracy (ZS total): 56.239999999999995
2023-05-09 23:08:19,283 [trainer.py] => All params: 151724545
2023-05-09 23:08:19,284 [trainer.py] => Trainable params: 1839617
2023-05-09 23:08:19,295 [memo_transformer.py] => Learning on 60-70
2023-05-09 23:17:58,364 [memo_transformer.py] => Task 2, Epoch 5/5 => Loss 2.173, Train_acc 94.28, Test_acc 85.08
2023-05-09 23:17:58,383 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:17:58,384 [base.py] => Reducing exemplars...(28 per classes)
2023-05-09 23:18:59,632 [base.py] => Constructing exemplars...(28 per classes)
2023-05-09 23:23:34,801 [memo_transformer.py] => Exemplar size: 1960
2023-05-09 23:23:34,805 [trainer.py] => CNN: {'total': 85.08, '00-09': 84.65, '10-19': 86.03, '20-29': 82.48, '30-39': 84.03, '40-49': 86.31, '50-59': 82.19, '60-69': 90.0, 'old': 84.27, 'new': 90.0, 'harmonic': 87.04}
2023-05-09 23:23:34,805 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-09 23:23:34,805 [trainer.py] => CNN top1 curve: [91.59, 87.86, 85.08]
2023-05-09 23:23:34,805 [trainer.py] => CNN top5 curve: [98.75, 98.01, 97.49]
2023-05-09 23:23:34,805 [trainer.py] => NME top1 curve: [88.25, 86.8, 84.27]
2023-05-09 23:23:34,805 [trainer.py] => NME top5 curve: [98.13, 97.66, 96.96]

2023-05-09 23:23:34,805 [trainer.py] => Average Accuracy (CNN): 88.17666666666666
2023-05-09 23:23:34,805 [trainer.py] => Average Accuracy (NME): 86.44
2023-05-09 23:23:34,805 [trainer.py] => ZS seen top1 curve: [91.18, 87.6, 85.16]
2023-05-09 23:23:34,805 [trainer.py] => ZS unseen top1 curve: [15.89, 15.17, 22.17]
2023-05-09 23:23:34,805 [trainer.py] => ZS harmonic top1 curve: [27.06, 25.86, 35.18]
2023-05-09 23:23:34,805 [trainer.py] => ZS total top1 curve: [53.68, 58.8, 66.35]
2023-05-09 23:23:34,805 [trainer.py] => Average Accuracy (ZS seen): 87.98
2023-05-09 23:23:34,805 [trainer.py] => Average Accuracy (ZS unseen): 17.743333333333336
2023-05-09 23:23:34,805 [trainer.py] => Average Accuracy (ZS harmonic): 29.366666666666664
2023-05-09 23:23:34,805 [trainer.py] => Average Accuracy (ZS total): 59.60999999999999
2023-05-09 23:23:34,807 [trainer.py] => All params: 152251393
2023-05-09 23:23:34,808 [trainer.py] => Trainable params: 2102273
2023-05-09 23:23:34,819 [memo_transformer.py] => Learning on 70-80
2023-05-09 23:33:58,260 [memo_transformer.py] => Task 3, Epoch 5/5 => Loss 2.011, Train_acc 96.65, Test_acc 84.10
2023-05-09 23:33:58,300 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:33:58,301 [base.py] => Reducing exemplars...(25 per classes)
2023-05-09 23:34:54,015 [base.py] => Constructing exemplars...(25 per classes)
2023-05-09 23:39:39,977 [memo_transformer.py] => Exemplar size: 2000
2023-05-09 23:39:39,988 [trainer.py] => CNN: {'total': 84.1, '00-09': 85.94, '10-19': 84.81, '20-29': 81.33, '30-39': 79.76, '40-49': 86.21, '50-59': 81.79, '60-69': 77.88, '70-79': 95.2, 'old': 82.52, 'new': 95.2, 'harmonic': 88.41}
2023-05-09 23:39:39,988 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-09 23:39:39,989 [trainer.py] => CNN top1 curve: [91.59, 87.86, 85.08, 84.1]
2023-05-09 23:39:39,989 [trainer.py] => CNN top5 curve: [98.75, 98.01, 97.49, 96.86]
2023-05-09 23:39:39,989 [trainer.py] => NME top1 curve: [88.25, 86.8, 84.27, 83.7]
2023-05-09 23:39:39,989 [trainer.py] => NME top5 curve: [98.13, 97.66, 96.96, 96.61]

2023-05-09 23:39:39,989 [trainer.py] => Average Accuracy (CNN): 87.1575
2023-05-09 23:39:39,989 [trainer.py] => Average Accuracy (NME): 85.755
2023-05-09 23:39:39,989 [trainer.py] => ZS seen top1 curve: [91.18, 87.6, 85.16, 84.04]
2023-05-09 23:39:39,989 [trainer.py] => ZS unseen top1 curve: [15.89, 15.17, 22.17, 25.78]
2023-05-09 23:39:39,989 [trainer.py] => ZS harmonic top1 curve: [27.06, 25.86, 35.18, 39.46]
2023-05-09 23:39:39,989 [trainer.py] => ZS total top1 curve: [53.68, 58.8, 66.35, 72.47]
2023-05-09 23:39:39,989 [trainer.py] => Average Accuracy (ZS seen): 86.995
2023-05-09 23:39:39,989 [trainer.py] => Average Accuracy (ZS unseen): 19.7525
2023-05-09 23:39:39,989 [trainer.py] => Average Accuracy (ZS harmonic): 31.89
2023-05-09 23:39:39,989 [trainer.py] => Average Accuracy (ZS total): 62.824999999999996
2023-05-09 23:39:39,990 [trainer.py] => All params: 152778241
2023-05-09 23:39:39,991 [trainer.py] => Trainable params: 2364929
2023-05-09 23:39:40,002 [memo_transformer.py] => Learning on 80-90
2023-05-09 23:50:51,287 [memo_transformer.py] => Task 4, Epoch 5/5 => Loss 2.036, Train_acc 95.89, Test_acc 82.57
2023-05-09 23:50:51,439 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-09 23:50:51,440 [base.py] => Reducing exemplars...(22 per classes)
2023-05-09 23:51:51,248 [base.py] => Constructing exemplars...(22 per classes)
2023-05-09 23:56:59,725 [memo_transformer.py] => Exemplar size: 1980
2023-05-09 23:56:59,735 [trainer.py] => CNN: {'total': 82.57, '00-09': 84.36, '10-19': 81.67, '20-29': 81.28, '30-39': 78.69, '40-49': 82.08, '50-59': 81.44, '60-69': 73.54, '70-79': 84.51, '80-89': 95.58, 'old': 80.95, 'new': 95.58, 'harmonic': 87.66}
2023-05-09 23:56:59,735 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-09 23:56:59,736 [trainer.py] => CNN top1 curve: [91.59, 87.86, 85.08, 84.1, 82.57]
2023-05-09 23:56:59,736 [trainer.py] => CNN top5 curve: [98.75, 98.01, 97.49, 96.86, 96.66]
2023-05-09 23:56:59,736 [trainer.py] => NME top1 curve: [88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-09 23:56:59,736 [trainer.py] => NME top5 curve: [98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-09 23:56:59,736 [trainer.py] => Average Accuracy (CNN): 86.24
2023-05-09 23:56:59,736 [trainer.py] => Average Accuracy (NME): 85.248
2023-05-09 23:56:59,736 [trainer.py] => ZS seen top1 curve: [91.18, 87.6, 85.16, 84.04, 83.31]
2023-05-09 23:56:59,736 [trainer.py] => ZS unseen top1 curve: [15.89, 15.17, 22.17, 25.78, 20.77]
2023-05-09 23:56:59,736 [trainer.py] => ZS harmonic top1 curve: [27.06, 25.86, 35.18, 39.46, 33.25]
2023-05-09 23:56:59,736 [trainer.py] => ZS total top1 curve: [53.68, 58.8, 66.35, 72.47, 77.11]
2023-05-09 23:56:59,736 [trainer.py] => Average Accuracy (ZS seen): 86.25800000000001
2023-05-09 23:56:59,736 [trainer.py] => Average Accuracy (ZS unseen): 19.956
2023-05-09 23:56:59,736 [trainer.py] => Average Accuracy (ZS harmonic): 32.162
2023-05-09 23:56:59,736 [trainer.py] => Average Accuracy (ZS total): 65.68199999999999
2023-05-09 23:56:59,737 [trainer.py] => All params: 153305089
2023-05-09 23:56:59,738 [trainer.py] => Trainable params: 2627585
2023-05-09 23:56:59,753 [memo_transformer.py] => Learning on 90-100
2023-05-10 00:08:56,769 [memo_transformer.py] => Task 5, Epoch 5/5 => Loss 2.145, Train_acc 94.51, Test_acc 80.03
2023-05-10 00:08:56,793 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 00:08:56,793 [base.py] => Reducing exemplars...(20 per classes)
2023-05-10 00:09:55,364 [base.py] => Constructing exemplars...(20 per classes)
2023-05-10 00:15:17,247 [memo_transformer.py] => Exemplar size: 2000
2023-05-10 00:15:17,264 [trainer.py] => CNN: {'total': 80.03, '00-09': 81.73, '10-19': 82.43, '20-29': 73.14, '30-39': 78.3, '40-49': 79.37, '50-59': 75.92, '60-69': 69.6, '70-79': 80.86, '80-89': 85.39, '90-99': 93.65, 'old': 78.53, 'new': 93.65, 'harmonic': 85.43}
2023-05-10 00:15:17,265 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-10 00:15:17,265 [trainer.py] => CNN top1 curve: [91.59, 87.86, 85.08, 84.1, 82.57, 80.03]
2023-05-10 00:15:17,265 [trainer.py] => CNN top5 curve: [98.75, 98.01, 97.49, 96.86, 96.66, 95.91]
2023-05-10 00:15:17,265 [trainer.py] => NME top1 curve: [88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-10 00:15:17,265 [trainer.py] => NME top5 curve: [98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-10 00:15:17,265 [trainer.py] => Average Accuracy (CNN): 85.205
2023-05-10 00:15:17,265 [trainer.py] => Average Accuracy (NME): 84.64166666666667
2023-05-10 00:15:17,265 [trainer.py] => ZS seen top1 curve: [91.18, 87.6, 85.16, 84.04, 83.31, 82.15]
2023-05-10 00:15:17,265 [trainer.py] => ZS unseen top1 curve: [15.89, 15.17, 22.17, 25.78, 20.77, 0]
2023-05-10 00:15:17,265 [trainer.py] => ZS harmonic top1 curve: [27.06, 25.86, 35.18, 39.46, 33.25, 0.0]
2023-05-10 00:15:17,265 [trainer.py] => ZS total top1 curve: [53.68, 58.8, 66.35, 72.47, 77.11, 82.15]
2023-05-10 00:15:17,265 [trainer.py] => Average Accuracy (ZS seen): 85.57333333333334
2023-05-10 00:15:17,265 [trainer.py] => Average Accuracy (ZS unseen): 16.63
2023-05-10 00:15:17,265 [trainer.py] => Average Accuracy (ZS harmonic): 26.801666666666666
2023-05-10 00:15:17,265 [trainer.py] => Average Accuracy (ZS total): 68.42666666666666
2023-05-10 14:59:37,270 [trainer.py] => config: ./exp5_mlp/food101_memo_transformer_clip_3_0.002_32_0.005_b50.json
2023-05-10 14:59:37,277 [trainer.py] => prefix: reproduce
2023-05-10 14:59:37,277 [trainer.py] => dataset: food101
2023-05-10 14:59:37,277 [trainer.py] => memory_size: 2000
2023-05-10 14:59:37,277 [trainer.py] => memory_per_class: 20
2023-05-10 14:59:37,277 [trainer.py] => fixed_memory: False
2023-05-10 14:59:37,277 [trainer.py] => shuffle: True
2023-05-10 14:59:37,277 [trainer.py] => init_cls: 50
2023-05-10 14:59:37,277 [trainer.py] => increment: 10
2023-05-10 14:59:37,277 [trainer.py] => model_name: memo_transformer
2023-05-10 14:59:37,277 [trainer.py] => convnet_type: clip
2023-05-10 14:59:37,277 [trainer.py] => device: [device(type='cuda', index=0)]
2023-05-10 14:59:37,277 [trainer.py] => seed: 1993
2023-05-10 14:59:37,277 [trainer.py] => projection_type: mlp
2023-05-10 14:59:37,277 [trainer.py] => fusion_choice: transformer
2023-05-10 14:59:37,277 [trainer.py] => split_train: False
2023-05-10 14:59:37,277 [trainer.py] => tsne_option: False
2023-05-10 14:59:37,277 [trainer.py] => laion_check: False
2023-05-10 14:59:37,277 [trainer.py] => train_tasks: 999
2023-05-10 14:59:37,278 [trainer.py] => frozen_layers: visual
2023-05-10 14:59:37,278 [trainer.py] => tuned_epoch: 5
2023-05-10 14:59:37,278 [trainer.py] => first_epoch: 3
2023-05-10 14:59:37,278 [trainer.py] => init_lr: 0.002
2023-05-10 14:59:37,278 [trainer.py] => batch_size: 32
2023-05-10 14:59:37,278 [trainer.py] => weight_decay: 0.005
2023-05-10 14:59:37,278 [trainer.py] => min_lr: 0
2023-05-10 14:59:37,278 [trainer.py] => optimizer: sgd
2023-05-10 14:59:37,842 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-05-10 15:00:36,884 [instantiator.py] => Created a temporary directory at /tmp/tmp2uqijbf1
2023-05-10 15:00:36,886 [instantiator.py] => Writing /tmp/tmp2uqijbf1/_remote_module_non_sriptable.py
2023-05-10 15:00:38,720 [factory.py] => Loaded ViT-B-16 model config.
2023-05-10 15:00:42,373 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-10 15:00:42,806 [factory.py] => Loaded ViT-B-16 model config.
2023-05-10 15:00:45,437 [factory.py] => Loading pretrained ViT-B-16 weights (laion400m_e32).
2023-05-10 15:00:46,354 [trainer.py] => All params: 150670849
2023-05-10 15:00:46,355 [trainer.py] => Trainable params: 150670849
2023-05-10 15:00:52,255 [memo_transformer.py] => Learning on 0-50
2023-05-10 15:16:55,123 [memo_transformer.py] => Task 0, Epoch 3/5 => Loss 1.162, Train_acc 92.11, Test_acc 91.11
2023-05-10 15:16:55,176 [memo_transformer.py] => Laion scores: [0, 0, 0] 
2023-05-10 15:16:55,177 [base.py] => Reducing exemplars...(40 per classes)
2023-05-10 15:16:55,177 [base.py] => Constructing exemplars...(40 per classes)
2023-05-10 15:24:32,819 [memo_transformer.py] => Exemplar size: 2000
2023-05-10 15:24:32,829 [trainer.py] => CNN: {'total': 91.11, '00-09': 92.03, '10-19': 91.29, '20-29': 89.92, '30-39': 90.1, '40-49': 92.25, 'old': 0, 'new': 91.11, 'harmonic': 0.0}
2023-05-10 15:24:32,829 [trainer.py] => NME: {'total': 88.25, '00-09': 88.76, '10-19': 88.35, '20-29': 88.37, '30-39': 87.43, '40-49': 88.37, 'old': 0, 'new': 88.25, 'harmonic': 0.0}
2023-05-10 15:24:32,829 [trainer.py] => CNN top1 curve: [91.11]
2023-05-10 15:24:32,829 [trainer.py] => CNN top5 curve: [98.85]
2023-05-10 15:24:32,829 [trainer.py] => NME top1 curve: [88.25]
2023-05-10 15:24:32,829 [trainer.py] => NME top5 curve: [98.13]

2023-05-10 15:24:32,829 [trainer.py] => Average Accuracy (CNN): 91.11
2023-05-10 15:24:32,829 [trainer.py] => Average Accuracy (NME): 88.25
2023-05-10 15:24:32,829 [trainer.py] => ZS seen top1 curve: [90.38]
2023-05-10 15:24:32,829 [trainer.py] => ZS unseen top1 curve: [63.14]
2023-05-10 15:24:32,829 [trainer.py] => ZS harmonic top1 curve: [74.34]
2023-05-10 15:24:32,829 [trainer.py] => ZS total top1 curve: [76.81]
2023-05-10 15:24:32,829 [trainer.py] => Average Accuracy (ZS seen): 90.38
2023-05-10 15:24:32,830 [trainer.py] => Average Accuracy (ZS unseen): 63.14
2023-05-10 15:24:32,830 [trainer.py] => Average Accuracy (ZS harmonic): 74.34
2023-05-10 15:24:32,830 [trainer.py] => Average Accuracy (ZS total): 76.81
2023-05-10 15:24:32,831 [trainer.py] => All params: 151197697
2023-05-10 15:24:32,831 [trainer.py] => Trainable params: 1576961
2023-05-10 15:24:32,841 [memo_transformer.py] => Learning on 50-60
2023-05-10 15:30:32,986 [memo_transformer.py] => Task 1, Epoch 3/5 => Loss 1.516, Train_acc 94.93, Test_acc 89.42
2023-05-10 15:30:33,003 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0] 
2023-05-10 15:30:33,003 [base.py] => Reducing exemplars...(33 per classes)
2023-05-10 15:31:12,192 [base.py] => Constructing exemplars...(33 per classes)
2023-05-10 15:34:55,561 [memo_transformer.py] => Exemplar size: 1980
2023-05-10 15:34:55,575 [trainer.py] => CNN: {'total': 89.42, '00-09': 90.3, '10-19': 90.53, '20-29': 87.02, '30-39': 88.01, '40-49': 90.24, '50-59': 90.45, 'old': 89.21, 'new': 90.45, 'harmonic': 89.83}
2023-05-10 15:34:55,576 [trainer.py] => NME: {'total': 86.8, '00-09': 87.77, '10-19': 87.39, '20-29': 86.32, '30-39': 85.87, '40-49': 87.42, '50-59': 86.07, 'old': 86.95, 'new': 86.07, 'harmonic': 86.51}
2023-05-10 15:34:55,576 [trainer.py] => CNN top1 curve: [91.11, 89.42]
2023-05-10 15:34:55,576 [trainer.py] => CNN top5 curve: [98.85, 98.39]
2023-05-10 15:34:55,576 [trainer.py] => NME top1 curve: [88.25, 86.8]
2023-05-10 15:34:55,576 [trainer.py] => NME top5 curve: [98.13, 97.66]

2023-05-10 15:34:55,576 [trainer.py] => Average Accuracy (CNN): 90.265
2023-05-10 15:34:55,576 [trainer.py] => Average Accuracy (NME): 87.525
2023-05-10 15:34:55,576 [trainer.py] => ZS seen top1 curve: [90.38, 88.1]
2023-05-10 15:34:55,576 [trainer.py] => ZS unseen top1 curve: [63.14, 72.69]
2023-05-10 15:34:55,576 [trainer.py] => ZS harmonic top1 curve: [74.34, 79.66]
2023-05-10 15:34:55,576 [trainer.py] => ZS total top1 curve: [76.81, 81.98]
2023-05-10 15:34:55,576 [trainer.py] => Average Accuracy (ZS seen): 89.24
2023-05-10 15:34:55,576 [trainer.py] => Average Accuracy (ZS unseen): 67.91499999999999
2023-05-10 15:34:55,576 [trainer.py] => Average Accuracy (ZS harmonic): 77.0
2023-05-10 15:34:55,576 [trainer.py] => Average Accuracy (ZS total): 79.39500000000001
2023-05-10 15:34:55,577 [trainer.py] => All params: 151724545
2023-05-10 15:34:55,578 [trainer.py] => Trainable params: 1839617
2023-05-10 15:34:55,588 [memo_transformer.py] => Learning on 60-70
2023-05-10 15:41:13,987 [memo_transformer.py] => Task 2, Epoch 3/5 => Loss 1.838, Train_acc 90.97, Test_acc 87.13
2023-05-10 15:41:13,995 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 15:41:13,996 [base.py] => Reducing exemplars...(28 per classes)
2023-05-10 15:41:55,725 [base.py] => Constructing exemplars...(28 per classes)
2023-05-10 15:45:48,458 [memo_transformer.py] => Exemplar size: 1960
2023-05-10 15:45:48,467 [trainer.py] => CNN: {'total': 87.13, '00-09': 88.61, '10-19': 89.32, '20-29': 85.32, '30-39': 87.86, '40-49': 88.02, '50-59': 86.57, '60-69': 84.14, 'old': 87.62, 'new': 84.14, 'harmonic': 85.84}
2023-05-10 15:45:48,467 [trainer.py] => NME: {'total': 84.27, '00-09': 86.34, '10-19': 85.92, '20-29': 83.92, '30-39': 84.76, '40-49': 86.21, '50-59': 83.28, '60-69': 79.39, 'old': 85.07, 'new': 79.39, 'harmonic': 82.13}
2023-05-10 15:45:48,467 [trainer.py] => CNN top1 curve: [91.11, 89.42, 87.13]
2023-05-10 15:45:48,468 [trainer.py] => CNN top5 curve: [98.85, 98.39, 97.91]
2023-05-10 15:45:48,468 [trainer.py] => NME top1 curve: [88.25, 86.8, 84.27]
2023-05-10 15:45:48,468 [trainer.py] => NME top5 curve: [98.13, 97.66, 96.96]

2023-05-10 15:45:48,468 [trainer.py] => Average Accuracy (CNN): 89.21999999999998
2023-05-10 15:45:48,468 [trainer.py] => Average Accuracy (NME): 86.44
2023-05-10 15:45:48,468 [trainer.py] => ZS seen top1 curve: [90.38, 88.1, 85.79]
2023-05-10 15:45:48,468 [trainer.py] => ZS unseen top1 curve: [63.14, 72.69, 76.49]
2023-05-10 15:45:48,468 [trainer.py] => ZS harmonic top1 curve: [74.34, 79.66, 80.87]
2023-05-10 15:45:48,468 [trainer.py] => ZS total top1 curve: [76.81, 81.98, 83.01]
2023-05-10 15:45:48,468 [trainer.py] => Average Accuracy (ZS seen): 88.08999999999999
2023-05-10 15:45:48,468 [trainer.py] => Average Accuracy (ZS unseen): 70.77333333333333
2023-05-10 15:45:48,468 [trainer.py] => Average Accuracy (ZS harmonic): 78.29
2023-05-10 15:45:48,468 [trainer.py] => Average Accuracy (ZS total): 80.60000000000001
2023-05-10 15:45:48,469 [trainer.py] => All params: 152251393
2023-05-10 15:45:48,470 [trainer.py] => Trainable params: 2102273
2023-05-10 15:45:48,479 [memo_transformer.py] => Learning on 70-80
2023-05-10 15:52:36,056 [memo_transformer.py] => Task 3, Epoch 3/5 => Loss 1.595, Train_acc 94.48, Test_acc 86.39
2023-05-10 15:52:36,069 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 15:52:36,070 [base.py] => Reducing exemplars...(25 per classes)
2023-05-10 15:53:21,945 [base.py] => Constructing exemplars...(25 per classes)
2023-05-10 15:57:34,076 [memo_transformer.py] => Exemplar size: 2000
2023-05-10 15:57:34,091 [trainer.py] => CNN: {'total': 86.39, '00-09': 88.86, '10-19': 87.85, '20-29': 83.37, '30-39': 85.0, '40-49': 88.02, '50-59': 85.67, '60-69': 82.58, '70-79': 89.81, 'old': 85.91, 'new': 89.81, 'harmonic': 87.82}
2023-05-10 15:57:34,091 [trainer.py] => NME: {'total': 83.7, '00-09': 85.89, '10-19': 84.71, '20-29': 82.98, '30-39': 83.59, '40-49': 85.56, '50-59': 82.44, '60-69': 78.74, '70-79': 85.66, 'old': 83.42, 'new': 85.66, 'harmonic': 84.53}
2023-05-10 15:57:34,091 [trainer.py] => CNN top1 curve: [91.11, 89.42, 87.13, 86.39]
2023-05-10 15:57:34,091 [trainer.py] => CNN top5 curve: [98.85, 98.39, 97.91, 97.52]
2023-05-10 15:57:34,091 [trainer.py] => NME top1 curve: [88.25, 86.8, 84.27, 83.7]
2023-05-10 15:57:34,091 [trainer.py] => NME top5 curve: [98.13, 97.66, 96.96, 96.61]

2023-05-10 15:57:34,091 [trainer.py] => Average Accuracy (CNN): 88.51249999999999
2023-05-10 15:57:34,091 [trainer.py] => Average Accuracy (NME): 85.755
2023-05-10 15:57:34,091 [trainer.py] => ZS seen top1 curve: [90.38, 88.1, 85.79, 85.47]
2023-05-10 15:57:34,091 [trainer.py] => ZS unseen top1 curve: [63.14, 72.69, 76.49, 75.2]
2023-05-10 15:57:34,091 [trainer.py] => ZS harmonic top1 curve: [74.34, 79.66, 80.87, 80.01]
2023-05-10 15:57:34,091 [trainer.py] => ZS total top1 curve: [76.81, 81.98, 83.01, 83.43]
2023-05-10 15:57:34,091 [trainer.py] => Average Accuracy (ZS seen): 87.435
2023-05-10 15:57:34,091 [trainer.py] => Average Accuracy (ZS unseen): 71.88
2023-05-10 15:57:34,091 [trainer.py] => Average Accuracy (ZS harmonic): 78.72
2023-05-10 15:57:34,091 [trainer.py] => Average Accuracy (ZS total): 81.3075
2023-05-10 15:57:34,093 [trainer.py] => All params: 152778241
2023-05-10 15:57:34,093 [trainer.py] => Trainable params: 2364929
2023-05-10 15:57:34,113 [memo_transformer.py] => Learning on 80-90
2023-05-10 16:04:55,555 [memo_transformer.py] => Task 4, Epoch 3/5 => Loss 1.628, Train_acc 93.82, Test_acc 86.33
2023-05-10 16:04:55,565 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 16:04:55,566 [base.py] => Reducing exemplars...(22 per classes)
2023-05-10 16:05:44,494 [base.py] => Constructing exemplars...(22 per classes)
2023-05-10 16:10:10,671 [memo_transformer.py] => Exemplar size: 1980
2023-05-10 16:10:10,687 [trainer.py] => CNN: {'total': 86.33, '00-09': 88.91, '10-19': 87.24, '20-29': 84.47, '30-39': 84.22, '40-49': 86.26, '50-59': 85.92, '60-69': 79.95, '70-79': 90.2, '80-89': 89.81, 'old': 85.9, 'new': 89.81, 'harmonic': 87.81}
2023-05-10 16:10:10,687 [trainer.py] => NME: {'total': 83.22, '00-09': 85.15, '10-19': 84.05, '20-29': 82.98, '30-39': 82.18, '40-49': 84.75, '50-59': 82.29, '60-69': 77.47, '70-79': 85.46, '80-89': 84.64, 'old': 83.04, 'new': 84.64, 'harmonic': 83.83}
2023-05-10 16:10:10,687 [trainer.py] => CNN top1 curve: [91.11, 89.42, 87.13, 86.39, 86.33]
2023-05-10 16:10:10,687 [trainer.py] => CNN top5 curve: [98.85, 98.39, 97.91, 97.52, 97.39]
2023-05-10 16:10:10,687 [trainer.py] => NME top1 curve: [88.25, 86.8, 84.27, 83.7, 83.22]
2023-05-10 16:10:10,687 [trainer.py] => NME top5 curve: [98.13, 97.66, 96.96, 96.61, 96.26]

2023-05-10 16:10:10,688 [trainer.py] => Average Accuracy (CNN): 88.076
2023-05-10 16:10:10,688 [trainer.py] => Average Accuracy (NME): 85.248
2023-05-10 16:10:10,688 [trainer.py] => ZS seen top1 curve: [90.38, 88.1, 85.79, 85.47, 85.15]
2023-05-10 16:10:10,688 [trainer.py] => ZS unseen top1 curve: [63.14, 72.69, 76.49, 75.2, 72.73]
2023-05-10 16:10:10,688 [trainer.py] => ZS harmonic top1 curve: [74.34, 79.66, 80.87, 80.01, 78.45]
2023-05-10 16:10:10,688 [trainer.py] => ZS total top1 curve: [76.81, 81.98, 83.01, 83.43, 83.91]
2023-05-10 16:10:10,688 [trainer.py] => Average Accuracy (ZS seen): 86.978
2023-05-10 16:10:10,688 [trainer.py] => Average Accuracy (ZS unseen): 72.05
2023-05-10 16:10:10,688 [trainer.py] => Average Accuracy (ZS harmonic): 78.666
2023-05-10 16:10:10,688 [trainer.py] => Average Accuracy (ZS total): 81.828
2023-05-10 16:10:10,689 [trainer.py] => All params: 153305089
2023-05-10 16:10:10,690 [trainer.py] => Trainable params: 2627585
2023-05-10 16:10:10,700 [memo_transformer.py] => Learning on 90-100
2023-05-10 16:18:01,704 [memo_transformer.py] => Task 5, Epoch 3/5 => Loss 1.787, Train_acc 92.22, Test_acc 84.74
2023-05-10 16:18:01,737 [memo_transformer.py] => Laion scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
2023-05-10 16:18:01,737 [base.py] => Reducing exemplars...(20 per classes)
2023-05-10 16:19:05,025 [base.py] => Constructing exemplars...(20 per classes)
2023-05-10 16:24:15,688 [memo_transformer.py] => Exemplar size: 2000
2023-05-10 16:24:15,724 [trainer.py] => CNN: {'total': 84.74, '00-09': 88.42, '10-19': 87.34, '20-29': 81.53, '30-39': 83.74, '40-49': 85.05, '50-59': 83.33, '60-69': 77.32, '70-79': 87.66, '80-89': 88.65, '90-99': 84.32, 'old': 84.78, 'new': 84.32, 'harmonic': 84.55}
2023-05-10 16:24:15,724 [trainer.py] => NME: {'total': 81.61, '00-09': 84.31, '10-19': 84.1, '20-29': 79.58, '30-39': 81.36, '40-49': 84.35, '50-59': 80.75, '60-69': 75.05, '70-79': 83.51, '80-89': 83.89, '90-99': 79.13, 'old': 81.88, 'new': 79.13, 'harmonic': 80.48}
2023-05-10 16:24:15,724 [trainer.py] => CNN top1 curve: [91.11, 89.42, 87.13, 86.39, 86.33, 84.74]
2023-05-10 16:24:15,724 [trainer.py] => CNN top5 curve: [98.85, 98.39, 97.91, 97.52, 97.39, 97.05]
2023-05-10 16:24:15,724 [trainer.py] => NME top1 curve: [88.25, 86.8, 84.27, 83.7, 83.22, 81.61]
2023-05-10 16:24:15,724 [trainer.py] => NME top5 curve: [98.13, 97.66, 96.96, 96.61, 96.26, 95.72]

2023-05-10 16:24:15,724 [trainer.py] => Average Accuracy (CNN): 87.51999999999998
2023-05-10 16:24:15,724 [trainer.py] => Average Accuracy (NME): 84.64166666666667
